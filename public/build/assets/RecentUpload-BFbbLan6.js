import{d as i,j as s,X as y,A as b}from"./ContextMenuProvider-Bgjy8Wg_.js";import{h as C}from"./moment-C5S46NFB.js";import{T as P}from"./TableWithContextMenu-C9UP903_.js";import{u as k}from"./useTranslation-i33--018.js";import{B as h}from"./Badge-VQyFZ_fS.js";import{C as x}from"./Col-Dir6tpbB.js";import{B as w}from"./Button-RncLFi2F.js";import{u as T,c as N}from"./ThemeProvider-CYM_k5Zw.js";const R=i.forwardRef(({bsPrefix:e,variant:c,animation:l="border",size:o,as:u="div",className:f,...d},m)=>{e=T(e,"spinner");const p=`${e}-${l}`;return s.jsx(u,{ref:m,...d,className:N(f,p,o&&`${p}-${o}`,c&&`text-${c}`)})});R.displayName="Spinner";const F=()=>{const{t:e}=k(),{importHistory:c}=y().props,[l,o]=i.useState(!1),[u,f]=i.useState(0),[d,m]=i.useState(!0),p=i.useCallback((t=1,a=10,n)=>{b.reload({only:["importHistory","subProduct"],replace:!0,data:{importPage:t,importPerPage:a,...n},onFinish:()=>{o(!1)}})},[]),S=i.useCallback(()=>{const t=Date.now();if(t-u<2e3)return;o(!0),m(!1),f(t);const a=Date.now();b.reload({only:["importHistory","accounts","subProduct"],replace:!0,onFinish:()=>{const n=Date.now()-a,r=1e3;n<r?setTimeout(()=>{o(!1)},r-n):o(!1),setTimeout(()=>{m(!0)},2e3)}})},[u]),j=i.useMemo(()=>[{header:e("File name"),accessorKey:"file_path",enableColumnFilter:!1,enableSorting:!0,cell:t=>s.jsx("span",{children:t.getValue().split("/").pop()})},{header:e("Upload date"),accessorKey:"created_at",enableColumnFilter:!1,enableSorting:!0,cell:t=>s.jsx("span",{children:C(t.getValue()).format("DD/MM/YYYY HH:mm")})},{header:e("Status"),accessorKey:"status",enableColumnFilter:!1,enableSorting:!0,cell:t=>{const a=t.getValue()||"Unknown",n={FINISH:e("Finish"),RUNNING:e("Processing"),ERROR:e("Error"),Unknown:e("Unknown")},r={FINISH:"bg-success",RUNNING:"bg-info",ERROR:"bg-danger",Unknown:"bg-dark"};return s.jsx("span",{className:`badge ${(r==null?void 0:r[a])||"bg-dark"} fs-6 fw-medium`,children:e((n==null?void 0:n[a])||"Unknown")})}},{header:e("Result"),accessorKey:"result",enableColumnFilter:!1,enableSorting:!0,cell:t=>{var r,g;const a=t.getValue()||{};return((g=(r=t==null?void 0:t.row)==null?void 0:r.original)==null?void 0:g.status)==="FINISH"?s.jsxs("div",{children:[s.jsxs(h,{bg:"secondary",children:[e("Total"),": ",(a==null?void 0:a.total_count)||0]})," ",s.jsxs(h,{bg:"success",children:[e("Success"),": ",(a==null?void 0:a.success_count)||0]})," ",s.jsxs(h,{bg:"danger",children:[e("Error"),": ",(a==null?void 0:a.error_count)||0]})]}):null}}],[e]);return s.jsxs(s.Fragment,{children:[s.jsxs(x,{lg:12,className:"mb-4 d-flex align-items-center gap-2",children:[s.jsx("h5",{children:e("Upload history")}),s.jsxs(w,{variant:"outline-info",onClick:S,disabled:l||!d,style:{transition:"all 0.3s ease-in-out",opacity:l||!d?.6:1},children:[l&&s.jsx(R,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),e("Refresh")]})]}),s.jsx(x,{lg:12,children:s.jsx("div",{children:s.jsx(P,{columns:j,data:c||[],divClass:"table-responsive table-card mb-3",tableClass:"table align-middle table-nowrap mb-0",theadClass:"table-light",enableContextMenu:!1,isPaginateTable:!0,onReloadTable:p,keyPageParam:"importPage",keyPerPageParam:"importPerPage",showPaginationEllipsis:!0,maxVisiblePages:10,divStyle:{height:"50vh"}})})})]})},M=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{F as R,R as S,M as a};
