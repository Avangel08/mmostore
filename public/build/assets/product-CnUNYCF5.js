import{X as C,d as P,A as D,j as t,R,S as O}from"./ContextMenuProvider-CUf15T8b.js";import{L as Z}from"./index-DYy9IffC.js";import{Q as k}from"./react-toastify.esm-ZGmoa_RU.js";import{B as $}from"./BreadCrumb-CSK21i94.js";import{u as X}from"./formik.esm-D3LnCktS.js";import{c as Y,g as B,a as b}from"./index.esm-Dr9W4QE-.js";import{S as M}from"./react-select.esm-CjmYAKcX.js";import{s as y}from"./showToast-BZsJ5i2w.js";import{C as U}from"./CustomCKEditor-VXwZlvvv.js";import{F as W,r as H,p as J,a as K}from"./filepond-plugin-image-preview.esm-6n_xj49a.js";import{u as Q}from"./useTranslation-CcWHtvoZ.js";import{C as q}from"./Container-BlrnZ9Ps.js";import{R as f}from"./Row-Cl0apHvl.js";import{C as _}from"./Col-6EOqiNtv.js";import{C as G}from"./Card-kFH9kF2D.js";import{F as n}from"./Form-tX-X8fEq.js";import{B as z}from"./Button-D8tMtwFd.js";import"./index-DKnNWrZg.js";import"./RightSidebar-BxaNc7D9.js";import"./Dropdown-Dk26w-PX.js";import"./ThemeProvider-B97jU0sy.js";import"./querySelectorAll-a65Eisif.js";import"./useMergedRefs-DxqJFB1B.js";import"./SSRProvider-BK0TK1ss.js";import"./useEventCallback-BkinHRQ0.js";import"./useIsomorphicEffect-7Ts4-1Xz.js";import"./useWindow-BmGtZXAu.js";import"./SelectableContext-Vjq9v8CG.js";import"./NavbarContext-Wd2oAS9m.js";import"./Button-NCU6JKbY.js";import"./DataKey-DjdvojM5.js";import"./hook-DbYEYK7e.js";import"./extends-CF3RwP-h.js";import"./setPrototypeOf-B4fUID9J.js";import"./useEventCallback-D9rniTUJ.js";import"./Anchor-Bu2f26Hu.js";import"./InputGroupContext-Dg1iS0gZ.js";import"./thunk-rMgAJhEa.js";import"./index-DxlJFdn6.js";import"./throttle-CzOjd-at.js";import"./isSymbol-CYvIzdD2.js";import"./reselect-CiXCCDx7.js";import"./AbstractModalHeader-BnVnJchn.js";import"./hasClass-B-lVPIr_.js";import"./NoopTransition-CYuCxw2t.js";import"./TransitionWrapper-BiovwvO2.js";import"./CloseButton-CjwmBX8Z.js";import"./Fade-PIrusN3V.js";import"./divWithClassName-F6D8z14O.js";import"./Collapse-CMEv0_-t.js";import"./logo-dark-Dh4DV6bR.js";import"./logo-light-D3OEWz0M.js";import"./avatar-1-PHP4S1R6.js";import"./toString-DZQbVhdU.js";import"./hoist-non-react-statics.cjs-BQLgnwv_.js";import"./inherits-0xqp8bJF.js";import"./CardHeaderContext-CqMd3CTm.js";/*!
 * FilePondPluginFileValidateType 1.2.9
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const w=({addFilter:s,utils:l})=>{const{Type:d,isString:F,replaceInString:p,guesstimateMimeType:i,getExtensionFromFilename:o,getFilenameFromURL:u}=l,T=(r,e)=>{const c=(/^[^/]+/.exec(r)||[]).pop(),a=e.slice(0,-2);return c===a},j=(r,e)=>r.some(c=>/\*$/.test(c)?T(e,c):c===e),x=r=>{let e="";if(F(r)){const c=u(r),a=o(c);a&&(e=i(a))}else e=r.type;return e},E=(r,e,c)=>{if(e.length===0)return!0;const a=x(r);return c?new Promise((h,g)=>{c(r,a).then(m=>{j(e,m)?h():g()}).catch(g)}):j(e,a)},L=r=>e=>r[e]===null?!1:r[e]||e;return s("SET_ATTRIBUTE_TO_OPTION_MAP",r=>Object.assign(r,{accept:"acceptedFileTypes"})),s("ALLOW_HOPPER_ITEM",(r,{query:e})=>e("GET_ALLOW_FILE_TYPE_VALIDATION")?E(r,e("GET_ACCEPTED_FILE_TYPES")):!0),s("LOAD_FILE",(r,{query:e})=>new Promise((c,a)=>{if(!e("GET_ALLOW_FILE_TYPE_VALIDATION")){c(r);return}const h=e("GET_ACCEPTED_FILE_TYPES"),g=e("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),m=E(r,h,g),I=()=>{const S=h.map(L(e("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(N=>N!==!1),A=S.filter((N,v)=>S.indexOf(N)===v);a({status:{main:e("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:p(e("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:A.join(", "),allButLastType:A.slice(0,-1).join(", "),lastType:A[A.length-1]})}})};if(typeof m=="boolean")return m?c(r):I();m.then(()=>{c(r)}).catch(I)})),{options:{allowFileTypeValidation:[!0,d.BOOLEAN],acceptedFileTypes:[[],d.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",d.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",d.STRING],fileValidateTypeLabelExpectedTypesMap:[{},d.OBJECT],fileValidateTypeDetectType:[null,d.FUNCTION]}}},ee=typeof window<"u"&&typeof window.document<"u";ee&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:w}));/*!
 * FilePondPluginFileValidateSize 2.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const V=({addFilter:s,utils:l})=>{const{Type:d,replaceInString:F,toNaturalFileSize:p}=l;return s("ALLOW_HOPPER_ITEM",(i,{query:o})=>{if(!o("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;const u=o("GET_MAX_FILE_SIZE");if(u!==null&&i.size>u)return!1;const T=o("GET_MIN_FILE_SIZE");return!(T!==null&&i.size<T)}),s("LOAD_FILE",(i,{query:o})=>new Promise((u,T)=>{if(!o("GET_ALLOW_FILE_SIZE_VALIDATION"))return u(i);const j=o("GET_FILE_VALIDATE_SIZE_FILTER");if(j&&!j(i))return u(i);const x=o("GET_MAX_FILE_SIZE");if(x!==null&&i.size>x){T({status:{main:o("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:F(o("GET_LABEL_MAX_FILE_SIZE"),{filesize:p(x,".",o("GET_FILE_SIZE_BASE"),o("GET_FILE_SIZE_LABELS",o))})}});return}const E=o("GET_MIN_FILE_SIZE");if(E!==null&&i.size<E){T({status:{main:o("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:F(o("GET_LABEL_MIN_FILE_SIZE"),{filesize:p(E,".",o("GET_FILE_SIZE_BASE"),o("GET_FILE_SIZE_LABELS",o))})}});return}const L=o("GET_MAX_TOTAL_FILE_SIZE");if(L!==null&&o("GET_ACTIVE_ITEMS").reduce((e,c)=>e+c.fileSize,0)>L){T({status:{main:o("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:F(o("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:p(L,".",o("GET_FILE_SIZE_BASE"),o("GET_FILE_SIZE_LABELS",o))})}});return}u(i)})),{options:{allowFileSizeValidation:[!0,d.BOOLEAN],maxFileSize:[null,d.INT],minFileSize:[null,d.INT],maxTotalFileSize:[null,d.INT],fileValidateSizeFilter:[null,d.FUNCTION],labelMinFileSizeExceeded:["File is too small",d.STRING],labelMinFileSize:["Minimum file size is {filesize}",d.STRING],labelMaxFileSizeExceeded:["File is too large",d.STRING],labelMaxFileSize:["Maximum file size is {filesize}",d.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",d.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",d.STRING]}}},te=typeof window<"u"&&typeof window.document<"u";te&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:V}));H(J,K,w,V);function ie(){const{t:s}=Q(),{product:l,categories:d,productTypes:F}=C().props,p=!!l,i=C().props.errors,o=C().props.storageUrl,[u,T]=P.useState(d||[]),[j,x]=P.useState([]),E=u==null?void 0:u.map(a=>({value:a.id,label:a.name})),L=[{value:"ACTIVE",label:s("Active")},{value:"INACTIVE",label:s("Inactive")}],r=F.map(a=>({value:(a==null?void 0:a.id)??"",label:s((a==null?void 0:a.name)??"")})),e=X({initialValues:{productName:(l==null?void 0:l.name)||"",categoryId:(l==null?void 0:l.category_id)||"",status:(l==null?void 0:l.status)||"ACTIVE",productTypeId:(l==null?void 0:l.product_type_id)||"",shortDescription:(l==null?void 0:l.short_description)||"",detailDescription:(l==null?void 0:l.detail_description)||"",image:null},validationSchema:Y({productName:b().max(255,s("Must be 255 characters or less")).required(s("Please enter product name")),categoryId:b().required(s("Please select a category")),status:b().required(s("Please select status")),productTypeId:b().required(s("Please select product type")),shortDescription:b().max(150,s("Must be 150 characters or less")).required(s("Please enter short description")),detailDescription:b().required(s("Please enter detailed description")),image:p?B().nullable():B().required(s("Please select a product image"))}),onSubmit:a=>{const h=p?route("seller.product.update",{id:l.id}):route("seller.product.store"),g=p?"put":"post",m=new FormData;m.append("productName",a.productName),m.append("categoryId",a.categoryId),m.append("status",a.status),m.append("productTypeId",a.productTypeId),m.append("shortDescription",a.shortDescription),m.append("detailDescription",a.detailDescription),a.image&&m.append("image",a.image),g==="put"&&m.append("_method","PUT"),D.post(h,m,{preserveScroll:!0,onSuccess:I=>{var S,A,N,v;if((A=(S=I.props)==null?void 0:S.message)!=null&&A.error){y(s(I.props.message.error),"error");return}(v=(N=I.props)==null?void 0:N.message)!=null&&v.success&&y(s(I.props.message.success),"success"),p?x([]):setTimeout(()=>{D.get(route("seller.product.index"))},1500)},onError:I=>{Object.keys(I).forEach(S=>{y(s(I[S]),"error")})}})}}),c=(E==null?void 0:E.find(a=>(a==null?void 0:a.value)===e.values.categoryId))||null;return t.jsxs(R.Fragment,{children:[t.jsx(O,{title:s(p?"Edit product":"Add product")}),t.jsxs("div",{className:"page-content",children:[t.jsx(k,{}),t.jsxs(q,{fluid:!0,children:[t.jsx($,{title:s(p?"Edit product":"Add product"),pageTitle:s("Product Management")}),t.jsx(f,{className:"px-3",children:t.jsx(_,{xs:12,children:t.jsxs(G,{children:[t.jsx(G.Header,{children:t.jsx("h5",{className:"card-title mb-0",children:s(p?"Edit product":"Add product")})}),t.jsx(G.Body,{children:t.jsxs(n,{onSubmit:e.handleSubmit,noValidate:!0,className:"p-2",children:[t.jsxs(f,{className:"mb-4",children:[t.jsx(_,{md:6,children:t.jsxs(n.Group,{controlId:"productName",children:[t.jsxs(n.Label,{children:[s("Product name")," ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(n.Control,{type:"text",placeholder:s("Enter product name"),name:"productName",onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.productName,isInvalid:!!(e.touched.productName&&e.errors.productName||i!=null&&i.productName)}),t.jsx(n.Control.Feedback,{type:"invalid",children:s(e.errors.productName||(i==null?void 0:i.name))})]})}),t.jsx(_,{md:6,children:t.jsxs(n.Group,{controlId:"categoryId",children:[t.jsxs(n.Label,{children:[s("Category")," ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(M,{options:E,placeholder:s("Select category"),value:c,onChange:a=>{e.setFieldValue("categoryId",(a==null?void 0:a.value)||"")},onBlur:()=>e.setFieldTouched("categoryId",!0),onMenuOpen:()=>{D.reload({only:["categories"],onSuccess:a=>{var g;const h=((g=a==null?void 0:a.props)==null?void 0:g.categories)||[];T(h)}})},className:e.touched.categoryId&&e.errors.categoryId||i!=null&&i.categoryId?"is-invalid":""}),(e.touched.categoryId&&e.errors.categoryId||(i==null?void 0:i.categoryId))&&t.jsx("div",{className:"invalid-feedback d-block",children:s(e.errors.categoryId||(i==null?void 0:i.categoryId))})]})})]}),t.jsxs(f,{className:"mb-4",children:[t.jsx(_,{md:6,children:t.jsxs(n.Group,{controlId:"productType",children:[t.jsxs(n.Label,{children:[s("Product type")," ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(M,{options:r,placeholder:s("Select product type"),onMenuOpen:()=>{D.reload({only:["productTypes"],replace:!0})},value:r.find(a=>a.value==e.values.productTypeId),onChange:a=>{e.setFieldValue("productTypeId",(a==null?void 0:a.value)||"")},onBlur:()=>e.setFieldTouched("productTypeId",!0),className:e.touched.productTypeId&&e.errors.productTypeId||i!=null&&i.productTypeId?"is-invalid":""}),(e.touched.productTypeId&&e.errors.productTypeId||(i==null?void 0:i.productTypeId))&&t.jsx("div",{className:"invalid-feedback d-block",children:s(e.errors.productTypeId||(i==null?void 0:i.productTypeId))})]})}),t.jsx(_,{md:6,children:t.jsxs(n.Group,{controlId:"status",children:[t.jsxs(n.Label,{children:[s("Status")," ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(M,{options:L,placeholder:s("Select status"),value:L.find(a=>a.value===e.values.status),onChange:a=>{e.setFieldValue("status",(a==null?void 0:a.value)||"")},onBlur:()=>e.setFieldTouched("status",!0),className:e.touched.status&&e.errors.status||i!=null&&i.status?"is-invalid":""}),(e.touched.status&&e.errors.status||(i==null?void 0:i.status))&&t.jsx("div",{className:"invalid-feedback d-block",children:s(e.errors.status||(i==null?void 0:i.status))})]})})]}),t.jsx(f,{className:"mb-4",children:t.jsx(_,{md:12,children:t.jsxs(n.Group,{controlId:"shortDescription",children:[t.jsxs(n.Label,{children:[s("Short description")," ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(n.Control,{as:"textarea",rows:3,placeholder:s("Enter short description"),name:"shortDescription",onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.shortDescription,isInvalid:!!(e.touched.shortDescription&&e.errors.shortDescription||i!=null&&i.shortDescription)}),t.jsx(n.Control.Feedback,{type:"invalid",children:s(e.errors.shortDescription||(i==null?void 0:i.shortDescription))})]})})}),t.jsx(f,{className:"mb-4",children:t.jsx(_,{md:12,children:t.jsxs(n.Group,{controlId:"detailDescription",children:[t.jsxs(n.Label,{children:[s("Detail description")," ",t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx(U,{data:e.values.detailDescription,onChange:a=>{e.setFieldValue("detailDescription",a)},onBlur:()=>e.setFieldTouched("detailDescription",!0),placeholder:s("Enter detailed description")}),(e.touched.detailDescription&&e.errors.detailDescription||(i==null?void 0:i.detailDescription))&&t.jsx("div",{className:"invalid-feedback d-block",children:s(e.errors.detailDescription||(i==null?void 0:i.detailDescription))})]})})}),p&&(l==null?void 0:l.image)&&t.jsx(f,{className:"mb-4",children:t.jsx(_,{md:12,children:t.jsxs(n.Group,{children:[t.jsx(n.Label,{children:s("Current product image")}),t.jsx("div",{children:t.jsx("a",{target:"_blank",href:`${o}/${l.image}`,children:t.jsx("img",{src:`${o}/${l.image}?v=${Date.now()}`,alt:l.name||s("Product image"),style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain",border:"1px solid #dee2e6",borderRadius:"4px"}})})})]})})}),t.jsx(f,{className:"mb-3",children:t.jsx(_,{md:12,children:t.jsxs(n.Group,{controlId:"image",children:[t.jsxs(n.Label,{children:[s(p?"New product image":"Product image"),!p&&t.jsx("span",{className:"text-danger",children:" *"})]}),t.jsx(W,{files:j,onupdatefiles:a=>{if(x(a),a.length>0&&a[0].file){const h=a[0].file;e.setFieldValue("image",h),e.setFieldTouched("image",!0)}else e.setFieldValue("image",null),e.setFieldTouched("image",!0)},allowMultiple:!1,maxFiles:1,acceptedFileTypes:["image/jpeg","image/jpg","image/png","image/gif","image/webp"],labelIdle:s(`ðŸ“· ${s("Drag & Drop your image or")} <span class="filepond--label-action">${s("Choose file")}</span>`),maxFileSize:"2MB",allowRevert:!0,allowRemove:!0,instantUpload:!1,credits:!1,className:e.touched.image&&e.errors.image||i!=null&&i.image?"is-invalid":""}),(e.touched.image&&e.errors.image||(i==null?void 0:i.image))&&t.jsx("div",{className:"invalid-feedback d-block",children:s(e.errors.image||(i==null?void 0:i.image))})]})})}),t.jsx(f,{children:t.jsx(_,{md:12,children:t.jsxs("div",{className:"d-flex gap-3",children:[t.jsx(z,{variant:"light",onClick:()=>{e.resetForm(),x([]),D.visit(route("seller.product.index"))},children:s("Back")}),t.jsx(z,{variant:"success",type:"submit",children:s(p?"Update":"Save")})]})})})]})})]})})})]})]})]})}ie.layout=s=>t.jsx(Z,{children:s});export{ie as default};
