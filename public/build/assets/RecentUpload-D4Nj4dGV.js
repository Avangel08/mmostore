import{d as n,j as t,X as F,A as R}from"./ContextMenuProvider-CoCa8nFp.js";import{h as I}from"./moment-C5S46NFB.js";import{T as U}from"./TableWithContextMenu-D3jd0tWR.js";import{u as _}from"./useTranslation-79FPa95p.js";import{u as j,c as y}from"./ThemeProvider-C7g3TZJh.js";import{C as S}from"./Col-gyXmhzbn.js";import{B as $}from"./Button-BFUtYQ2I.js";const g=n.forwardRef(({bsPrefix:e,bg:i="primary",pill:m=!1,text:c,className:p,as:f="span",...d},l)=>{const u=j(e,"badge");return t.jsx(f,{ref:l,...d,className:y(p,u,m&&"rounded-pill",c&&`text-${c}`,i&&`bg-${i}`)})});g.displayName="Badge";const P=n.forwardRef(({bsPrefix:e,variant:i,animation:m="border",size:c,as:p="div",className:f,...d},l)=>{e=j(e,"spinner");const u=`${e}-${m}`;return t.jsx(p,{ref:l,...d,className:y(f,u,c&&`${u}-${c}`,i&&`text-${i}`)})});P.displayName="Spinner";const H=()=>{const{t:e}=_(),{importHistory:i}=F().props,[m,c]=n.useState(1),[p,f]=n.useState(10),[d,l]=n.useState(!1),[u,C]=n.useState(0),[h,b]=n.useState(!0),N=n.useCallback((a=1,s=10,r)=>{w(a,s),R.reload({only:["importHistory"],replace:!0,data:{importPage:a,importPerPage:s,...r},onFinish:()=>{l(!1)}})},[]),k=n.useCallback(()=>{const a=Date.now();if(a-u<2e3)return;l(!0),b(!1),C(a);const s=Date.now();R.reload({only:["importHistory"],data:{importPage:m,importPerPage:p},onFinish:()=>{const r=Date.now()-s,o=1e3;r<o?setTimeout(()=>{l(!1)},o-r):l(!1),setTimeout(()=>{b(!0)},2e3)}})},[u,m,p]),w=(a,s)=>{c(a||1),f(s||10)},T=n.useMemo(()=>[{header:e("File name"),accessorKey:"file_path",enableColumnFilter:!1,enableSorting:!0,cell:a=>t.jsx("span",{children:a.getValue().split("/").pop()})},{header:e("Upload date"),accessorKey:"created_at",enableColumnFilter:!1,enableSorting:!0,cell:a=>t.jsx("span",{children:I(a.getValue()).format("DD/MM/YYYY HH:mm")})},{header:e("Status"),accessorKey:"status",enableColumnFilter:!1,enableSorting:!0,cell:a=>{const s=a.getValue()||"Unknown",r={FINISH:e("Finish"),RUNNING:e("Processing"),ERROR:e("Error"),Unknown:e("Unknown")},o={FINISH:"bg-success",RUNNING:"bg-info",ERROR:"bg-danger",Unknown:"bg-dark"};return t.jsx("span",{className:`badge ${(o==null?void 0:o[s])||"bg-dark"} fs-6 fw-medium`,children:e((r==null?void 0:r[s])||"Unknown")})}},{header:e("Result"),accessorKey:"result",enableColumnFilter:!1,enableSorting:!0,cell:a=>{var o,x;const s=a.getValue()||{};return((x=(o=a==null?void 0:a.row)==null?void 0:o.original)==null?void 0:x.status)==="FINISH"?t.jsxs("div",{children:[t.jsxs(g,{bg:"secondary",children:[e("Total"),": ",(s==null?void 0:s.total_count)||0]})," ",t.jsxs(g,{bg:"success",children:[e("Success"),": ",(s==null?void 0:s.success_count)||0]})," ",t.jsxs(g,{bg:"danger",children:[e("Error"),": ",(s==null?void 0:s.error_count)||0]})]}):null}}],[e]);return t.jsxs(t.Fragment,{children:[t.jsxs(S,{lg:12,className:"mb-4 d-flex align-items-center gap-2",children:[t.jsx("h5",{children:e("Recent uploaded files")}),t.jsxs($,{variant:"outline-info",onClick:k,disabled:d||!h,style:{transition:"all 0.3s ease-in-out",opacity:d||!h?.6:1},children:[d&&t.jsx(P,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),e("Refresh")]})]}),t.jsx(S,{lg:12,children:t.jsx("div",{children:t.jsx(U,{columns:T,data:i||[],divClass:"table-responsive table-card mb-3",tableClass:"table align-middle table-nowrap mb-0",theadClass:"table-light",enableContextMenu:!1,isPaginateTable:!0,onReloadTable:N,keyPageParam:"importPage",keyPerPageParam:"importPerPage"})})})]})},V=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{H as R,P as S,V as a};
