import{d as n,f as L,X as P,e as E,j as t,R as I,S as H}from"./ContextMenuProvider-DCdb8j9t.js";import R from"./PageHeader-CFWDLgMr.js";import T from"./index-D2wZSptl.js";import{u as $,c as q,f as y,a as O}from"./index.esm-CC-SwQOh.js";import{s as N}from"./showToast-5wcdUU64.js";import{Q}from"./react-toastify.esm-Bwsw1aoB.js";import{ModalDeposit as X}from"./ModalDeposit-BXhZ8XMr.js";import{LayoutContext as z}from"./LayoutContext-ty_CWxqC.js";import{u as G}from"./Navbar-CjAPrUK0.js";import{c as J}from"./thunk-CnhdTyKr.js";/* empty css                      */import"./LightDark-CrF8-1wK.js";import{u as K}from"./useTranslation-BeBCG-tb.js";import{C as b}from"./Container-B-XzGzbE.js";import{C as l}from"./Card-DyJ45Unj.js";import{F as c}from"./Form-BwWb-AQG.js";import{B as S}from"./Button-DkR4lkD4.js";import"./Row-DcrQzJSf.js";import"./ThemeProvider-B2_W_dCu.js";import"./Col-BKpEL2i4.js";import"./reselect-CiXCCDx7.js";import"./Footer-oIjyy4GS.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-Cl0fTsAK.js";import"./Modal-PiC5wIE_.js";import"./useMergedRefs-qO3RddUr.js";import"./useEventCallback-Blih2yEw.js";import"./useWillUnmount-ClVsaD3q.js";import"./TransitionWrapper-WlnnEX3_.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./AbstractModalHeader-BzQN1u3g.js";import"./useWindow-XMw1SZRE.js";import"./querySelectorAll-BUF6GxAr.js";import"./useEventCallback-B3WkzC8o.js";import"./hasClass-CFrhebZ5.js";import"./NoopTransition-DV-WmqrX.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-DmCN2KAW.js";import"./index-BSRKPwsw.js";import"./Fade-_gEJg8B2.js";import"./divWithClassName-CMPxMdR0.js";import"./Button-DW89RreQ.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./scrollspy-CUB9tACV.js";import"./NavbarContext-BDjdnqqL.js";import"./inherits-B2gPeQio.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-I41DMrFM.js";import"./InputGroup-DeMyQ-IT.js";import"./InputGroupContext-CSG2a_Xx.js";import"./Collapse-DcrjWkI8.js";import"./NavLink-C2m6UJ-U.js";import"./Anchor-BBr3tu3N.js";import"./SelectableContext-BXVmDtUi.js";import"./TabContext-CQlkuOeg.js";import"./Dropdown-D-szNC0L.js";import"./SSRProvider-B7UJ9TZ1.js";import"./useIsomorphicEffect-DBZcWV3F.js";import"./hook-D-Q4NZE6.js";import"./extends-CF3RwP-h.js";const U=()=>{const[u,d]=n.useState(null),[f,p]=n.useState(null),[C,j]=n.useState(!1),[k,w]=n.useState(null),h=n.useContext(z),_=h==null?void 0:h.pingDeposit,x=n.useRef([]),o=G(),v=L(),{listPaymentMethod:r}=P().props;n.useEffect(()=>{o&&v(J(o==null?void 0:o.theme))},[o,v]),n.useEffect(()=>{if(r&&r.length>0&&!i.values.payment_method_id){const s=r[0];g(s)}},[r]);const{t:e}=K(),F=async()=>{V();const s=setInterval(async()=>{await _()&&clearInterval(s)},3e3);x.current.push(s)},V=()=>{x.current.forEach(s=>clearInterval(s)),x.current=[]},g=s=>{const a=(s==null?void 0:s.id)!==void 0&&(s==null?void 0:s.id)!==null?String(s.id):"";i.setFieldValue("payment_method_id",a),(s==null?void 0:s.amount)!==void 0&&(s==null?void 0:s.amount)!==null&&(d(s.amount),p(s.amount),i.setFieldValue("amount",s.amount))},A=s=>{d(s),p(s),i.setFieldValue("amount",s)},B=s=>{p(s),d(null),i.setFieldValue("amount",s)},D=n.useMemo(()=>q({payment_method_id:O().required(e("Please select payment method")),amount:y().min(1e4,e("Amount must be at least 10000")).required(e("Please enter amount"))}),[e]),i=$({initialValues:{payment_method_id:"",amount:0},validationSchema:D,onSubmit:async s=>{const a=route("buyer.deposit.checkout");await E.post(a,s).then(m=>{m.data.status==="success"?(j(!0),w(m.data.data),F()):N(e(m.data.message),"error")}).catch(m=>{N(e(m.response.data.message),"error")})}});return t.jsxs(I.Fragment,{children:[t.jsx(H,{title:(o==null?void 0:o.storeName)??""}),t.jsx(R,{title:(o==null?void 0:o.pageHeaderText)??""}),t.jsx(X,{show:C,onHide:()=>j(!1),data:k}),t.jsx(Q,{}),(r==null?void 0:r.length)===0?t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx(c,{onSubmit:i.handleSubmit,noValidate:!0,children:t.jsx("div",{className:"deposit-section",children:t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["1. ",e("Select your subscription method")]}),t.jsx("div",{className:"payment-methods",children:r==null?void 0:r.map((s,a)=>t.jsx(l,{children:t.jsx(l.Body,{children:t.jsx("div",{children:t.jsxs("div",{className:"form-check mb-2",children:[t.jsx(c.Check.Input,{className:"form-check-input",type:"radio",id:s.id,name:"payment_method_id",value:s.id,checked:i.values.payment_method_id===s.id,onChange:()=>g(s)}),t.jsx(c.Check.Label,{className:"form-check-label",htmlFor:s.id,children:t.jsx("div",{className:"d-flex align-items-center",children:t.jsxs("span",{className:"d-block justify-content-center",children:[s.title," ( ",s.name," )"]})})})]})})})},a))})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["2. ",e("Deposit amount")]}),t.jsx("div",{className:"amount-options mb-3",children:t.jsx("div",{className:"btn-group w-100",children:[1e4,2e4,5e4,1e5,5e5].map(s=>t.jsx(S,{variant:u===s?"primary":"outline-secondary",onClick:()=>A(s),children:s.toLocaleString("vi-VN")},s))})}),t.jsxs("div",{className:"mb-3",children:[t.jsxs(c.Label,{children:[e("Or enter custom amount"),":"]}),t.jsx(c.Control,{name:"amount",type:"text",placeholder:e("Enter amount"),value:f?f.toLocaleString("vi-VN"):"",onChange:s=>{const a=s.target.value.replace(/\./g,""),m=a?Number(a):null;B(m),i.setFieldValue("amount",m)},onBlur:i.handleBlur,className:`form-control ${i.touched.amount&&i.errors.amount?"is-invalid":""}`}),t.jsx(c.Control.Feedback,{type:"invalid",children:e(i.errors.amount||"")})]}),t.jsx(S,{variant:"primary",className:"w-100",type:"submit",disabled:i.isSubmitting,children:i.isSubmitting?e("Processing..."):e("Pay now")})]})]})})})})})}):t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx("h6",{children:e("No payment methods available. Please contact support")})})})})]})};U.layout=u=>t.jsx(T,{children:u});export{U as default};
