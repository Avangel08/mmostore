import{i as q,c as W,S as $}from"./react-select.esm-Ci0lS3LH.js";import{d as u,R as z,j as F}from"./ContextMenuProvider-DoI9LuTu.js";var B={};Object.defineProperty(B,"__esModule",{value:!0});function K(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.length===2)return x(e[0],e[1])||null;var t=e.slice(1).reduce(function(r,o){return x(r,o)},e[0]);return t||null}var Y=B.default=K,V=new WeakMap;function x(e,n){if(e&&n){var t=V.get(e)||new WeakMap;V.set(e,t);var r=t.get(n)||function(o){U(e,o),U(n,o)};return t.set(n,r),r}return e||n}function U(e,n){typeof e=="function"?e(n):e.current=n}var _=Symbol("useLazyRef empty value"),G=e=>{const n=u.useRef(_);return n.current===_&&(n.current=e()),n};function J(){var e=u.useRef(!1);return u.useEffect(function(){return e.current=!0,function(){e.current=!1}},[]),e}var y=function(n){var t=z.useRef(n);return q(function(){t.current=n}),t};function L(e){return{isOk:()=>!0,isOkAnd:t=>t(e),isErr:()=>!1,isErrAnd:()=>!1,ok:()=>P(e),err:()=>I(),map:t=>L(t(e)),mapOr:(t,r)=>r(e),mapOrElse:(t,r)=>r(e),mapErr:()=>L(e),expect:()=>e,expectErr:t=>{throw new Error(t)},unwrap:()=>e,unwrapErr:()=>{throw new Error(`${e}`)},unwrapOr:()=>e,unwrapOrElse:()=>e,and:t=>t,andThen:t=>t(e),or:()=>L(e),orElse:()=>L(e)}}function v(e){return{isOk:()=>!1,isOkAnd:()=>!1,isErr:()=>!0,isErrAnd:t=>t(e),ok:()=>I(),err:()=>P(e),map:()=>v(e),mapOr:t=>t,mapOrElse:t=>t(e),mapErr:t=>v(t(e)),expect:t=>{throw new Error(t)},expectErr:()=>e,unwrap:()=>{throw new Error(`${e}`)},unwrapErr:()=>e,unwrapOr:t=>t,unwrapOrElse:t=>t(e),and:()=>v(e),andThen:()=>v(e),or:t=>t,orElse:t=>t(e)}}function I(){const e={and:()=>I(),andThen:()=>I(),expect:n=>{throw new Error(n)},filter:()=>e,isSome:()=>!1,isSomeAnd:()=>!1,isNone:()=>!0,map:()=>I(),mapOr:n=>n,mapOrElse:n=>n(),okOr:n=>v(n),okOrElse:n=>v(n()),or:n=>n,orElse:n=>n(),unwrap:()=>{throw new Error("panic! call `unwrap` on a `None` value")},unwrapOr:n=>n,unwrapOrElse:n=>n(),xor:n=>n.isSome()?n:e};return e}function P(e){const n={and:t=>t,andThen:t=>t(e),expect:()=>e,filter:t=>t(e)?n:I(),isSome:()=>!0,isSomeAnd:t=>t(e),isNone:()=>!1,map:t=>P(t(e)),mapOr:(t,r)=>r(e),mapOrElse:(t,r)=>r(e),okOr:()=>L(e),okOrElse:()=>L(e),or:()=>n,orElse:()=>n,unwrap:()=>e,unwrapOr:()=>e,unwrapOrElse:()=>e,xor:t=>t.isNone()?n:I()};return n}function Q(e){return e.then(n=>L(n),n=>v(n))}var X=setTimeout;function Z(e,n){var t=n.useCachedSetTimeout?X:setTimeout;return new Promise(function(r){t(r,e)})}function ee(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n.useCachedSetTimeout,r=Z(e,{useCachedSetTimeout:t});function o(l){return r.then(function(){return l})}return o.then=function(){return r.then.apply(r,arguments)},o.catch=Promise.resolve().catch,o}var ne=300;function te(e){function n(t){const{selectProps:r,innerRef:o}=t,{handleScrolledToBottom:l,shouldLoadMore:p}=r,c=u.useRef(null),s=u.useRef(null),h=u.useCallback(()=>{const i=s.current;if(!i)return!1;const{scrollTop:O,scrollHeight:d,clientHeight:f}=i;return p(d,f,O)},[p]),a=u.useCallback(()=>{h()&&l&&l()},[h,l]),g=u.useMemo(()=>{const i=()=>{a(),c.current=setTimeout(i,ne)};return i},[a]);return u.useEffect(()=>(g(),()=>{c.current&&clearTimeout(c.current)}),[]),F.jsx(e,{...t,innerRef:Y(o,s)})}return n}var re=te(W.MenuList),oe=e=>u.useMemo(()=>({MenuList:re,...e}),[e]),se=(e,n)=>[...e,...n],ue=10,ae=(e,n,t)=>e-n-ue<t,H=e=>({isFirstLoad:!0,options:[],hasMore:!0,isLoading:!1,lockedUntil:0,additional:e.additional}),ie=({options:e,defaultOptions:n,additional:t,defaultAdditional:r})=>{const o=n===!0?null:Array.isArray(n)?n:e;return o?{"":{isFirstLoad:!1,isLoading:!1,options:o,hasMore:!0,lockedUntil:0,additional:r||t}}:{}},j='[react-select-async-paginate] response of "loadOptions" should be an object with "options" prop, which contains array of options.',ce=e=>{if(!e)return!1;const{options:n,hasMore:t}=e;return!(!Array.isArray(n)||typeof t!="boolean"&&typeof t<"u")},le=e=>{if(!ce(e))throw console.error(j,"Received:",e),new Error(j);return!0},fe=async(e,n,t,r,o,l,p,c)=>{const s=n.current.inputValue,h=!t.current[s],a=h?H(n.current):t.current[s];if(a.isLoading||!a.hasMore||a.lockedUntil>Date.now())return;if(o(f=>c&&e==="input-change"?{[s]:{...a,isLoading:!0}}:{...f,[s]:{...a,isLoading:!0}}),r>0&&e==="input-change"){await ee(r);const f=n.current.inputValue;if(s!==f){o(w=>{if(h){const{[s]:E,...M}=w;return M}return{...w,[s]:{...a,isLoading:!1}}});return}}const{loadOptions:g,reloadOnErrorTimeout:i=0}=n.current,O=await Q(Promise.resolve().then(()=>g(s,a.options,a.additional)));if(!p.current)return;if(O.isErr()){o(f=>({...f,[s]:{...a,isLoading:!1,lockedUntil:Date.now()+i}}));return}const d=O.unwrap();if(le(d)){const{options:f,hasMore:w}=d,E=Object.hasOwn(d,"additional")?d.additional:a.additional;o(M=>({...M,[s]:{...a,options:l(a.options,f,E),hasMore:!!w,isLoading:!1,isFirstLoad:!1,additional:E}}))}},T=e=>e+1,pe=(e,n=[])=>{const{clearCacheOnSearchChange:t=!1,clearCacheOnMenuClose:r=!1,defaultOptions:o,loadOptionsOnMenuOpen:l=!0,debounceTimeout:p=0,inputValue:c,menuIsOpen:s,filterOption:h=null,reduceOptions:a=se,shouldLoadMore:g=ae,mapOptionsForMenu:i=void 0}=e,O=y(s),d=J(),f=y(a),w=y(l),E=u.useRef(!0),M=u.useRef(e);M.current=e;const[C,S]=u.useState(0),m=G(()=>ie(e)),R=y(A=>{fe(A,M,m,p,b=>{m.current=b(m.current),d.current&&S(T)},f.current,d,t)}),D=u.useCallback(()=>{const A=M.current.inputValue;m.current[A]&&R.current("menu-scroll")},[R,m]);u.useEffect(()=>{E.current?E.current=!1:(m.current={},S(T)),o===!0&&R.current("autoload")},n),u.useEffect(()=>{O.current&&!m.current[c]&&R.current("input-change")},[R,c,O,m]),u.useEffect(()=>{if(s){if(!m.current[""]&&w.current){R.current("menu-toggle");return}return}r&&(m.current={},S(T))},[R,w,s,m,r]);const k=m.current[c]||H(e),N=u.useMemo(()=>i?i(k.options):k.options,[k.options,i]);return{handleScrolledToBottom:D,shouldLoadMore:g,filterOption:h,isLoading:k.isLoading||k.lockedUntil>Date.now(),isFirstLoad:k.isFirstLoad,options:N}},de=(e,n=[])=>{const{inputValue:t,menuIsOpen:r,defaultInputValue:o,defaultMenuIsOpen:l,onInputChange:p,onMenuClose:c,onMenuOpen:s}=e,[h,a]=u.useState(o||""),[g,i]=u.useState(!!l),O=typeof t=="string"?t:h,d=typeof r=="boolean"?r:g,f=u.useCallback((C,S)=>{p&&p(C,S),a(C)},[p]),w=u.useCallback(()=>{c&&c(),i(!1)},[c]),E=u.useCallback(()=>{s&&s(),i(!0)},[s]);return{...pe({...e,inputValue:O,menuIsOpen:d},n),inputValue:O,menuIsOpen:d,onInputChange:f,onMenuClose:w,onMenuOpen:E}},me=[],he={};function Oe(e){function n(t){const{components:r=he,selectRef:o=void 0,isLoading:l,cacheUniqs:p=me,menuPlacement:c,menuShouldScrollIntoView:s,...h}=t,a=de(h,p),g=oe(r),i=typeof l=="boolean"?l:a.isLoading;return F.jsx(e,{...t,...a,menuPlacement:c,menuShouldScrollIntoView:c==="auto"&&i?!1:s,isLoading:i,components:g,ref:o})}return n}var Ee=Oe($);export{Ee as A};
