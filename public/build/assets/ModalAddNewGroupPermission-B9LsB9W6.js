import{R as g,X as b,A as D,d as S,j as e}from"./ContextMenuProvider-C6Zbl1jY.js";import{u as w,c as A,d as K,a as m}from"./index.esm-DDmU3ThL.js";import{s as f}from"./showToast-fbb08ABK.js";import{u as I}from"./useTranslation-BhZFnGss.js";import{M as u}from"./Modal-872qn2Lf.js";import{F as o}from"./Form-BfHf_XRV.js";import{C as $}from"./Container-DuqY1l5C.js";import{R as N}from"./Row-BBuYYMjV.js";import{C as k}from"./Col-L5NkX0nX.js";import{B as x}from"./Button-Chz4fRXx.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-DQogQWOa.js";import"./react-toastify.esm-CuUT_FeT.js";import"./ThemeProvider-pZJi_k1m.js";import"./useMergedRefs-B6t_QqDd.js";import"./useEventCallback-D1I9Eqpd.js";import"./useWillUnmount-DBOrVC9s.js";import"./TransitionWrapper-CaF58Jrg.js";import"./setPrototypeOf-B4fUID9J.js";import"./AbstractModalHeader-C5r8ZRHZ.js";import"./useWindow-CLBUEokQ.js";import"./querySelectorAll-D2irIcMG.js";import"./useEventCallback-BrpCD40C.js";import"./hasClass-pPcchvBp.js";import"./NoopTransition-Dpcpe6YD.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-zBsxik1D.js";import"./index-DCwKZfII.js";import"./Fade-DeSGF47Y.js";import"./divWithClassName-BLdvSJyI.js";import"./Button-CsU7cm0L.js";const Pe=({show:y,onHide:d})=>{var v;const{t:i}=I(),p=g.useRef(null),{guards:h}=b().props,{errors:P}=b().props,[j,L]=g.useState(["view","create","edit","delete"]),t=g.useRef(null),r=w({initialValues:{groupPermissionName:"",groupPermissionDescription:"",groupPermissionKey:"",groupPermissionGuard:"",groupPermissionValue:[]},validationSchema:A({groupPermissionName:m().max(50,"Must be 50 characters or less").required(i("Please enter this field")),groupPermissionDescription:m().max(1e3,"Must be 1000 characters or less"),groupPermissionKey:m().max(50,"Must be 50 characters or less").required(i("Please enter this field")),groupPermissionGuard:m().required(i("Please select guard")),groupPermissionValue:K().min(1,"Please select at least one permission").of(m().max(50,"Must be 50 characters or less"))}),onSubmit:s=>{D.post(route("admin.permissions.add"),s,{onSuccess:a=>{var n,l,c,C;if((l=(n=a.props)==null?void 0:n.message)!=null&&l.error){f(i(a.props.message.error),"error");return}r.resetForm(),d(),(C=(c=a.props)==null?void 0:c.message)!=null&&C.success&&f(i(a.props.message.success),"success")}})}});S.useEffect(()=>{r.setErrors(P||{})},[P]);const V=s=>{var n,l;const a=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");a.trim()===""?(n=p.current)==null||n.classList.add("d-none"):(l=p.current)==null||l.classList.remove("d-none"),r.setFieldValue("groupPermissionKey",a)},B=()=>{document.getElementById("checkAll").checked?r.setFieldValue("groupPermissionValue",j.concat("all")):r.setFieldValue("groupPermissionValue",[])},F=s=>{const a=s.target.value,n=s.target.checked;let l=[...r.values.groupPermissionValue];n?l.push(a):l=l.filter(c=>c!==a),r.setFieldValue("groupPermissionValue",l)},G=()=>{var s;if((s=t==null?void 0:t.current)!=null&&s.value){const a=t.current.value;L(n=>n.includes(a)?n:[...n,a]),t.current.value=""}};return e.jsx(u,{id:"myModal",backdrop:"static",show:y,onHide:()=>{r.resetForm(),d()},centered:!0,children:e.jsxs(o,{onSubmit:r.handleSubmit,noValidate:!0,children:[e.jsx(u.Header,{closeButton:!0,children:e.jsx("h5",{children:i("Add new group permission")})}),e.jsxs(u.Body,{children:[e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionName",children:[e.jsxs(o.Label,{children:[i("Group permission name")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:i("Enter group permission name"),maxLength:50,onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionName,isInvalid:!!(r.touched.groupPermissionName&&r.errors.groupPermissionName)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionName})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionGuard",children:[e.jsxs(o.Label,{children:[i("Guard")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(o.Select,{onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionGuard,isInvalid:!!(r.touched.groupPermissionGuard&&r.errors.groupPermissionGuard),children:[e.jsx("option",{value:"",children:i("Select guard")}),h==null?void 0:h.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionGuard})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionDescription",children:[e.jsx(o.Label,{children:i("Description")}),e.jsx(o.Control,{as:"textarea",rows:6,maxLength:1e3,placeholder:i("Enter description"),onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionDescription,isInvalid:!!(r.touched.groupPermissionDescription&&r.errors.groupPermissionDescription)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionDescription})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionKey",children:[e.jsxs(o.Label,{children:["Key ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:i("Enter key"),onChange:s=>{V(s)},maxLength:50,onBlur:r.handleBlur,value:r.values.groupPermissionKey,isInvalid:!!(r.touched.groupPermissionKey&&r.errors.groupPermissionKey)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionKey})]}),e.jsxs(o.Group,{ref:p,id:"permissionCheckbox",className:"mb-3 d-none",controlId:"groupPermissionValue",children:[e.jsxs(o.Label,{htmlFor:"",children:[i("Permissions")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs($,{children:[e.jsxs(N,{children:[e.jsx(k,{xs:12,className:"mb-2",children:e.jsx(o.Check,{id:"checkAll",type:"checkbox",value:"all",label:i("Select all"),onChange:s=>{B()},onBlur:r.handleBlur,checked:(v=r.values.groupPermissionValue)==null?void 0:v.includes("all")})}),j.map(s=>{var a;return e.jsx(k,{xs:12,lg:6,className:"mb-2",children:e.jsx(o.Check,{type:"checkbox",id:`form-check-${s}`,value:s,label:`${r.values.groupPermissionKey}_${s}`,onChange:n=>{F(n)},onBlur:r.handleBlur,checked:(a=r.values.groupPermissionValue)==null?void 0:a.includes(s)},s)})})]}),e.jsx(N,{children:r.touched.groupPermissionValue&&r.errors.groupPermissionValue&&e.jsx("div",{className:"text-danger",style:{fontSize:"0.875em"},children:r.errors.groupPermissionValue})}),e.jsxs(o.Group,{className:"d-flex flex-row gap-2 mt-3",children:[e.jsx(o.Control,{placeholder:i("Input permission name"),maxLength:50,ref:t,onChange:s=>{const a=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");s.target.value=a}}),e.jsx(x,{size:"sm",variant:"primary",onClick:G,children:i("Add")})]})]})]})]}),e.jsxs(u.Footer,{children:[e.jsx(x,{variant:"light",onClick:()=>{r.resetForm(),d()},children:i("Close")}),e.jsx(x,{variant:"primary",type:"submit",children:i("Add new")})]})]})})};export{Pe as ModalAddNewGroupPermission};
