import{d as n,f as L,X as P,e as E,j as t,R as I,S as H}from"./ContextMenuProvider-BhVN3MI2.js";import R from"./PageHeader-B5f8h8L-.js";import T from"./index-Bn6FTC_I.js";import{u as $,c as q,f as y,a as O}from"./index.esm-C_ZlIYoE.js";import{s as N}from"./showToast-BKDwzp8a.js";import{Q}from"./react-toastify.esm-Bzp-JuTX.js";import{ModalDeposit as X}from"./ModalDeposit-CpWw5U9d.js";import{LayoutContext as z}from"./LayoutContext-cxyWDEXN.js";import{u as G}from"./Navbar-CPURu2fc.js";import{c as J}from"./thunk-CNTob9NR.js";/* empty css                      */import"./LightDark-DREMPlwr.js";import{u as K}from"./useTranslation-ZbZFIHja.js";import{C as b}from"./Container-DaelVuOS.js";import{C as l}from"./Card-CRQW63gX.js";import{F as c}from"./Form-B_1_SP-R.js";import{B as S}from"./Button-CT1W-dlW.js";import"./Row-DTCryV-T.js";import"./ThemeProvider-CUiVOj3n.js";import"./Col-CDTbDU3W.js";import"./reselect-CiXCCDx7.js";import"./Footer-BEzeOthk.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-3lIPCjJv.js";import"./Modal-C594Uytt.js";import"./useMergedRefs-BdX62CzH.js";import"./useEventCallback-DN7Xb1FR.js";import"./useWillUnmount-RaeYL0I0.js";import"./TransitionWrapper-CHWC6Aev.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./AbstractModalHeader-ONgXPvo5.js";import"./useWindow-D06ww4p5.js";import"./querySelectorAll-BZjzdW4C.js";import"./useEventCallback-kYw4fXYA.js";import"./hasClass-Du0ceSUq.js";import"./NoopTransition-Ba3l4ZU6.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-D0xq5bFg.js";import"./index-CMi1q9xw.js";import"./Fade-DZUndS-E.js";import"./divWithClassName-DOGM4Upq.js";import"./Button-ItoOpMhW.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./scrollspy-uLmSEELI.js";import"./NavbarContext-DFScsAQa.js";import"./inherits-B2gPeQio.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-DYgNIhan.js";import"./InputGroup-CbYy0et-.js";import"./InputGroupContext-BOLuIn5_.js";import"./Collapse-jWBU_wvy.js";import"./NavLink-4S5agp7j.js";import"./Anchor-Dcci9ZUU.js";import"./SelectableContext-C5rX9-0C.js";import"./TabContext-BvLUMeJu.js";import"./Dropdown-DAdvUZKT.js";import"./SSRProvider-CdYR2PPq.js";import"./useIsomorphicEffect-0xLopGc7.js";import"./hook-Dwnxsckw.js";import"./extends-CF3RwP-h.js";const U=()=>{const[u,d]=n.useState(null),[f,p]=n.useState(null),[C,j]=n.useState(!1),[k,w]=n.useState(null),h=n.useContext(z),_=h==null?void 0:h.pingDeposit,x=n.useRef([]),o=G(),v=L(),{listPaymentMethod:r}=P().props;n.useEffect(()=>{o&&v(J(o==null?void 0:o.theme))},[o,v]),n.useEffect(()=>{if(r&&r.length>0&&!i.values.payment_method_id){const s=r[0];g(s)}},[r]);const{t:e}=K(),F=async()=>{V();const s=setInterval(async()=>{await _()&&clearInterval(s)},3e3);x.current.push(s)},V=()=>{x.current.forEach(s=>clearInterval(s)),x.current=[]},g=s=>{const a=(s==null?void 0:s.id)!==void 0&&(s==null?void 0:s.id)!==null?String(s.id):"";i.setFieldValue("payment_method_id",a),(s==null?void 0:s.amount)!==void 0&&(s==null?void 0:s.amount)!==null&&(d(s.amount),p(s.amount),i.setFieldValue("amount",s.amount))},A=s=>{d(s),p(s),i.setFieldValue("amount",s)},B=s=>{p(s),d(null),i.setFieldValue("amount",s)},D=n.useMemo(()=>q({payment_method_id:O().required(e("Please select payment method")),amount:y().min(1e4,e("Amount must be at least 10000")).required(e("Please enter amount"))}),[e]),i=$({initialValues:{payment_method_id:"",amount:0},validationSchema:D,onSubmit:async s=>{const a=route("buyer.deposit.checkout");await E.post(a,s).then(m=>{m.data.status==="success"?(j(!0),w(m.data.data),F()):N(e(m.data.message),"error")}).catch(m=>{N(e(m.response.data.message),"error")})}});return t.jsxs(I.Fragment,{children:[t.jsx(H,{title:(o==null?void 0:o.storeName)??""}),t.jsx(R,{title:(o==null?void 0:o.pageHeaderText)??""}),t.jsx(X,{show:C,onHide:()=>j(!1),data:k}),t.jsx(Q,{}),(r==null?void 0:r.length)===0?t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx(c,{onSubmit:i.handleSubmit,noValidate:!0,children:t.jsx("div",{className:"deposit-section",children:t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["1. ",e("Select your subscription method")]}),t.jsx("div",{className:"payment-methods",children:r==null?void 0:r.map((s,a)=>t.jsx(l,{children:t.jsx(l.Body,{children:t.jsx("div",{children:t.jsxs("div",{className:"form-check mb-2",children:[t.jsx(c.Check.Input,{className:"form-check-input",type:"radio",id:s.id,name:"payment_method_id",value:s.id,checked:i.values.payment_method_id===s.id,onChange:()=>g(s)}),t.jsx(c.Check.Label,{className:"form-check-label",htmlFor:s.id,children:t.jsx("div",{className:"d-flex align-items-center",children:t.jsxs("span",{className:"d-block justify-content-center",children:[s.title," ( ",s.name," )"]})})})]})})})},a))})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["2. ",e("Deposit amount")]}),t.jsx("div",{className:"amount-options mb-3",children:t.jsx("div",{className:"btn-group w-100",children:[1e4,2e4,5e4,1e5,5e5].map(s=>t.jsx(S,{variant:u===s?"primary":"outline-secondary",onClick:()=>A(s),children:s.toLocaleString("vi-VN")},s))})}),t.jsxs("div",{className:"mb-3",children:[t.jsxs(c.Label,{children:[e("Or enter custom amount"),":"]}),t.jsx(c.Control,{name:"amount",type:"text",placeholder:e("Enter amount"),value:f?f.toLocaleString("vi-VN"):"",onChange:s=>{const a=s.target.value.replace(/\./g,""),m=a?Number(a):null;B(m),i.setFieldValue("amount",m)},onBlur:i.handleBlur,className:`form-control ${i.touched.amount&&i.errors.amount?"is-invalid":""}`}),t.jsx(c.Control.Feedback,{type:"invalid",children:e(i.errors.amount||"")})]}),t.jsx(S,{variant:"primary",className:"w-100",type:"submit",disabled:i.isSubmitting,children:i.isSubmitting?e("Processing..."):e("Pay now")})]})]})})})})})}):t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx("h6",{children:e("No payment methods available. Please contact support")})})})})]})};U.layout=u=>t.jsx(T,{children:u});export{U as default};
