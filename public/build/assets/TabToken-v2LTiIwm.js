import{X as D,d as f,j as s,A as h}from"./ContextMenuProvider-1cB75p-p.js";import{s as n}from"./showToast-BmC33B7c.js";import{c as A}from"./copyToClipboard-B5-eBniM.js";import{a as I}from"./sweetAlert-SIy78xZI.js";import{h as C}from"./moment-C5S46NFB.js";import{u as E}from"./useTranslation-C7Yq1257.js";import{F as x}from"./Form-vqhQI7d8.js";import{R as P}from"./Row-Cp0Qg_e-.js";import{C as v}from"./Col-D0392pNZ.js";import{B as p}from"./Button-DzpAM0nN.js";import"./react-toastify.esm-CMP2010h.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./ThemeProvider-CK0LS3qr.js";import"./index-hS6bo2zO.js";import"./Button-BmeryA7r.js";function $(){const{t:e}=E(),t=D().props.token,u=(t==null?void 0:t.id)||null,m=(t==null?void 0:t.token_plain_text)||null,y=(t==null?void 0:t.created_at)||null,k=(t==null?void 0:t.last_used_at)||null,[d,w]=f.useState(!1),[l,j]=f.useState(!1),b=()=>{h.reload({replace:!0,only:["token"]})};f.useEffect(()=>{const r=setTimeout(()=>{b()},0);return()=>clearTimeout(r)},[]);const N=()=>{w(!d)},g=async()=>{if(!m){n(e("No token available to copy"),"error");return}if(!l){j(!0);try{await A(m)?n(e("Token copied"),"success"):n(e("Failed to copy token. Please try copy manually"),"error")}finally{setTimeout(()=>{j(!1)},1e3)}}},S=()=>{if(u){n(e("You already have a token. Please reload page to see your token"),"error");return}h.post(route("seller.profile.create-token"),{},{onSuccess:r=>{var o,a,i,c;if((a=(o=r.props)==null?void 0:o.message)!=null&&a.error){n(e(r.props.message.error),"error");return}(c=(i=r.props)==null?void 0:i.message)!=null&&c.success&&(n(e(r.props.message.success),"success"),b())},onError:r=>{Object.keys(r).forEach(o=>{n(r[o],"error")})}})},Y=async()=>{if(!u){n(e("No token available to delete"),"error");return}await I({title:e("Delete this token?"),text:e("Once deleted, you will not be able to recover it."),confirmButtonText:e("Delete now"),cancelButtonText:e("Cancel")})&&h.delete(route("seller.profile.delete-token",u),{onSuccess:o=>{var a,i,c,T;if((i=(a=o.props)==null?void 0:a.message)!=null&&i.error){n(e(o.props.message.error),"error");return}(T=(c=o.props)==null?void 0:c.message)!=null&&T.success&&n(e(o.props.message.success),"success")},onError:o=>{Object.keys(o).forEach(a=>{n(o[a],"error")})}})};return s.jsx(x,{noValidate:!0,children:s.jsx(P,{children:s.jsx(v,{lg:8,children:s.jsx("div",{className:"mb-3",children:m?s.jsxs(x.Group,{controlId:"api_token",children:[s.jsx("h5",{children:e("API Token")}),s.jsx(v,{lg:12,className:"mb-3",children:s.jsx("div",{className:"mb-3 text-muted",children:s.jsx("small",{children:e("Use this token to authenticate API requests. Keep it secure and don't share it with others.")})})}),s.jsx("small",{className:"d-block mb-2",children:s.jsxs("div",{children:[e("Created date"),":  ",y?C(y).format("DD/MM/YYYY HH:mm"):e("Unknown")]})}),s.jsx("small",{className:"d-block mb-3",children:s.jsxs("div",{children:[e("Last use"),": ",k?C(k).format("DD/MM/YYYY HH:mm"):e("Unknown")]})}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs("div",{className:"position-relative flex-grow-1",children:[s.jsx(x.Control,{type:d?"text":"password",className:"form-control pe-5",value:m,readOnly:!0,style:{fontFamily:"monospace"}}),s.jsx(p,{variant:"link",className:"position-absolute top-50 end-0 translate-middle-y border-0 bg-transparent text-muted pe-3",onClick:N,style:{zIndex:10,padding:"0.375rem 0.5rem"},title:e(d?"Hide token":"Show token"),children:s.jsx("i",{className:d?"ri-eye-off-line":"ri-eye-line"})})]}),s.jsxs(p,{type:"button",variant:l?"outline-success":"outline-primary",onClick:g,disabled:l,style:{whiteSpace:"nowrap"},children:[s.jsx("i",{className:`${l?"ri-check-line":"ri-file-copy-line"} me-1`}),e(l?"Copied":"Copy")]}),s.jsxs(p,{type:"button",variant:"outline-danger",onClick:Y,style:{whiteSpace:"nowrap"},children:[s.jsx("i",{className:"ri-delete-bin-line me-1"}),e("Delete")]})]})]}):s.jsxs("div",{children:[s.jsx("p",{className:"text-muted mb-3",children:e("You don't have an API Token yet.")}),s.jsxs(p,{type:"button",variant:"primary",onClick:S,children:[s.jsx("i",{className:"ri-add-line me-1"}),e("Create API Token")]})]})})})})})}export{$ as default};
