import{X as W,f as X,d as n,j as e,R as $,S as J,e as I}from"./ContextMenuProvider-1cB75p-p.js";import K from"./index-f0Pu7wvR.js";import Q from"./PageHeader-Bz4ZpFYB.js";import{u as U}from"./Navbar-BG96mfRZ.js";import Y from"./OrdersTable-BpwioGSb.js";import{c as Z}from"./thunk-Be97AmUV.js";import{u as ee}from"./useTranslation-C7Yq1257.js";import{C as te}from"./Container-CTVmsFDx.js";import{R as O}from"./Row-Cp0Qg_e-.js";import{C as N}from"./Col-D0392pNZ.js";import{I as se}from"./InputGroup-Bj3orn0P.js";import{F as re}from"./Form-vqhQI7d8.js";import{B as p}from"./Button-DzpAM0nN.js";import{D as h}from"./Dropdown-DbfyrjbA.js";import{M as y}from"./Modal-CuFoBLIG.js";import{T as ae}from"./Table-DSWSwzg4.js";import{B as j}from"./Badge-C6AtQdOY.js";import"./react-toastify.esm-CMP2010h.js";/* empty css                      */import"./LightDark-htucfSEQ.js";import"./reselect-CiXCCDx7.js";import"./LayoutContext-D-LXs-0z.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./Footer-DUtnYrVO.js";import"./scrollspy-BWqsbm6T.js";import"./ThemeProvider-CK0LS3qr.js";import"./useEventCallback-DraKR6BF.js";import"./NavbarContext-2E9S59ud.js";import"./inherits-B2gPeQio.js";import"./index-hS6bo2zO.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-Dquhf1hE.js";import"./index.esm-AjD9Q23E.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-DfFFbtXD.js";import"./Collapse-DZoekSvS.js";import"./TransitionWrapper-ngY_ZkUi.js";import"./useMergedRefs-CMrknats.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./NavLink-BMcHD9ta.js";import"./Anchor-B2knYez4.js";import"./useEventCallback-BCgLfiDM.js";import"./Button-BmeryA7r.js";import"./SelectableContext-BEvhv38Q.js";import"./DataKey-DjdvojM5.js";import"./TabContext-DOosZvpO.js";import"./InputGroupContext-DjmFhsg1.js";import"./querySelectorAll-CqHIJ078.js";import"./SSRProvider-CvsQASJI.js";import"./useIsomorphicEffect-B4y2oaWF.js";import"./useWindow-CZaNFBD5.js";import"./hook-BU9VZj-J.js";import"./extends-CF3RwP-h.js";import"./useWillUnmount-DiSYdiwn.js";import"./AbstractModalHeader-B-hdN3Xj.js";import"./hasClass-H27NZzxf.js";import"./NoopTransition-BXOCVAi7.js";import"./CloseButton-DfZYovl8.js";import"./Fade-CJmjx7TG.js";import"./divWithClassName-B2UmvJl6.js";const ie=()=>{const{t:r}=ee(),l=U(),{user:ne,orders:u}=W().props,v=X(),[L,b]=n.useState([]),[S,z]=n.useState(""),[D,ce]=n.useState("all"),[d,m]=n.useState(1),[g,x]=n.useState(10),[k,C]=n.useState(0),[B,w]=n.useState(!1),[M,R]=n.useState(""),[E,P]=n.useState([]),[f,F]=n.useState(""),_=async()=>{var t,s,a;try{const o=await I.get("/order",{params:{page:d,per_page:g,search:S,category:D},headers:{"X-Requested-With":"XMLHttpRequest"}});if(o.data&&o.data.orders){const i=o.data.orders.rows.map(c=>({order_number:c.order_number,purchased_at:c.purchased_at?new Date(c.purchased_at).toLocaleString("vi-VN"):"",product_title:c.product_title,quantity:c.quantity,unit_price:c.unit_price,total_price:c.total_price,status:c.status,notes:c.notes}));b(i),C(((t=o.data.orders.pagination)==null?void 0:t.total)||0),m(((s=o.data.orders.pagination)==null?void 0:s.current_page)||1),x(((a=o.data.orders.pagination)==null?void 0:a.per_page)||10)}}catch(o){console.error("Error fetching orders:",o)}};n.useEffect(()=>{var t,s,a;if(u&&u.rows){const o=u.rows.map(i=>({order_number:i.order_number,purchased_at:i.purchased_at?new Date(i.purchased_at).toLocaleString("vi-VN"):"",product_title:i.product_title,quantity:i.quantity,unit_price:i.unit_price,total_price:i.total_price,status:i.status,notes:i.notes}));b(o),C(((t=u.pagination)==null?void 0:t.total)||0),m(((s=u.pagination)==null?void 0:s.current_page)||1),x(((a=u.pagination)==null?void 0:a.per_page)||10)}else b([]),C(0);l&&v(Z(l==null?void 0:l.theme))},[u,l,v]);const q=()=>{m(1),_()};n.useEffect(()=>{_()},[d,g,D]);const H=async t=>{w(!0),F(t);try{const s=await I.get(`/order/${t}`);if(s.data.success){const a=s.data.data||{};R(a.product_title||"");const o=Array.isArray(a.items)?a.items.map(i=>({product:i.key??"",value:i.data??""})):[];P(o)}}catch(s){console.error("Error fetching order details:",s),P([])}},T=t=>{window.open(`/order/${t}/download`,"_blank")},V=t=>t.toLocaleString("vi-VN"),A=t=>{switch(t){case"COMPLETED":return e.jsx(j,{bg:"success",children:r("Completed")});case"PENDING":return e.jsx(j,{bg:"warning",children:r("Pending")});case"PROCESSING":return e.jsx(j,{bg:"info",children:r("Processing")});case"CANCELLED":return e.jsx(j,{bg:"danger",children:r("Cancelled")});case"FAILED":return e.jsx(j,{bg:"danger",children:r("Failed")});default:return e.jsx(j,{bg:"secondary",children:t})}},G=()=>{const t=[],s=Math.ceil(k/g);t.push(e.jsx(p,{variant:d===1?"primary":"outline-secondary",size:"sm",onClick:()=>m(1),className:"me-1",children:"1"},1));for(let a=2;a<=Math.min(5,s);a++)t.push(e.jsx(p,{variant:d===a?"primary":"outline-secondary",size:"sm",onClick:()=>m(a),className:"me-1",children:a},a));return s>5&&(t.push(e.jsx("span",{className:"me-1",children:"..."},"ellipsis")),t.push(e.jsx(p,{variant:"outline-secondary",size:"sm",onClick:()=>m(s),children:s},s))),t};return e.jsxs($.Fragment,{children:[e.jsx(Q,{title:(l==null?void 0:l.pageHeaderText)??""}),e.jsx(J,{title:"Đơn hàng đã mua"}),e.jsxs(te,{fluid:!0,className:"custom-container",children:[e.jsxs(O,{className:"mb-4 mt-4 align-items-center",children:[e.jsx(N,{md:6,children:e.jsx("h4",{className:"mb-0",style:{fontSize:"30px",fontWeight:"bold",color:"black"},children:r("Purchased order")})}),e.jsx(N,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("div",{className:"rounded-3 overflow-hidden border me-2",style:{width:"250px"},children:e.jsx(se,{children:e.jsx(re.Control,{type:"text",placeholder:r("Enter order number"),value:S,onChange:t=>z(t.target.value)})})}),e.jsx(p,{variant:"primary",onClick:q,className:"rounded-3",children:r("Filter")})]})})]}),e.jsx(Y,{ordersData:L,handleViewOrder:H,handleDownloadOrder:T,formatCurrency:V,getStatusBadge:A,fetchOrdersData:_,t:r}),e.jsxs(O,{className:"mt-3",children:[e.jsx(N,{md:6,children:e.jsx("p",{className:"text-muted mb-0"})}),e.jsx(N,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-end align-items-center",children:[e.jsx(p,{variant:"outline-secondary",size:"sm",className:"me-1",disabled:d===1,onClick:()=>m(d-1),children:e.jsx("i",{className:"ri-arrow-left-line"})}),G(),e.jsx(p,{variant:"outline-secondary",size:"sm",className:"ms-1",disabled:d===Math.ceil(k/g),onClick:()=>m(d+1),children:e.jsx("i",{className:"ri-arrow-right-line"})}),e.jsxs(h,{className:"ms-3",children:[e.jsxs(h.Toggle,{variant:"outline-secondary",size:"sm",children:["Show ",g]}),e.jsxs(h.Menu,{children:[e.jsx(h.Item,{onClick:()=>x(10),children:"10"}),e.jsx(h.Item,{onClick:()=>x(25),children:"25"}),e.jsx(h.Item,{onClick:()=>x(50),children:"50"}),e.jsx(h.Item,{onClick:()=>x(100),children:"100"})]})]})]})})]})]}),e.jsxs(y,{show:B,onHide:()=>w(!1),size:"xl",centered:!0,children:[e.jsx(y.Header,{closeButton:!0,children:e.jsxs(y.Title,{children:[r("Order")," ",f&&`#${f}`]})}),e.jsxs(y.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{className:"fw-semibold",children:[f,".txt"]}),e.jsx("div",{children:e.jsxs(p,{variant:"primary",size:"sm",onClick:()=>T(f),disabled:!f,children:[e.jsx("i",{className:"ri-download-line"})," ",r("Download")]})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs(ae,{className:"table align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:280},children:r("Product")}),e.jsx("th",{children:r("Value")})]})}),e.jsx("tbody",{children:E.length>0?E.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-truncate",style:{maxWidth:280},title:t.product,children:M}),e.jsx("td",{className:"text-break",style:{wordBreak:"break-all"},children:t.value})]},s)):e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"text-center text-muted py-4",children:r("No data")})})})]})})]}),e.jsx(y.Footer,{children:e.jsx(p,{variant:"secondary",onClick:()=>w(!1),children:r("Close")})})]})]})},oe=ie;oe.layout=r=>e.jsx(K,{children:r});export{oe as default};
