import{d as i,j as e,R as E,D as ve}from"./ContextMenuProvider-CS5NKwgS.js";import{u as oe,g as ce,a as Ce,b as ue,c as me,T as de,f as B,r as ge}from"./index-BJfBJeOO.js";import{u as xe}from"./useTranslation-DnvQPSkm.js";import{R as v}from"./Row-otC0J6R6.js";import{C as he}from"./Card-CYV1cPMM.js";import{C as ee}from"./Col-B1uPAtVO.js";import{B as k}from"./Button-DZTXdnKE.js";import{S as pe}from"./react-select.esm-BDAzNT5j.js";import{u as je}from"./useQueryParam-CTIdJAs5.js";const Se=({column:n})=>{const t=n.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(fe,{type:"text",value:t??"",onChange:c=>n.setFilterValue(c),placeholder:"Search...",className:"w-36 border shadow rounded",list:n.id+"list"}),e.jsx("div",{className:"h-1"})]})},fe=({value:n,onChange:t,debounce:c=500,...u})=>{const[m,x]=i.useState(n);return i.useEffect(()=>{x(n)},[n]),i.useEffect(()=>{const h=setTimeout(()=>{t(m)},c);return()=>clearTimeout(h)},[c,m]),e.jsx("input",{...u,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:h=>x(h.target.value)})},Fe=({columns:n,data:t,isGlobalFilter:c,customPageSize:u,borderClass:m,tableClass:x,theadClass:h,trClass:L,thClass:Y,divClass:U,SearchPlaceholder:Q,onSubmit:W=C=>{C.preventDefault()},onRowContextMenu:p})=>{const{t:C}=xe(),[S,X]=i.useState([]),[R,D]=i.useState(""),$=(r,o,z,I)=>{const G=ge(r.getValue(o),z);return I({itemRank:G}),G.passed},T=oe({columns:n,data:t,filterFns:{fuzzy:$},state:{columnFilters:S,globalFilter:R},onColumnFiltersChange:X,onGlobalFilterChange:D,globalFilterFn:$,getCoreRowModel:me(),getFilteredRowModel:ue(),getPaginationRowModel:Ce(),getSortedRowModel:ce()}),{getHeaderGroups:f,getRowModel:F,getCanPreviousPage:w,getCanNextPage:V,getPageOptions:_,setPageIndex:b,nextPage:P,previousPage:d,setPageSize:y,getState:j}=T;i.useEffect(()=>{Number(u)&&y(Number(u))},[u,y]);const M=(r,o)=>{p&&p(r,o)};return e.jsxs(i.Fragment,{children:[c&&e.jsx(v,{className:"mb-3",children:e.jsx(he.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:W,children:e.jsx(v,{children:e.jsx(ee,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(fe,{value:R??"",onChange:r=>D(String(r)),placeholder:Q}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:U,children:e.jsxs(de,{hover:!0,className:x,bordered:m,children:[e.jsx("thead",{className:h,children:f().map(r=>e.jsx("tr",{className:L,children:r.headers.map(o=>e.jsx("th",{className:Y,onClick:o.column.getToggleSortingHandler(),children:o.isPlaceholder?null:e.jsxs(E.Fragment,{children:[B(o.column.columnDef.header,o.getContext()),{asc:" ",desc:" "}[o.column.getIsSorted()]??null,o.column.getCanFilter()?e.jsx("div",{children:e.jsx(Se,{column:o.column,table:T})}):null]})},o.id))},r.id))}),e.jsx("tbody",{children:F().rows.map(r=>e.jsx("tr",{onContextMenu:o=>M(o,r.original),style:{cursor:p?"context-menu":"default"},children:r.getVisibleCells().map(o=>e.jsx("td",{children:B(o.column.columnDef.cell,o.getContext())},o.id))},r.id))})]})}),e.jsxs(v,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[C("Showing"),e.jsx("span",{className:"fw-semibold ms-1",children:F().rows.length})," ",C("on")," ",e.jsx("span",{className:"fw-semibold",children:t.length})," ",C("results")]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:w()?"page-item":"page-item disabled",children:e.jsx(k,{className:"page-link",onClick:d,variant:"link",children:"<"})}),_().map((r,o)=>e.jsx(E.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx(k,{variant:"link",className:j().pagination.pageIndex===r?"page-link active":"page-link",onClick:()=>b(r),children:r+1})})},o)),e.jsx("li",{className:V()?"page-item":"page-item disabled",children:e.jsx(k,{variant:"link",className:"page-link",onClick:P,children:">"})})]})})]})]})},we=({column:n})=>{const t=n.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{type:"text",value:t??"",onChange:c=>n.setFilterValue(c),placeholder:"Search...",className:"w-36 border shadow rounded",list:n.id+"list"}),e.jsx("div",{className:"h-1"})]})},Ne=({value:n,onChange:t,debounce:c=500,...u})=>{const[m,x]=i.useState(n);return i.useEffect(()=>{x(n)},[n]),i.useEffect(()=>{const h=setTimeout(()=>{t(m)},c);return()=>clearTimeout(h)},[c,m]),e.jsx("input",{...u,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:h=>x(h.target.value)})},Pe=({columns:n,data:t,isGlobalFilter:c,customPageSize:u,borderClass:m,tableClass:x,theadClass:h,trClass:L,thClass:Y,divClass:U,SearchPlaceholder:Q,onSubmit:W=w=>{w.preventDefault()},onReloadTable:p,perPageEntries:C=[10,50,100,200],onRowContextMenu:S,divStyle:X,tableStyle:R,maxHeight:D="500px",keyPageParam:$="page",keyPerPageParam:T="perPage",showPaginationEllipsis:f=!1,maxVisiblePages:F=5})=>{const{t:w}=xe(),[V,_]=i.useState([]),[b,P]=i.useState(""),d=je(),y=(d==null?void 0:d[$])??"1",j=(d==null?void 0:d[T])??"10",[M,r]=i.useState({value:j,label:j}),[o,z]=E.useState({pageIndex:Number(y)-1,pageSize:Number(j)}),I=(s,l,g,N)=>{const O=ge(s.getValue(l),g);return N({itemRank:O}),O.passed},G=(s,l)=>{S&&S(s,l)},H=oe({columns:n,data:(t==null?void 0:t.data)??[],filterFns:{fuzzy:I},state:{columnFilters:V,globalFilter:b,pagination:o},onColumnFiltersChange:_,onGlobalFilterChange:P,globalFilterFn:I,getCoreRowModel:me(),getFilteredRowModel:ue(),manualPagination:!0,getSortedRowModel:ce(),rowCount:(t==null?void 0:t.total)??0,onPaginationChange:s=>{if(p){const l=H.getState().pagination,g=typeof s=="function"?s(l):s;p(g.pageIndex+1,g.pageSize)}z(s)}}),{getHeaderGroups:J,getRowModel:se,getCanPreviousPage:te,getCanNextPage:ne,getPageOptions:K,setPageIndex:le,nextPage:ae,previousPage:Z,setPageSize:q,getState:A}=H;i.useEffect(()=>{Number(u)&&q(Number(u))},[u,q]);const a=()=>{const s=K().length,l=A().pagination.pageIndex;if(!f||s<=F)return K();const g=[],N=Math.floor((F-3)/2);g.push(0);let O=Math.max(1,l-N),ie=Math.min(s-2,l+N);l<=N+1&&(ie=Math.min(s-2,F-2)),l>=s-N-2&&(O=Math.max(1,s-F+1)),O>1&&g.push("ellipsis-start");for(let re=O;re<=ie;re++)g.push(re);return ie<s-2&&g.push("ellipsis-end"),s>1&&g.push(s-1),g};return i.useEffect(()=>{const s=()=>{z(l=>{const g=Number(y)-1,N=Number(j);return l.pageIndex!==g||l.pageSize!==N?{pageIndex:g,pageSize:N}:l}),r({value:j,label:j})};return window.addEventListener("popstate",s),s(),()=>{window.removeEventListener("popstate",s)}},[]),i.useEffect(()=>{z(s=>{const l=Number(y)-1,g=Number(j);return s.pageIndex!==l||s.pageSize!==g?{pageIndex:l,pageSize:g}:s}),r({value:j,label:j})},[t]),e.jsxs(i.Fragment,{children:[c&&e.jsx(v,{className:"mb-3",children:e.jsx(he.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:W,children:e.jsx(v,{children:e.jsx(ee,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(Ne,{value:b??"",onChange:s=>P(String(s)),placeholder:Q}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:U,style:{...X,position:"relative",maxHeight:D,overflowY:"auto"},children:e.jsxs(de,{hover:!0,className:x,bordered:m,style:R,children:[e.jsx("thead",{className:`${h} sticky-top`,style:{zIndex:10},children:J().map(s=>e.jsx("tr",{className:L,children:s.headers.map(l=>e.jsx("th",{className:`${Y} ${l.column.getCanSort()?"sortable-header":""}`,style:{position:"sticky",top:0,zIndex:10,cursor:l.column.getCanSort()?"pointer":"default",userSelect:"none"},onClick:l.column.getToggleSortingHandler(),children:l.isPlaceholder?null:e.jsxs(E.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{children:B(l.column.columnDef.header,l.getContext())}),l.column.getCanSort()&&e.jsx("div",{className:"ms-1",children:l.column.getIsSorted()==="asc"?e.jsx("i",{className:"ri-arrow-up-s-line"}):l.column.getIsSorted()==="desc"?e.jsx("i",{className:"ri-arrow-down-s-line"}):e.jsx("i",{className:"ri-expand-up-down-line text-muted"})})]}),l.column.getCanFilter()?e.jsx("div",{children:e.jsx(we,{column:l.column,table:H})}):null]})},l.id))},s.id))}),e.jsx("tbody",{children:se().rows.map(s=>e.jsx("tr",{onContextMenu:l=>G(l,s.original),style:{cursor:S?"context-menu":"default"},children:s.getVisibleCells().map(l=>e.jsx("td",{children:B(l.column.columnDef.cell,l.getContext())},l.id))},s.id))})]})}),e.jsxs(v,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[w("Showing"),e.jsx("span",{className:"fw-semibold ms-1",children:se().rows.length})," ",w("on")," ",e.jsx("span",{className:"fw-semibold",children:(t==null?void 0:t.total)??0})," ",w("results")]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:te()?"page-item":"page-item disabled",children:e.jsx(k,{className:"page-link",onClick:Z,variant:"link",children:"<"})}),a().map((s,l)=>e.jsx(E.Fragment,{children:typeof s=="string"?e.jsx("li",{className:"page-item disabled",children:e.jsx("span",{className:"page-link",children:"..."})}):e.jsx("li",{className:"page-item",children:e.jsx(k,{variant:"link",className:A().pagination.pageIndex===s?"page-link active":"page-link",onClick:()=>le(s),children:s+1})})},l)),e.jsx("li",{className:ne()?"page-item":"page-item disabled",children:e.jsx(k,{variant:"link",className:"page-link",onClick:ae,children:">"})})]})}),e.jsx("div",{className:"col-lg-auto",children:e.jsx(pe,{value:M,onChange:s=>{p&&p(1,s.value),z(l=>({...l,pageSize:s.value})),r(s)},options:C.map(s=>({value:s,label:s})),id:"choices-single-default",className:"js-example-basic-single mb-0",name:"state",menuPlacement:"auto"})})]})]})},ke=({column:n})=>{const t=n.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(be,{type:"text",value:t??"",onChange:c=>n.setFilterValue(c),placeholder:"Search...",className:"w-36 border shadow rounded",list:n.id+"list"}),e.jsx("div",{className:"h-1"})]})},be=({value:n,onChange:t,debounce:c=500,...u})=>{const[m,x]=i.useState(n);return i.useEffect(()=>{x(n)},[n]),i.useEffect(()=>{const h=setTimeout(()=>{t(m)},c);return()=>clearTimeout(h)},[c,m]),e.jsx("input",{...u,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:h=>x(h.target.value)})},ye=({columns:n,data:t,isGlobalFilter:c,customPageSize:u,borderClass:m,tableClass:x,theadClass:h,trClass:L,thClass:Y,divClass:U,SearchPlaceholder:Q,onSubmit:W=f=>{f.preventDefault()},onReloadTable:p,perPageEntries:C=[10,50,100,200],onRowContextMenu:S,divStyle:X,tableStyle:R,maxHeight:D="500px",keyPageParam:$="page",keyPerPageParam:T="perPage"})=>{const{t:f}=xe(),[F,w]=i.useState([]),[V,_]=i.useState(""),b=je(),P=(b==null?void 0:b[$])??null,d=(b==null?void 0:b[T])??"10",[y,j]=i.useState({value:d,label:d}),[M,r]=E.useState({pageIndex:0,pageSize:Number(d)}),o=(a,s,l,g)=>{const N=ge(a.getValue(s),l);return g({itemRank:N}),N.passed},z=(a,s)=>{S&&S(a,s)},I=oe({columns:n,data:(t==null?void 0:t.data)??[],filterFns:{fuzzy:o},state:{columnFilters:F,globalFilter:V,pagination:M},onColumnFiltersChange:w,onGlobalFilterChange:_,globalFilterFn:o,getCoreRowModel:me(),getFilteredRowModel:ue(),manualPagination:!0,getSortedRowModel:ce(),rowCount:-1,onPaginationChange:r}),{getHeaderGroups:G,getRowModel:H,setPageSize:J,getState:se}=I;i.useEffect(()=>{Number(u)&&J(Number(u))},[u,J]);const te=()=>{p&&(t==null?void 0:t.prev_cursor)!==null&&p(t.prev_cursor,M.pageSize,"prev")},ne=()=>{p&&(t!=null&&t.next_cursor)&&p(t.next_cursor,M.pageSize,"next")},K=()=>{p&&p(null,M.pageSize)},le=a=>{p&&p(null,a.value),r(s=>({...s,pageSize:a.value})),j(a)};i.useEffect(()=>{const a=()=>{r(s=>{const l=Number(d);return s.pageSize!==l?{...s,pageSize:l}:s}),j({value:d,label:d})};return window.addEventListener("popstate",a),a(),()=>{window.removeEventListener("popstate",a)}},[d,P]),i.useEffect(()=>{r(a=>{const s=Number(d);return a.pageSize!==s?{...a,pageSize:s}:a}),j({value:d,label:d})},[t,d,P]);const ae=(t==null?void 0:t.data)&&t.data.length>0,Z=(t==null?void 0:t.prev_cursor)!==null,q=(t==null?void 0:t.next_cursor)!==null,A=!P||P===null;return e.jsxs(i.Fragment,{children:[c&&e.jsx(v,{className:"mb-3",children:e.jsx(he.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:W,children:e.jsx(v,{children:e.jsx(ee,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(be,{value:V??"",onChange:a=>_(String(a)),placeholder:Q}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:U,style:{...X,position:"relative",maxHeight:D,overflowY:"auto"},children:e.jsxs(de,{hover:!0,className:x,bordered:m,style:R,children:[e.jsx("thead",{className:`${h} sticky-top`,style:{zIndex:10},children:G().map(a=>e.jsx("tr",{className:L,children:a.headers.map(s=>e.jsx("th",{className:`${Y} ${s.column.getCanSort()?"sortable-header":""}`,style:{position:"sticky",top:0,zIndex:10,cursor:s.column.getCanSort()?"pointer":"default",userSelect:"none"},onClick:s.column.getToggleSortingHandler(),children:s.isPlaceholder?null:e.jsxs(E.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{children:B(s.column.columnDef.header,s.getContext())}),s.column.getCanSort()&&e.jsx("div",{className:"ms-1",children:s.column.getIsSorted()==="asc"?e.jsx("i",{className:"ri-arrow-up-s-line"}):s.column.getIsSorted()==="desc"?e.jsx("i",{className:"ri-arrow-down-s-line"}):e.jsx("i",{className:"ri-expand-up-down-line text-muted"})})]}),s.column.getCanFilter()?e.jsx("div",{children:e.jsx(ke,{column:s.column,table:I})}):null]})},s.id))},a.id))}),e.jsx("tbody",{children:H().rows.map(a=>e.jsx("tr",{onContextMenu:s=>z(s,a.original),style:{cursor:S?"context-menu":"default"},children:a.getVisibleCells().map(s=>e.jsx("td",{children:B(s.column.columnDef.cell,s.getContext())},s.id))},a.id))})]})}),e.jsxs(v,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[f("Showing")," ",e.jsx("span",{className:"fw-semibold",children:H().rows.length})," ",f("results"),(t==null?void 0:t.per_page)&&e.jsxs("span",{children:[" (",t.per_page," ",f("per page"),")"]})]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:A?"page-item disabled":"page-item",children:e.jsx(k,{className:"page-link",onClick:K,variant:"link",disabled:A,title:f("Go to first page"),children:"<<"})}),e.jsx("li",{className:Z?"page-item":"page-item disabled",children:e.jsx(k,{className:"page-link",onClick:te,variant:"link",disabled:!Z,title:f("Previous page"),children:"<"})}),e.jsx("li",{className:q?"page-item":"page-item disabled",children:e.jsx(k,{variant:"link",className:"page-link",onClick:ne,disabled:!q,title:f("Next page"),children:">"})})]})}),e.jsx("div",{className:"col-lg-auto",children:e.jsx(pe,{value:y,onChange:le,options:C.map(a=>({value:a,label:a})),id:"choices-single-default",className:"js-example-basic-single mb-0",name:"state",menuPlacement:"auto"})})]}),!ae&&e.jsx(v,{className:"mt-3",children:e.jsx(ee,{className:"text-center",children:e.jsx("div",{className:"text-muted",children:f("No data available")})})})]})},_e=n=>{const t=ve(),c=(u,m)=>{if(n.enableContextMenu&&n.contextMenuOptions&&t){u.preventDefault(),u.stopPropagation();const x=typeof n.contextMenuOptions=="function"?n.contextMenuOptions(m):n.contextMenuOptions;x&&x.length>0&&t.showContextMenu(x,m,{x:u.clientX,y:u.clientY},n.contextMenuConfig)}};return n!=null&&n.isPaginateTable?n!=null&&n.isCursorPaginateTable?e.jsx(ye,{...n,onRowContextMenu:c}):e.jsx(Pe,{...n,onRowContextMenu:c}):e.jsx(Fe,{...n,onRowContextMenu:c})};export{_e as T};
