import{X as Y,d as b,A as C,j as s}from"./ContextMenuProvider-Bgjy8Wg_.js";import{c as d,a as x,u as U}from"./index.esm-DoMfYbyN.js";import{s as i}from"./showToast-c2o8r-j8.js";import{u as X}from"./useTranslation-i33--018.js";import{M as k}from"./Modal-BxKnUp3s.js";import{F as u}from"./Form-BeSunazq.js";import{B as j}from"./Button-RncLFi2F.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-jrBPyUKT.js";import"./react-toastify.esm-Cf9Hh3Hc.js";import"./ThemeProvider-CYM_k5Zw.js";import"./useMergedRefs-C7mYgcnr.js";import"./useEventCallback-C77JoxQK.js";import"./useWillUnmount-CV1jA_-9.js";import"./TransitionWrapper-Bjg9a9AV.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./AbstractModalHeader-DOXfy78k.js";import"./useWindow-BPNIkHCm.js";import"./querySelectorAll-CzRPGPCl.js";import"./useEventCallback-ChoFq1nf.js";import"./hasClass-5e7f26Ba.js";import"./NoopTransition-Df2OePA0.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-PA9gi4Rc.js";import"./index-BIk4TdC1.js";import"./Fade-DpConxg0.js";import"./divWithClassName-N3RGU5tF.js";import"./Col-Dir6tpbB.js";import"./Button-m8XipgEK.js";const Se=({show:N,onHide:S,dataEdit:l,dataOptions:c})=>{var L,F,I,T,A,V,q,G;const{t:r}=X(),n=Y().props.errors,[M,_]=b.useState(!1),[R,f]=b.useState(!1),[B,w]=b.useState(!1),[W,v]=b.useState(!1),[$,P]=b.useState(!1),D=b.useMemo(()=>d({type:x().required(r("Please select a type")),key:x().required(r("Please select a bank")),account_name:x().max(150,"Must be 150 characters or less").required(r("Please enter this field")),account_number:x().required(r("Please enter this field")),user_name:x().when("type",{is:o=>{var a;return((a=c==null?void 0:c.listTypeOptions)==null?void 0:a[o])==="BANK"},then:o=>o.required(r("Please enter this field")),otherwise:o=>o.notRequired()}),password:x().when("type",{is:o=>{var a;return((a=c==null?void 0:c.listTypeOptions)==null?void 0:a[o])==="BANK"},then:o=>o.required(r("Please enter this field")),otherwise:o=>o.notRequired()}),...B?{otp:x().required(r("Please enter this field"))}:{},api_key:x().when("type",{is:o=>{var a;return((a=c==null?void 0:c.listTypeOptions)==null?void 0:a[o])==="SEPAY"},then:o=>o.required(r("Please enter this field")),otherwise:o=>o.notRequired()})}),[B,r,c]),e=U({initialValues:{type:(l==null?void 0:l.type)||"BANK",key:(l==null?void 0:l.key)||"",account_name:((L=l==null?void 0:l.details)==null?void 0:L.account_name)||"",account_number:((F=l==null?void 0:l.details)==null?void 0:F.account_number)??"",user_name:((I=l==null?void 0:l.details)==null?void 0:I.user_name)??"",password:((T=l==null?void 0:l.details)==null?void 0:T.password)??"",otp:"",api_key:((A=l==null?void 0:l.details)==null?void 0:A.api_key)??""},validationSchema:D,onSubmit:o=>{const a=route("seller.payment-method.store");C["post"](a,o,{onSuccess:t=>{var h,p,y,g;if((p=(h=t.props)==null?void 0:h.message)!=null&&p.error){i(r(t.props.message.error),"error");return}e.resetForm(),S(),(g=(y=t.props)==null?void 0:y.message)!=null&&g.success&&i(r(t.props.message.success),"success")}})}});return b.useEffect(()=>{var o,a,m,t,h;N?(e.setValues({type:l!=null&&l.type?String(l==null?void 0:l.type):"0",key:(l==null?void 0:l.key)||"",account_name:((o=l==null?void 0:l.details)==null?void 0:o.account_name)||"",account_number:((a=l==null?void 0:l.details)==null?void 0:a.account_number)??"",user_name:((m=l==null?void 0:l.details)==null?void 0:m.user_name)??"",password:((t=l==null?void 0:l.details)==null?void 0:t.password)??"",otp:"",api_key:((h=l==null?void 0:l.details)==null?void 0:h.api_key)??""}),w(!1),v(!1),_(!1),f(!1),P(!1)):e.resetForm()},[N,l]),s.jsx(k,{id:"myModal",backdrop:"static",show:N,onHide:()=>{e.resetForm(),S()},centered:!0,children:s.jsxs(u,{onSubmit:e.handleSubmit,noValidate:!0,children:[s.jsx(k.Header,{closeButton:!0,children:s.jsx("h5",{children:r("Setting Payment")})}),s.jsxs(k.Body,{children:[s.jsxs(u.Group,{className:"mb-3",controlId:"name",children:[s.jsxs(u.Label,{children:[r("Type")," ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(u.Select,{name:"type",onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.type,isInvalid:!!(e.touched.type&&e.errors.type||n!=null&&n.type),children:[s.jsx("option",{value:"",children:r("Select type")}),(c==null?void 0:c.listTypeOptions)&&Object.keys(c.listTypeOptions).map(o=>s.jsx("option",{value:o,selected:e.values.type===o,children:r(c.listTypeOptions[o])},o))]}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.type||(n==null?void 0:n.type))})]}),s.jsxs(u.Group,{className:"mb-3",controlId:"key",children:[s.jsxs(u.Label,{children:[r("Bank")," ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(u.Select,{name:"key",onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.key,isInvalid:!!(e.touched.key&&e.errors.key||n!=null&&n.key),children:[s.jsx("option",{value:"",children:r("Select bank")}),((V=c==null?void 0:c.listTypeOptions)==null?void 0:V[e.values.type])==="BANK"?(c==null?void 0:c.listBank)&&Object.keys(c.listBank).map(o=>s.jsx("option",{value:o,selected:e.values.key===o,children:r(c.listBank[o])},o)):(c==null?void 0:c.listBankSePay)&&Object.keys(c.listBankSePay).map(o=>s.jsx("option",{value:c.listBankSePay[o].code,selected:e.values.key===c.listBankSePay[o].code,children:r(c.listBankSePay[o].short_name)},o))]}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.key||(n==null?void 0:n.key))})]}),s.jsxs(u.Group,{className:"mb-3",controlId:"categoryName",children:[s.jsxs(u.Label,{children:[r("Account name"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{name:"account_name",type:"text",placeholder:r("Enter account name"),maxLength:150,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.account_name,isInvalid:!!(e.touched.account_name&&e.errors.account_name||n!=null&&n.account_name)}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.account_name||(n==null?void 0:n.account_name))})]}),s.jsxs(u.Group,{className:"mb-3",controlId:"categoryName",children:[s.jsxs(u.Label,{children:[r("Account number"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{name:"account_number",type:"text",placeholder:r("Enter account number"),maxLength:150,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.account_number,isInvalid:!!(e.touched.account_number&&e.errors.account_number||n!=null&&n.account_number)}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.account_number||(n==null?void 0:n.account_number))})]}),((q=c==null?void 0:c.listTypeOptions)==null?void 0:q[e.values.type])==="BANK"&&s.jsxs(s.Fragment,{children:[s.jsxs(u.Group,{className:"mb-3",controlId:"categoryName",children:[s.jsxs(u.Label,{children:[r("User name"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{name:"user_name",type:"text",placeholder:r("0974 xxx xxx"),maxLength:150,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.user_name,isInvalid:!!(e.touched.user_name&&e.errors.user_name||n!=null&&n.user_name)}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.user_name||(n==null?void 0:n.user_name))})]}),s.jsxs(u.Group,{className:"mb-3",controlId:"categoryName",children:[s.jsxs(u.Label,{children:[r("Password"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{name:"password",type:"text",placeholder:r("Enter password"),maxLength:150,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.password,isInvalid:!!(e.touched.password&&e.errors.password||n!=null&&n.password)}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.password||(n==null?void 0:n.password))})]}),s.jsx(j,{variant:"success",type:"button",className:"mb-3",disabled:M,onClick:async o=>{o.preventDefault(),o.stopPropagation(),_(!0),e.setTouched({key:!0,account_name:!0,account_number:!0,user_name:!0,password:!0,otp:e.touched.otp||!1});const a=await e.validateForm();if(a.key||a.account_name||a.account_number||a.user_name||a.password){i(r("Please enter this field"),"error"),_(!1);return}C.post(route("seller.payment-method.verify-payment"),{key:e.values.key,account_name:e.values.account_name,account_number:e.values.account_number,user_name:e.values.user_name,password:e.values.password,otp:e.values.otp??null},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:m=>{var t,h,p,y,g,K;if((h=(t=m.props)==null?void 0:t.message)!=null&&h.error){i(r(m.props.message.error),"error"),v(!1),_(!1);return}if((y=(p=m.props)==null?void 0:p.message)!=null&&y.info){i(r(m.props.message.info),"success"),w(!0),v(!0),_(!1);return}i(r(((K=(g=m.props)==null?void 0:g.message)==null?void 0:K.success)||"Verified successfully"),"success"),v(!0),_(!1)},onError:()=>{i(r("Verification failed"),"error"),_(!1)},onFinish:()=>{}})},children:r("Verify Payment")}),B&&s.jsxs(u.Group,{className:"mb-3",children:[s.jsxs(u.Label,{children:[r("OTP"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{name:"otp",type:"text",placeholder:r("Enter OTP"),maxLength:150,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.otp,isInvalid:!!(e.touched.otp&&e.errors.otp||n!=null&&n.otp)}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.otp||(n==null?void 0:n.otp))})]})]}),((G=c==null?void 0:c.listTypeOptions)==null?void 0:G[e.values.type])==="SEPAY"&&s.jsxs(s.Fragment,{children:[s.jsxs(u.Group,{className:"mb-3",children:[s.jsxs(u.Label,{children:[r("Api Key"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{name:"api_key",type:"text",placeholder:r("Enter API key"),maxLength:150,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.api_key,isInvalid:!!(e.touched.api_key&&e.errors.api_key||n!=null&&n.api_key)}),s.jsx(u.Control.Feedback,{type:"invalid",children:r(e.errors.api_key||(n==null?void 0:n.api_key))})]}),s.jsx(j,{variant:"success",type:"button",className:"mb-3",disabled:R,onClick:async o=>{o.preventDefault(),o.stopPropagation(),f(!0),e.setTouched({key:!0,account_name:!0,account_number:!0,user_name:!1,password:!1,otp:e.touched.otp||!1,api_key:!0});const a=await e.validateForm();if(a.key||a.account_name||a.account_number||a.api_key){i(r("Please enter this field"),"error"),f(!1);return}C.post(route("seller.payment-method.verify-sepay"),{key:e.values.key,account_name:e.values.account_name,account_number:e.values.account_number,api_key:e.values.api_key},{preserveScroll:!0,preserveState:!0,only:[],onSuccess:m=>{var t,h,p,y;if((h=(t=m.props)==null?void 0:t.message)!=null&&h.error){i(r(m.props.message.error),"error"),v(!1),f(!1);return}i(r(((y=(p=m.props)==null?void 0:p.message)==null?void 0:y.success)||"Verified successfully"),"success"),P(!0),v(!0),f(!1)},onError:()=>{i(r("Verification failed"),"error"),f(!1)},onFinish:()=>{}})},children:r("Verify Payment")}),$&&s.jsxs(u.Group,{className:"mb-3",children:[s.jsxs(u.Label,{children:[r("Link Webhook"),s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(u.Control,{value:c==null?void 0:c.linkWebhook,readOnly:!0})]})]})]}),s.jsxs(k.Footer,{children:[s.jsx(j,{variant:"light",onClick:()=>{e.resetForm(),S()},children:r("Close")}),s.jsx(j,{variant:"primary",type:"submit",disabled:!W,children:r("Save changes")})]})]})})};export{Se as ModalSettingPayment};
