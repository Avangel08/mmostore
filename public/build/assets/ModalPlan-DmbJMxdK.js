import{X as Se,A as ae,d as V,j as r}from"./ContextMenuProvider-CUf15T8b.js";import{u as Ne}from"./formik.esm-D3LnCktS.js";import{S as te}from"./react-select.esm-CjmYAKcX.js";import{N as m}from"./react-number-format.es-Dyh-utTC.js";import{c as Fe,a as x,e as me,f as v}from"./index.esm-Dr9W4QE-.js";import{s as w}from"./showToast-BZsJ5i2w.js";import{C as Ie}from"./CustomCKEditor-VXwZlvvv.js";import{u as Ve}from"./useTranslation-CcWHtvoZ.js";import{M as y}from"./Modal-Cq5Iof0F.js";import{F as o}from"./Form-tX-X8fEq.js";import{R as p}from"./Row-Cl0apHvl.js";import{C as u}from"./Col-6EOqiNtv.js";import{B as xe}from"./Button-D8tMtwFd.js";import"./toString-DZQbVhdU.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-BQLgnwv_.js";import"./inherits-0xqp8bJF.js";import"./setPrototypeOf-B4fUID9J.js";import"./extends-CF3RwP-h.js";import"./react-toastify.esm-ZGmoa_RU.js";import"./throttle-CzOjd-at.js";import"./ThemeProvider-B97jU0sy.js";import"./useMergedRefs-DxqJFB1B.js";import"./useEventCallback-D9rniTUJ.js";import"./useWillUnmount-CgiG1D_7.js";import"./TransitionWrapper-BiovwvO2.js";import"./AbstractModalHeader-BnVnJchn.js";import"./useWindow-BmGtZXAu.js";import"./querySelectorAll-a65Eisif.js";import"./useEventCallback-BkinHRQ0.js";import"./hasClass-B-lVPIr_.js";import"./NoopTransition-CYuCxw2t.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-CjwmBX8Z.js";import"./index-DKnNWrZg.js";import"./Fade-PIrusN3V.js";import"./divWithClassName-F6D8z14O.js";import"./Button-NCU6JKbY.js";const ps=({show:C,onHide:S,dataEdit:s})=>{var D,P,M,f,q,_,L,G,T,$,A,O,R,z,K,U,X,H,J,Q,W,Y,Z,k,d,E,ee,se,re,le,ne,oe,ce,ue;const{t:l}=Ve(),t=!!s,{errors:B,statusConst:ve,typeConst:be}=Se().props,a=999999999,N=100,F=999999999,I=999999999,b=Object.entries(be||{}).map(([n,c])=>{var h;return{value:(h=n??"")==null?void 0:h.toString(),label:c}}),j=Object.entries(ve||{}).map(([n,c])=>{var h;return{value:(h=n??"")==null?void 0:h.toString(),label:l(c??"")}}),e=Ne({initialValues:{planName:(s==null?void 0:s.name)??"",type:((D=s==null?void 0:s.type)==null?void 0:D.toString())??"1",price:(s==null?void 0:s.price)??"",priceOrigin:(s==null?void 0:s.price_origin)??"",sale:(s==null?void 0:s.off)??"",intervalDay:(s==null?void 0:s.interval)??"",intervalMonth:(s==null?void 0:s.interval_type)??"",status:((P=s==null?void 0:s.type)==null?void 0:P.toString())==="0"?"1":((M=s==null?void 0:s.status)==null?void 0:M.toString())??"1",bestChoice:(s==null?void 0:s.best_choice)===1||(s==null?void 0:s.best_choice)==="1",showPublic:(s==null?void 0:s.show_public)===1||(s==null?void 0:s.show_public)==="1",shortDescription:(s==null?void 0:s.sub_description)??"",description:(s==null?void 0:s.description)??""},validationSchema:Fe({planName:x().max(255,l("Must be 255 characters or less")).required(l("Please enter plan name")),type:x().required(l("Please select type")),price:v().min(0,l("Price must be greater than or equal to 0")).max(a,`Price must be less than ${a}`).required(l("Please enter price")),priceOrigin:v().min(0,l("Fixed price must be greater than or equal to 0")).max(a,`Fixed price must be less than ${a}`).required(l("Please enter fixed price")),sale:v().min(0,l("Sale must be greater than or equal to 0")).max(N,`Sale must be less than or equal to ${N}`),intervalDay:v().min(0,l("Interval day must be greater than or equal to 0")).max(F,`Interval day must be less than ${F}`).required(l("Please enter interval days")),intervalMonth:v().min(0,l("Interval month must be greater than or equal to 0")).max(I,`Interval month must be less than or equal to ${I}`).required(l("Please enter interval months")),status:x().required(l("Please select status")),bestChoice:me(),showPublic:me(),shortDescription:x().max(500,l("Must be 500 characters or less")),description:x()}),onSubmit:async n=>{const c=t?route("admin.plans.update",{id:s.id}):route("admin.plans.store");ae[t?"put":"post"](c,n,{replace:!0,preserveScroll:!0,preserveState:!0,onSuccess:i=>{var g,he,ie,pe;if((he=(g=i.props)==null?void 0:g.message)!=null&&he.error){w(l(i.props.message.error),"error");return}e.resetForm(),S(),(pe=(ie=i.props)==null?void 0:ie.message)!=null&&pe.success&&w(l(i.props.message.success),"success")},onError:i=>{Object.keys(i).forEach(g=>{w(l(i[g]),"error")})}})}}),je=e.values.type==="0",ge=t&&((f=s==null?void 0:s.type)==null?void 0:f.toString())==="0";V.useEffect(()=>{e.values.type==="0"&&e.setFieldValue("status","1")},[e.values.type]),V.useEffect(()=>{e.setErrors(B||{})},[B]),V.useEffect(()=>{var n,c,h;C?(e.setValues({planName:(s==null?void 0:s.name)??"",type:((n=s==null?void 0:s.type)==null?void 0:n.toString())??"1",price:(s==null?void 0:s.price)??"",priceOrigin:(s==null?void 0:s.price_origin)??"",sale:(s==null?void 0:s.off)??"",intervalDay:(s==null?void 0:s.interval)??"",intervalMonth:(s==null?void 0:s.interval_type)??"",status:((c=s==null?void 0:s.type)==null?void 0:c.toString())==="0"?"1":((h=s==null?void 0:s.status)==null?void 0:h.toString())??"1",bestChoice:(s==null?void 0:s.best_choice)===1||(s==null?void 0:s.best_choice)==="1",showPublic:(s==null?void 0:s.show_public)===1||(s==null?void 0:s.show_public)==="1",shortDescription:(s==null?void 0:s.sub_description)??"",description:(s==null?void 0:s.description)??""}),e.setTouched({}),e.setErrors({})):e.resetForm()},[C,s]);const ye=(b==null?void 0:b.find(n=>(n==null?void 0:n.value)===e.values.type))??null,Ce=(j==null?void 0:j.find(n=>(n==null?void 0:n.value)===e.values.status))??null;return r.jsxs(y,{id:"myModal",backdrop:"static",show:C,onHide:()=>{e.resetForm(),S()},centered:!0,size:"xl",scrollable:!0,children:[r.jsx(y.Header,{closeButton:!0,children:r.jsx("h5",{children:l(t?"Edit plan":"Add plan")})}),r.jsx(y.Body,{className:"p-4",children:r.jsxs(o,{onSubmit:e.handleSubmit,noValidate:!0,children:[r.jsxs(p,{className:"mb-4",children:[r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"planName",children:[r.jsxs(o.Label,{children:[l("Plan name"),r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(o.Control,{type:"text",placeholder:l("Enter plan name"),name:"planName",maxLength:255,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.planName,isInvalid:!!((q=e==null?void 0:e.touched)!=null&&q.planName&&((_=e==null?void 0:e.errors)!=null&&_.planName))}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(((L=e==null?void 0:e.errors)==null?void 0:L.planName)??"")})]})}),r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"type",children:[r.jsxs(o.Label,{children:[l("Type"),r.jsx("span",{className:"text-danger",children:"*"})]}),ge?r.jsx(o.Control,{type:"text",value:l("Default"),disabled:!0,className:"form-control"}):r.jsx(te,{options:b,placeholder:l("Select type"),value:ye,onMenuOpen:()=>{ae.reload({only:["typeConst"],replace:!0})},onChange:n=>{e.setFieldValue("type",(n==null?void 0:n.value)??"")},onBlur:()=>e.setFieldTouched("type",!0),className:(G=e==null?void 0:e.touched)!=null&&G.type&&((T=e==null?void 0:e.errors)!=null&&T.type)?"is-invalid":""}),(($=e==null?void 0:e.touched)==null?void 0:$.type)&&((A=e==null?void 0:e.errors)==null?void 0:A.type)&&r.jsx("div",{className:"invalid-feedback d-block",children:l(((O=e==null?void 0:e.errors)==null?void 0:O.type)??"")})]})})]}),r.jsxs(p,{className:"mb-4",children:[r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"price",children:[r.jsxs(o.Label,{children:[l("Price"),r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(m,{customInput:o.Control,thousandSeparator:".",decimalSeparator:",",placeholder:l("Enter price (after the promotion)"),decimalScale:2,fixedDecimalScale:!1,allowNegative:!1,isAllowed:n=>{const{floatValue:c}=n;return c===void 0||c<=a},onValueChange:n=>{e.setFieldValue("price",n.floatValue!==void 0?n.floatValue:"")},onBlur:e.handleBlur,value:e.values.price,isInvalid:!!(e.touched.price&&e.errors.price)}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(((R=e==null?void 0:e.errors)==null?void 0:R.price)??"")})]})}),r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"priceOrigin",children:[r.jsxs(o.Label,{children:[l("Fixed price"),r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(m,{customInput:o.Control,thousandSeparator:".",decimalSeparator:",",placeholder:l("Enter fixed price (before the promotion)"),decimalScale:2,fixedDecimalScale:!1,allowNegative:!1,isAllowed:n=>{const{floatValue:c}=n;return c===void 0||c<=a},onValueChange:n=>{e.setFieldValue("priceOrigin",n.floatValue!==void 0?n.floatValue:"")},onBlur:e.handleBlur,value:e.values.priceOrigin,isInvalid:!!((z=e==null?void 0:e.touched)!=null&&z.priceOrigin&&((K=e==null?void 0:e.errors)!=null&&K.priceOrigin))}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(((U=e==null?void 0:e.errors)==null?void 0:U.priceOrigin)??"")})]})})]}),r.jsx(p,{className:"mb-4",children:r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"sale",children:[r.jsx(o.Label,{children:l("Sale %")}),r.jsx(m,{customInput:o.Control,placeholder:l("Enter % sale"),decimalScale:0,fixedDecimalScale:!1,allowNegative:!1,isAllowed:n=>{const{floatValue:c}=n;return c===void 0||c>=0&&c<=N},onValueChange:n=>{e.setFieldValue("sale",n.floatValue??"")},onBlur:e.handleBlur,value:e.values.sale,isInvalid:!!((X=e==null?void 0:e.touched)!=null&&X.sale&&((H=e==null?void 0:e.errors)!=null&&H.sale))}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(((J=e==null?void 0:e.errors)==null?void 0:J.sale)??"")})]})})}),r.jsxs(p,{className:"mb-4",children:[r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"intervalDay",children:[r.jsxs(o.Label,{children:[l("Plan time (day)"),r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(m,{customInput:o.Control,placeholder:l("Enter interval days"),allowNegative:!1,decimalScale:0,isAllowed:n=>{const{floatValue:c}=n;return c===void 0||c>=0&&c<=F},onValueChange:n=>{e.setFieldValue("intervalDay",n.floatValue??"")},onBlur:e.handleBlur,value:e.values.intervalDay,isInvalid:!!((Q=e==null?void 0:e.touched)!=null&&Q.intervalDay&&((W=e==null?void 0:e.errors)!=null&&W.intervalDay))}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(e.errors.intervalDay??"")})]})}),r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"intervalMonth",children:[r.jsxs(o.Label,{children:[l("Plan time (month)"),r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(m,{customInput:o.Control,placeholder:l("Enter interval months"),allowNegative:!1,decimalScale:0,isAllowed:n=>{const{floatValue:c}=n;return c===void 0||c>=0&&c<=I},onValueChange:n=>{e.setFieldValue("intervalMonth",n.floatValue??"")},onBlur:e.handleBlur,value:e.values.intervalMonth,isInvalid:!!((Y=e==null?void 0:e.touched)!=null&&Y.intervalMonth&&((Z=e==null?void 0:e.errors)!=null&&Z.intervalMonth))}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(e.errors.intervalMonth??"")})]})})]}),r.jsxs(p,{className:"mb-4",children:[r.jsx(u,{md:6,children:r.jsxs(o.Group,{controlId:"status",children:[r.jsxs(o.Label,{children:[l("Status"),r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(te,{options:j,placeholder:l("Select status"),value:Ce,onChange:n=>{e.setFieldValue("status",(n==null?void 0:n.value)??"")},onBlur:()=>e.setFieldTouched("status",!0),isDisabled:je,className:(k=e==null?void 0:e.touched)!=null&&k.status&&((d=e==null?void 0:e.errors)!=null&&d.status)?"is-invalid":""}),((E=e==null?void 0:e.touched)==null?void 0:E.status)&&((ee=e==null?void 0:e.errors)==null?void 0:ee.status)&&r.jsx("div",{className:"invalid-feedback d-block",children:l(((se=e==null?void 0:e.errors)==null?void 0:se.status)??"")})]})}),r.jsx(u,{md:3,style:{marginTop:"32px"},children:r.jsx(o.Group,{controlId:"bestChoice",children:r.jsxs("div",{className:"form-check form-switch form-switch-md mb-3",children:[r.jsx(o.Check.Input,{type:"checkbox",className:"form-check-input",id:"bestChoice",name:"bestChoice",checked:e.values.bestChoice,onChange:n=>{e.setFieldValue("bestChoice",n.target.checked)},onBlur:e.handleBlur}),r.jsx(o.Check.Label,{className:"form-check-label",htmlFor:"bestChoice",children:l("Best choice")})]})})}),r.jsx(u,{md:3,style:{marginTop:"32px"},children:r.jsx(o.Group,{controlId:"showPublic",children:r.jsxs("div",{className:"form-check form-switch form-switch-md mb-3",children:[r.jsx(o.Check.Input,{type:"checkbox",className:"form-check-input",id:"showPublic",name:"showPublic",checked:e.values.showPublic,onChange:n=>{e.setFieldValue("showPublic",n.target.checked)},onBlur:e.handleBlur}),r.jsx(o.Check.Label,{className:"form-check-label",htmlFor:"showPublic",children:l("Show public")})]})})})]}),r.jsx(p,{className:"mb-4",children:r.jsx(u,{md:12,children:r.jsxs(o.Group,{controlId:"shortDescription",children:[r.jsx(o.Label,{children:l("Short description")}),r.jsx(o.Control,{as:"textarea",rows:3,placeholder:l("Enter short description"),name:"shortDescription",onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.shortDescription,isInvalid:!!((re=e==null?void 0:e.touched)!=null&&re.shortDescription&&((le=e==null?void 0:e.errors)!=null&&le.shortDescription))}),r.jsx(o.Control.Feedback,{type:"invalid",children:l(((ne=e==null?void 0:e.errors)==null?void 0:ne.shortDescription)??"")})]})})}),r.jsx(p,{className:"mb-4",children:r.jsx(u,{md:12,children:r.jsxs(o.Group,{controlId:"description",children:[r.jsx(o.Label,{children:l("Plan description")}),r.jsx(Ie,{data:e.values.description,onChange:n=>{e.setFieldValue("description",n)},onBlur:()=>e.setFieldTouched("description",!0),placeholder:l("Enter plan description")}),((oe=e==null?void 0:e.touched)==null?void 0:oe.description)&&((ce=e==null?void 0:e.errors)==null?void 0:ce.description)&&r.jsx("div",{className:"invalid-feedback d-block",children:l(((ue=e==null?void 0:e.errors)==null?void 0:ue.description)??"")})]})})})]})}),r.jsxs(y.Footer,{children:[r.jsx(xe,{variant:"light",onClick:()=>{e.resetForm(),S()},children:l("Close")}),r.jsx(xe,{variant:"primary",onClick:()=>{e.handleSubmit()},disabled:e.isSubmitting,children:l(t?"Update":"Save changes")})]})]})};export{ps as ModalPlan};
