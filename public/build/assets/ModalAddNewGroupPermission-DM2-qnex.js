import{R as g,X as F,A as G,j as e}from"./ContextMenuProvider-CES3zOYT.js";import{u as D,c as S,d as w,a as m}from"./index.esm-D2riCuA9.js";import{s as x}from"./showToast-l9U56Efv.js";import{u as A}from"./useTranslation-B6z0zmmV.js";import{M as u}from"./Modal-a2NGAfV5.js";import{F as o}from"./Form-aX27DTlW.js";import{C as K}from"./Container-th-77AFz.js";import{R as C}from"./Row-ld4CxZN1.js";import{C as N}from"./Col-BWiLERb0.js";import{B as P}from"./Button-BWl8qD9i.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-DQogQWOa.js";import"./react-toastify.esm-BKmTez_p.js";import"./ThemeProvider-D6xYM_tF.js";import"./TransitionWrapper-OCvs7ibJ.js";import"./setPrototypeOf-B4fUID9J.js";import"./useEventCallback-BS1FAiJB.js";import"./useWillUnmount-UeJ70ORz.js";import"./AbstractModalHeader-DGwJbROm.js";import"./hasClass-C1CTDmmh.js";import"./NoopTransition-RwIrDKpm.js";import"./useEventCallback-D6Z_fwsa.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-BPP0C4QK.js";import"./index-NCnPiclQ.js";import"./Fade-BWe8d8Gr.js";import"./divWithClassName-oG6b8y6A.js";import"./Button-doo8uzfK.js";const de=({show:f,onHide:d})=>{var v;const{t:a}=A(),p=g.useRef(null),{guards:h}=F().props,[j,k]=g.useState(["view","create","edit","delete"]),t=g.useRef(null),r=D({initialValues:{groupPermissionName:"",groupPermissionDescription:"",groupPermissionKey:"",groupPermissionGuard:"",groupPermissionValue:[]},validationSchema:S({groupPermissionName:m().max(50,"Must be 50 characters or less").required(a("Please enter this field")),groupPermissionDescription:m().max(1e3,"Must be 1000 characters or less"),groupPermissionKey:m().max(50,"Must be 50 characters or less").required(a("Please enter this field")),groupPermissionGuard:m().required(a("Please select guard")),groupPermissionValue:w().min(1,"Please select at least one permission").of(m().max(50,"Must be 50 characters or less"))}),onSubmit:s=>{G.post(route("admin.permissions.add"),s,{onSuccess:i=>{var n,l,c,b;if((l=(n=i.props)==null?void 0:n.message)!=null&&l.error){x(a(i.props.message.error),"error");return}r.resetForm(),d(),(b=(c=i.props)==null?void 0:c.message)!=null&&b.success&&x(a(i.props.message.success),"success")},onError:i=>{const n=Object.values(i).join(", ");x(n,"error")}})}}),y=s=>{var n,l;const i=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");i.trim()===""?(n=p.current)==null||n.classList.add("d-none"):(l=p.current)==null||l.classList.remove("d-none"),r.setFieldValue("groupPermissionKey",i)},L=()=>{document.getElementById("checkAll").checked?r.setFieldValue("groupPermissionValue",j.concat("all")):r.setFieldValue("groupPermissionValue",[])},V=s=>{const i=s.target.value,n=s.target.checked;let l=[...r.values.groupPermissionValue];n?l.push(i):l=l.filter(c=>c!==i),r.setFieldValue("groupPermissionValue",l)},B=()=>{var s;if((s=t==null?void 0:t.current)!=null&&s.value){const i=t.current.value;k(n=>n.includes(i)?n:[...n,i]),t.current.value=""}};return e.jsx(u,{id:"myModal",backdrop:"static",show:f,onHide:()=>{r.resetForm(),d()},centered:!0,children:e.jsxs(o,{onSubmit:r.handleSubmit,noValidate:!0,children:[e.jsx(u.Header,{closeButton:!0,children:e.jsx("h5",{children:a("Add new group permission")})}),e.jsxs(u.Body,{children:[e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionName",children:[e.jsxs(o.Label,{children:[a("Group permission name")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:a("Enter group permission name"),maxLength:50,onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionName,isInvalid:!!(r.touched.groupPermissionName&&r.errors.groupPermissionName)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionName})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionGuard",children:[e.jsxs(o.Label,{children:[a("Guard")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(o.Select,{onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionGuard,isInvalid:!!(r.touched.groupPermissionGuard&&r.errors.groupPermissionGuard),children:[e.jsx("option",{value:"",children:a("Select guard")}),h==null?void 0:h.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionGuard})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionDescription",children:[e.jsx(o.Label,{children:a("Description")}),e.jsx(o.Control,{as:"textarea",rows:6,maxLength:1e3,placeholder:a("Enter description"),onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionDescription,isInvalid:!!(r.touched.groupPermissionDescription&&r.errors.groupPermissionDescription)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionDescription})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionKey",children:[e.jsxs(o.Label,{children:["Key ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:a("Enter key"),onChange:s=>{y(s)},maxLength:50,onBlur:r.handleBlur,value:r.values.groupPermissionKey,isInvalid:!!(r.touched.groupPermissionKey&&r.errors.groupPermissionKey)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionKey})]}),e.jsxs(o.Group,{ref:p,id:"permissionCheckbox",className:"mb-3 d-none",controlId:"groupPermissionValue",children:[e.jsxs(o.Label,{htmlFor:"",children:[a("Permissions")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(K,{children:[e.jsxs(C,{children:[e.jsx(N,{xs:12,className:"mb-2",children:e.jsx(o.Check,{id:"checkAll",type:"checkbox",value:"all",label:a("Select all"),onChange:s=>{L()},onBlur:r.handleBlur,checked:(v=r.values.groupPermissionValue)==null?void 0:v.includes("all")})}),j.map(s=>{var i;return e.jsx(N,{xs:12,lg:6,className:"mb-2",children:e.jsx(o.Check,{type:"checkbox",id:`form-check-${s}`,value:s,label:`${r.values.groupPermissionKey}_${s}`,onChange:n=>{V(n)},onBlur:r.handleBlur,checked:(i=r.values.groupPermissionValue)==null?void 0:i.includes(s)},s)})})]}),e.jsx(C,{children:r.touched.groupPermissionValue&&r.errors.groupPermissionValue&&e.jsx("div",{className:"text-danger",style:{fontSize:"0.875em"},children:r.errors.groupPermissionValue})}),e.jsxs(o.Group,{className:"d-flex flex-row gap-2 mt-3",children:[e.jsx(o.Control,{placeholder:a("Input permission name"),maxLength:50,ref:t,onChange:s=>{const i=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");s.target.value=i}}),e.jsx(P,{size:"sm",variant:"primary",onClick:B,children:a("Add")})]})]})]})]}),e.jsxs(u.Footer,{children:[e.jsx(P,{variant:"light",onClick:()=>{r.resetForm(),d()},children:a("Close")}),e.jsx(P,{variant:"primary",type:"submit",children:a("Add new")})]})]})})};export{de as ModalAddNewGroupPermission};
