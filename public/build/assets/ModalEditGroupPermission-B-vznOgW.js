import{R as t,X as E,j as r,A as I}from"./index-EM1BjBMV.js";import{u as $,c as K,a as R,b as a}from"./index.esm-BbJdVMiP.js";import{B as w,F as A}from"./isSymbol-Czc8PlkC.js";import{u as M}from"./useTranslation-B97z7fiK.js";import{M as h}from"./Modal-BW56jli-.js";import{F as i}from"./Form-Crrp_3nh.js";import{C as z}from"./Container-AbJyAqVa.js";import{R as L,C as B,B as b}from"./Row-B5TknY2O.js";import"./hoist-non-react-statics.cjs-DQogQWOa.js";import"./CloseButton-DsugLeO_.js";import"./setPrototypeOf-B4fUID9J.js";import"./AbstractModalHeader-CQjkIP_d.js";const se=({show:F,onHide:g,data:e})=>{var f,C,N;const{t:l}=M(),x=t.useRef(null),{guards:d}=E().props,k=(o,n)=>o.replace(`${n}_`,""),[P,v]=t.useState([]),m=t.useRef(null);t.useEffect(()=>{if(e!=null&&e.permissions&&(e!=null&&e.key)){const o=e.permissions.map(n=>k(n==null?void 0:n.name,e==null?void 0:e.key));v(o)}},[e]);const j=(o,n)=>{w[n](o,{position:"top-center",autoClose:2500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",transition:A})},s=$({initialValues:{groupPermissionName:(e==null?void 0:e.name)||"",groupPermissionDescription:(e==null?void 0:e.description)||"",groupPermissionKey:(e==null?void 0:e.key)||"",groupPermissionGuard:((C=(f=e==null?void 0:e.permissions)==null?void 0:f[0])==null?void 0:C.guard_name)||"",groupPermissionValue:e!=null&&e.permissions&&(e!=null&&e.key)?e.permissions.map(o=>k(o==null?void 0:o.name,e==null?void 0:e.key)):[]},enableReinitialize:!0,validationSchema:K({groupPermissionName:a().max(50,"Must be 50 characters or less").required(l("Please enter this field")),groupPermissionDescription:a().max(1e3,"Must be 1000 characters or less"),groupPermissionGuard:a().required(l("Please select guard")),groupPermissionValue:R().min(1,"Please select at least one permission").of(a().max(50,"Must be 50 characters or less"))}),onSubmit:o=>{const n={id:e==null?void 0:e.id,groupPermissionName:o.groupPermissionName,groupPermissionDescription:o.groupPermissionDescription,groupPermissionKey:e==null?void 0:e.key,groupPermissionGuard:o.groupPermissionGuard,groupPermissionValue:o.groupPermissionValue};I.put(route("admin.permissions.update",e==null?void 0:e.id),n,{onSuccess:u=>{var c,p,y,V;if((p=(c=u.props)==null?void 0:c.message)!=null&&p.error){j(l(u.props.message.error),"error");return}s.resetForm(),g(),(V=(y=u.props)==null?void 0:y.message)!=null&&V.success&&j(l(u.props.message.success),"success")},onError:u=>{const c=Object.values(u).join(", ");j(c,"error")}})}});t.useEffect(()=>{e!=null&&e.key&&x.current&&x.current.classList.remove("d-none")},[e]);const G=()=>{document.getElementById("checkAll").checked?s.setFieldValue("groupPermissionValue",P.concat("all")):s.setFieldValue("groupPermissionValue",[])},D=o=>{const n=o.target.value,u=o.target.checked;let c=[...s.values.groupPermissionValue];u?c.push(n):c=c.filter(p=>p!==n),s.setFieldValue("groupPermissionValue",c)},S=()=>{var o;if((o=m==null?void 0:m.current)!=null&&o.value){const n=m.current.value;v(c=>c.includes(n)?c:[...c,n]);const u=[...s.values.groupPermissionValue];u.includes(n)||(u.push(n),s.setFieldValue("groupPermissionValue",u)),m.current.value=""}};return r.jsx(h,{id:"myModal",backdrop:"static",show:F,onHide:()=>{s.resetForm(),g()},centered:!0,children:r.jsxs(i,{onSubmit:s.handleSubmit,noValidate:!0,children:[r.jsx(h.Header,{closeButton:!0,children:r.jsx("h5",{children:l("Edit group permission")})}),r.jsxs(h.Body,{children:[r.jsxs(i.Group,{className:"mb-3",controlId:"groupPermissionName",children:[r.jsxs(i.Label,{children:[l("Group permission name")," ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(i.Control,{type:"text",placeholder:l("Enter group permission name"),maxLength:50,onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.groupPermissionName,isInvalid:!!(s.touched.groupPermissionName&&s.errors.groupPermissionName)}),r.jsx(i.Control.Feedback,{type:"invalid",children:s.errors.groupPermissionName})]}),r.jsxs(i.Group,{className:"mb-3",controlId:"groupPermissionGuard",children:[r.jsxs(i.Label,{children:[l("Guard")," ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsxs(i.Select,{onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.groupPermissionGuard,isInvalid:!!(s.touched.groupPermissionGuard&&s.errors.groupPermissionGuard),children:[r.jsx("option",{value:"",children:l("Select guard")}),d==null?void 0:d.map(o=>r.jsx("option",{value:o.value,children:o.label},o.value))]}),r.jsx(i.Control.Feedback,{type:"invalid",children:s.errors.groupPermissionGuard})]}),r.jsxs(i.Group,{className:"mb-3",controlId:"groupPermissionDescription",children:[r.jsx(i.Label,{children:l("Description")}),r.jsx(i.Control,{as:"textarea",rows:6,maxLength:1e3,placeholder:l("Enter description"),onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.groupPermissionDescription,isInvalid:!!(s.touched.groupPermissionDescription&&s.errors.groupPermissionDescription)}),r.jsx(i.Control.Feedback,{type:"invalid",children:s.errors.groupPermissionDescription})]}),r.jsxs(i.Group,{className:"mb-3",controlId:"groupPermissionKey",children:[r.jsxs(i.Label,{children:["Key ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsx(i.Control,{type:"text",placeholder:l("Enter key"),maxLength:50,onBlur:s.handleBlur,value:s.values.groupPermissionKey,disabled:!0,isInvalid:!!(s.touched.groupPermissionKey&&s.errors.groupPermissionKey)}),r.jsx(i.Control.Feedback,{type:"invalid",children:s.errors.groupPermissionKey})]}),r.jsxs(i.Group,{ref:x,id:"permissionCheckbox",className:"mb-3",controlId:"groupPermissionValue",children:[r.jsxs(i.Label,{htmlFor:"",children:[l("Permissions")," ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsxs(z,{children:[r.jsxs(L,{children:[P.length>0&&r.jsx(B,{xs:12,className:"mb-2",children:r.jsx(i.Check,{id:"checkAll",type:"checkbox",value:"all",label:l("Select all"),onChange:o=>{G()},onBlur:s.handleBlur,checked:(N=s.values.groupPermissionValue)==null?void 0:N.includes("all")})}),P.map(o=>{var n;return r.jsx(B,{xs:12,lg:6,className:"mb-2",children:r.jsx(i.Check,{type:"checkbox",id:`form-check-${o}`,value:o,label:`${e==null?void 0:e.key}_${o}`,onChange:u=>{D(u)},onBlur:s.handleBlur,checked:(n=s.values.groupPermissionValue)==null?void 0:n.includes(o)},o)})})]}),r.jsx(L,{children:s.touched.groupPermissionValue&&s.errors.groupPermissionValue&&r.jsx("div",{className:"text-danger",style:{fontSize:"0.875em"},children:s.errors.groupPermissionValue})}),r.jsxs(i.Group,{className:"d-flex flex-row gap-2 mt-3",children:[r.jsx(i.Control,{placeholder:l("Input permission name"),maxLength:50,ref:m,onChange:o=>{const n=o.target.value.replace(/[^A-Za-z-.0-9]/g,"");o.target.value=n}}),r.jsx(b,{size:"sm",variant:"primary",onClick:S,children:l("Add")})]})]})]})]}),r.jsxs(h.Footer,{children:[r.jsx(b,{variant:"light",onClick:()=>{s.resetForm(),g()},children:l("Close")}),r.jsx(b,{variant:"primary",type:"submit",children:l("Update")})]})]})})};export{se as ModalEditGroupPermission};
