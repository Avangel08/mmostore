import{d as i,j as r,A as V}from"./ContextMenuProvider-DoI9LuTu.js";import{T as D}from"./TableWithContextMenu-BZIzvy0z.js";import{C as P}from"./ContextMenuBuilder-BNNvuvxc.js";import{h as f}from"./moment-C5S46NFB.js";import{s as F}from"./showToast-BFjkHmvN.js";import{ModalVerifyStore as z}from"./ModalVerifyStore-BzxUg-4z.js";import{u as L}from"./useTranslation-Bh5zzBC_.js";import{F as T}from"./Form-C6Oq7frR.js";import{O as x,T as h}from"./OverlayTrigger-Djx2tsRN.js";import{B as j}from"./Button-CdshqBqI.js";import"./index-DIUs0fRp.js";import"./index-H0Krwn6i.js";import"./Row-DaX0pFtU.js";import"./ThemeProvider-CQKb4rSK.js";import"./Card-BP66js0B.js";import"./divWithClassName-Ct-4CK0x.js";import"./Col-BERnSmBs.js";import"./Table-CGXLq3B1.js";import"./react-select.esm-Ci0lS3LH.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./extends-CF3RwP-h.js";import"./setPrototypeOf-DgZC2w_0.js";import"./inherits-B2gPeQio.js";import"./hoist-non-react-statics.cjs-BsRiVy2U.js";import"./useQueryParam-xm9iNkis.js";import"./react-toastify.esm-8BWsAHON.js";import"./index.esm-yjK6ua4W.js";import"./isSymbol-CYvIzdD2.js";import"./Modal-Ct9dsq7D.js";import"./useMergedRefs-Cm3LQ1VB.js";import"./useEventCallback-BA23UYAQ.js";import"./useWillUnmount-CWisbIWq.js";import"./TransitionWrapper-CRtjL7Sb.js";import"./AbstractModalHeader-Baf6fi1-.js";import"./useWindow-B3mPSubg.js";import"./querySelectorAll-rMMgkU1T.js";import"./useEventCallback-Bsoi2xyD.js";import"./hasClass-B9uJik72.js";import"./NoopTransition-Badst7zB.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-feMrj_cP.js";import"./index-B7rcZTdA.js";import"./Fade-iG7JUvQW.js";import"./hook-Crll79d-.js";import"./useIsomorphicEffect-DSAwC7_u.js";import"./Button-lElTeqs9.js";const Be=({data:a,onReloadTable:Y,onEdit:p,onSelectionChange:y,onAddPlan:S})=>{const{t:s}=L(),[u,n]=i.useState([]),[c,b]=i.useState(!1),[A,k]=i.useState(!1),[E,v]=i.useState(null),[I,g]=i.useState([]);i.useEffect(()=>{y&&y(u)},[u,y]),i.useEffect(()=>{n([]),b(!1)},[a]);const K=t=>new P().addCustomOption("edit",s("Edit"),"ri-edit-2-fill","",()=>{p&&p(t==null?void 0:t.id)}).addCustomOption("delete",s("Delete"),"ri-delete-bin-5-line","",()=>{p&&p(t==null?void 0:t.id)}).build(),M=i.useCallback(()=>{var t;if(c)n([]);else{const e=((t=a==null?void 0:a.data)==null?void 0:t.map(o=>o.id))||[];n(e)}b(!c)},[c,a]),N=i.useCallback((t,e)=>{e?n(o=>[...o,t]):(n(o=>o.filter(l=>l!==t)),b(!1))},[]),O=async t=>{V.reload({only:["verifyStoreData","storeCategoryOptions"],data:{id:t},replace:!0,onSuccess:e=>{var o,l;if(!((o=e==null?void 0:e.props)!=null&&o.verifyStoreData)){F(s("Failed to load user store data"),"error");return}v(e.props.verifyStoreData),g(((l=e==null?void 0:e.props)==null?void 0:l.storeCategoryOptions)||[]),k(!0)},onError:()=>{F(s("Failed to load user store data"),"error")}})},B=()=>{V.reload({only:["storeCategoryOptions"],replace:!0,onSuccess:t=>{var e;g(((e=t==null?void 0:t.props)==null?void 0:e.storeCategoryOptions)||[])}})},H=()=>{k(!1),v(null)},w=t=>{S&&S(t)},_=i.useMemo(()=>[{header:r.jsx(T.Check.Input,{type:"checkbox",id:"checkBoxAll",className:"form-check-input",checked:c,onChange:M}),cell:t=>{const e=t.row.original,o=u.includes(e.id);return r.jsx(T.Check.Input,{type:"checkbox",className:"roleCheckbox form-check-input",checked:o,onChange:l=>N(e.id,l.target.checked)})},id:"#"},{header:s("Name"),accessorKey:"",enableColumnFilter:!1,cell:t=>{var d;const e=t.row.original,o=(e==null?void 0:e.name)??"",l=(e==null?void 0:e.stores)||[],m=((d=l==null?void 0:l.find(C=>!!(C!=null&&C.verified_at)))==null?void 0:d.verified_at)??null;return r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"fw-bold",children:o})," ",!!m&&r.jsx(x,{placement:"top",overlay:r.jsx(h,{children:s("Verified at {{time}}",{time:m?f(m).format("DD/MM/YYYY HH:mm"):""})}),children:r.jsx("i",{className:"ri-checkbox-circle-fill text-secondary fs-5"})})]})}},{header:s("Email"),accessorKey:"email",enableColumnFilter:!1},{header:s("Plan"),accessorKey:"",enableColumnFilter:!1,cell:t=>{var d;const e=(d=t.row.original)==null?void 0:d.current_plan;if(!e)return r.jsx("span",{className:"text-muted"});const o=f(e.expires_on),m=o.isBefore(f())?"text-danger":"text-success";return r.jsxs("div",{className:"d-flex flex-column gap-0",children:[r.jsx("div",{className:"fw-semibold",children:e.name}),r.jsxs("div",{className:`small ${m}`,children:[s("Expires"),": ",o.format("DD/MM/YYYY HH:mm")]})]})}},{header:s("Type"),accessorKey:"type",enableColumnFilter:!1},{header:s("Status"),accessorKey:"status",enableColumnFilter:!1,cell:t=>{const e={0:"border-warning text-warning",1:"border-success text-success",2:"border-danger text-danger"},o={1:s("ACTIVE"),0:s("INACTIVE"),2:s("BLOCK")};return r.jsx("span",{style:{width:"120px"},className:`badge border ${e[t.getValue()]||"border-dark text-body"} fs-6 me-2`,children:o[t.getValue()]||"BLOCK"})}},{header:s("Created date"),accessorKey:"created_at",enableColumnFilter:!1,cell:t=>r.jsx("span",{children:f(t.getValue()).format("DD/MM/YYYY HH:mm")})},{header:s("Actions"),enableColumnFilter:!1,cell:t=>{const e=t.row.original,o=e==null?void 0:e.id;return r.jsxs("div",{className:"d-flex gap-2",children:[r.jsx(x,{placement:"top",overlay:r.jsx(h,{children:s("Verify store")}),children:r.jsx(j,{size:"sm",variant:"outline-primary",onClick:()=>O(o),children:r.jsx("i",{className:"ri-check-double-line"})})}),r.jsx(x,{placement:"top",overlay:r.jsx(h,{children:s("Login")}),children:r.jsx(j,{size:"sm",variant:"outline-info",onClick:()=>{const l=route("admin.user.login-as",{id:o});window.open(l,"_blank")},children:r.jsx("i",{className:"ri-login-box-line"})})}),r.jsx(x,{placement:"top",overlay:r.jsx(h,{children:s("Add plan")}),children:r.jsx(j,{size:"sm",variant:"outline-primary",onClick:()=>w(o),children:r.jsx("i",{className:"ri-wallet-line"})})})]})}}],[s,c,u,M,N,O]);return r.jsxs("div",{children:[r.jsx(D,{columns:_,data:a||[],divClass:"table-responsive table-card mb-3",tableClass:"table align-middle table-nowrap mb-0",theadClass:"table-light",SearchPlaceholder:s("Search..."),enableContextMenu:!0,contextMenuOptions:K,isPaginateTable:!0,onReloadTable:Y}),r.jsx(z,{show:A,onHide:H,dataVerifyStore:E,storeCategoryOptions:I,onReloadOptions:B})]})};export{Be as default};
