import{d as i,R as te,j as l,e as ne}from"./ContextMenuProvider-DCdb8j9t.js";import{F as re,_ as se,v as oe}from"./default-BvN15SVT.js";import{i as ae,c as ue,S as Z}from"./react-select.esm-Bx-RY50u.js";import{h as W}from"./moment-C5S46NFB.js";import{u as ie}from"./useQueryParam-cDD8Df1K.js";import{u as le}from"./useTranslation-BeBCG-tb.js";import{B as H}from"./Button-DkR4lkD4.js";import{R as ce}from"./Row-DcrQzJSf.js";import{C as F}from"./Col-BKpEL2i4.js";import{F as I}from"./Form-BwWb-AQG.js";import"./index-BSRKPwsw.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./extends-CF3RwP-h.js";import"./setPrototypeOf-DgZC2w_0.js";import"./inherits-B2gPeQio.js";import"./hoist-non-react-statics.cjs-Cl0fTsAK.js";import"./ThemeProvider-B2_W_dCu.js";import"./Button-DW89RreQ.js";var U={};Object.defineProperty(U,"__esModule",{value:!0});function de(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.length===2)return Q(e[0],e[1])||null;var t=e.slice(1).reduce(function(s,u){return Q(s,u)},e[0]);return t||null}var fe=U.default=de,K=new WeakMap;function Q(e,n){if(e&&n){var t=K.get(e)||new WeakMap;K.set(e,t);var s=t.get(n)||function(u){G(e,u),G(n,u)};return t.set(n,s),s}return e||n}function G(e,n){typeof e=="function"?e(n):e.current=n}var J=Symbol("useLazyRef empty value"),pe=e=>{const n=i.useRef(J);return n.current===J&&(n.current=e()),n};function me(){var e=i.useRef(!1);return i.useEffect(function(){return e.current=!0,function(){e.current=!1}},[]),e}var _=function(n){var t=te.useRef(n);return ae(function(){t.current=n}),t};function D(e){return{isOk:()=>!0,isOkAnd:t=>t(e),isErr:()=>!1,isErrAnd:()=>!1,ok:()=>q(e),err:()=>P(),map:t=>D(t(e)),mapOr:(t,s)=>s(e),mapOrElse:(t,s)=>s(e),mapErr:()=>D(e),expect:()=>e,expectErr:t=>{throw new Error(t)},unwrap:()=>e,unwrapErr:()=>{throw new Error(`${e}`)},unwrapOr:()=>e,unwrapOrElse:()=>e,and:t=>t,andThen:t=>t(e),or:()=>D(e),orElse:()=>D(e)}}function j(e){return{isOk:()=>!1,isOkAnd:()=>!1,isErr:()=>!0,isErrAnd:t=>t(e),ok:()=>P(),err:()=>q(e),map:()=>j(e),mapOr:t=>t,mapOrElse:t=>t(e),mapErr:t=>j(t(e)),expect:t=>{throw new Error(t)},expectErr:()=>e,unwrap:()=>{throw new Error(`${e}`)},unwrapErr:()=>e,unwrapOr:t=>t,unwrapOrElse:t=>t(e),and:()=>j(e),andThen:()=>j(e),or:t=>t,orElse:t=>t(e)}}function P(){const e={and:()=>P(),andThen:()=>P(),expect:n=>{throw new Error(n)},filter:()=>e,isSome:()=>!1,isSomeAnd:()=>!1,isNone:()=>!0,map:()=>P(),mapOr:n=>n,mapOrElse:n=>n(),okOr:n=>j(n),okOrElse:n=>j(n()),or:n=>n,orElse:n=>n(),unwrap:()=>{throw new Error("panic! call `unwrap` on a `None` value")},unwrapOr:n=>n,unwrapOrElse:n=>n(),xor:n=>n.isSome()?n:e};return e}function q(e){const n={and:t=>t,andThen:t=>t(e),expect:()=>e,filter:t=>t(e)?n:P(),isSome:()=>!0,isSomeAnd:t=>t(e),isNone:()=>!1,map:t=>q(t(e)),mapOr:(t,s)=>s(e),mapOrElse:(t,s)=>s(e),okOr:()=>D(e),okOrElse:()=>D(e),or:()=>n,orElse:()=>n,unwrap:()=>e,unwrapOr:()=>e,unwrapOrElse:()=>e,xor:t=>t.isNone()?n:P()};return n}function he(e){return e.then(n=>D(n),n=>j(n))}var ge=setTimeout;function Se(e,n){var t=n.useCachedSetTimeout?ge:setTimeout;return new Promise(function(s){t(s,e)})}function Oe(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n.useCachedSetTimeout,s=Se(e,{useCachedSetTimeout:t});function u(f){return s.then(function(){return f})}return u.then=function(){return s.then.apply(s,arguments)},u.catch=Promise.resolve().catch,u}var Ee=300;function ve(e){function n(t){const{selectProps:s,innerRef:u}=t,{handleScrolledToBottom:f,shouldLoadMore:h}=s,r=i.useRef(null),c=i.useRef(null),E=i.useCallback(()=>{const d=c.current;if(!d)return!1;const{scrollTop:m,scrollHeight:g,clientHeight:p}=d;return h(g,p,m)},[h]),o=i.useCallback(()=>{E()&&f&&f()},[E,f]),v=i.useMemo(()=>{const d=()=>{o(),r.current=setTimeout(d,Ee)};return d},[o]);return i.useEffect(()=>(v(),()=>{r.current&&clearTimeout(r.current)}),[]),l.jsx(e,{...t,innerRef:fe(u,c)})}return n}var we=ve(ue.MenuList),xe=e=>i.useMemo(()=>({MenuList:we,...e}),[e]),be=(e,n)=>[...e,...n],Ce=10,Me=(e,n,t)=>e-n-Ce<t,ee=e=>({isFirstLoad:!0,options:[],hasMore:!0,isLoading:!1,lockedUntil:0,additional:e.additional}),Re=({options:e,defaultOptions:n,additional:t,defaultAdditional:s})=>{const u=n===!0?null:Array.isArray(n)?n:e;return u?{"":{isFirstLoad:!1,isLoading:!1,options:u,hasMore:!0,lockedUntil:0,additional:s||t}}:{}},X='[react-select-async-paginate] response of "loadOptions" should be an object with "options" prop, which contains array of options.',Le=e=>{if(!e)return!1;const{options:n,hasMore:t}=e;return!(!Array.isArray(n)||typeof t!="boolean"&&typeof t<"u")},ke=e=>{if(!Le(e))throw console.error(X,"Received:",e),new Error(X);return!0},ye=async(e,n,t,s,u,f,h,r)=>{const c=n.current.inputValue,E=!t.current[c],o=E?ee(n.current):t.current[c];if(o.isLoading||!o.hasMore||o.lockedUntil>Date.now())return;if(u(p=>r&&e==="input-change"?{[c]:{...o,isLoading:!0}}:{...p,[c]:{...o,isLoading:!0}}),s>0&&e==="input-change"){await Oe(s);const p=n.current.inputValue;if(c!==p){u(b=>{if(E){const{[c]:x,...C}=b;return C}return{...b,[c]:{...o,isLoading:!1}}});return}}const{loadOptions:v,reloadOnErrorTimeout:d=0}=n.current,m=await he(Promise.resolve().then(()=>v(c,o.options,o.additional)));if(!h.current)return;if(m.isErr()){u(p=>({...p,[c]:{...o,isLoading:!1,lockedUntil:Date.now()+d}}));return}const g=m.unwrap();if(ke(g)){const{options:p,hasMore:b}=g,x=Object.hasOwn(g,"additional")?g.additional:o.additional;u(C=>({...C,[c]:{...o,options:f(o.options,p,x),hasMore:!!b,isLoading:!1,isFirstLoad:!1,additional:x}}))}},$=e=>e+1,Ie=(e,n=[])=>{const{clearCacheOnSearchChange:t=!1,clearCacheOnMenuClose:s=!1,defaultOptions:u,loadOptionsOnMenuOpen:f=!0,debounceTimeout:h=0,inputValue:r,menuIsOpen:c,filterOption:E=null,reduceOptions:o=be,shouldLoadMore:v=Me,mapOptionsForMenu:d=void 0}=e,m=_(c),g=me(),p=_(o),b=_(f),x=i.useRef(!0),C=i.useRef(e);C.current=e;const[L,y]=i.useState(0),S=pe(()=>Re(e)),R=_(A=>{ye(A,C,S,h,a=>{S.current=a(S.current),g.current&&y($)},p.current,g,t)}),Y=i.useCallback(()=>{const A=C.current.inputValue;S.current[A]&&R.current("menu-scroll")},[R,S]);i.useEffect(()=>{x.current?x.current=!1:(S.current={},y($)),u===!0&&R.current("autoload")},n),i.useEffect(()=>{m.current&&!S.current[r]&&R.current("input-change")},[R,r,m,S]),i.useEffect(()=>{if(c){if(!S.current[""]&&b.current){R.current("menu-toggle");return}return}s&&(S.current={},y($))},[R,b,c,S,s]);const k=S.current[r]||ee(e),B=i.useMemo(()=>d?d(k.options):k.options,[k.options,d]);return{handleScrolledToBottom:Y,shouldLoadMore:v,filterOption:E,isLoading:k.isLoading||k.lockedUntil>Date.now(),isFirstLoad:k.isFirstLoad,options:B}},De=(e,n=[])=>{const{inputValue:t,menuIsOpen:s,defaultInputValue:u,defaultMenuIsOpen:f,onInputChange:h,onMenuClose:r,onMenuOpen:c}=e,[E,o]=i.useState(u||""),[v,d]=i.useState(!!f),m=typeof t=="string"?t:E,g=typeof s=="boolean"?s:v,p=i.useCallback((L,y)=>{h&&h(L,y),o(L)},[h]),b=i.useCallback(()=>{r&&r(),d(!1)},[r]),x=i.useCallback(()=>{c&&c(),d(!0)},[c]);return{...Ie({...e,inputValue:m,menuIsOpen:g},n),inputValue:m,menuIsOpen:g,onInputChange:p,onMenuClose:b,onMenuOpen:x}},je=[],Pe={};function Fe(e){function n(t){const{components:s=Pe,selectRef:u=void 0,isLoading:f,cacheUniqs:h=je,menuPlacement:r,menuShouldScrollIntoView:c,...E}=t,o=De(E,h),v=xe(s),d=typeof f=="boolean"?f:o.isLoading;return l.jsx(e,{...t,...o,menuPlacement:r,menuShouldScrollIntoView:r==="auto"&&d?!1:c,isLoading:d,components:v,ref:u})}return n}var Ae=Fe(Z);const et=({onFilter:e,subProductId:n})=>{const{t,i18n:s}=le(),u=i.useRef(null),[f,h]=i.useState(!1),r=ie(),c=(r==null?void 0:r.accountPerPage)??"10",E=()=>({product:(r==null?void 0:r.product)??"",createdDateStart:(r==null?void 0:r.createdDateStart)??"",createdDateEnd:(r==null?void 0:r.createdDateEnd)??"",status:(r==null?void 0:r.status)??"",orderNumber:(r==null?void 0:r.orderNumber)??"",sellStatus:(r==null?void 0:r.sellStatus)??"unsold"}),[o,v]=i.useState(E()),d=[{value:"",label:t("All")}],m=[{value:"",label:t("All")},{value:"unsold",label:t("Unsold")},{value:"sold",label:t("Sold")}],[g,p]=i.useState(d[0]),[b,x]=i.useState(m[0]);i.useEffect(()=>{const a=r==null?void 0:r.status;if(a!==null){const O=d.find(N=>N.value.toString()===a);O&&p(O)}const M=(r==null?void 0:r.sellStatus)??"unsold",w=m.find(O=>O.value===M);w&&x(w)},[]);const C=()=>{switch(s.language){case"vi":return oe.Vietnamese;default:return se.english}},L=(a,M)=>{v(w=>({...w,[a]:M}))},y=a=>{const[M,w]=a;v(O=>({...O,createdDateStart:M?W(M).format("YYYY-MM-DD"):"",createdDateEnd:w?W(w).format("YYYY-MM-DD"):""}))},S=a=>{p(a),L("status",a.value)},R=a=>{x(a),L("sellStatus",a.value)},Y=()=>{e(1,Number(c),o)},k=()=>{const a=r==null?void 0:r.product,M=r==null?void 0:r.createdDateStart,w=r==null?void 0:r.createdDateEnd,O=r==null?void 0:r.status,N=r==null?void 0:r.orderNumber,T=r==null?void 0:r.sellStatus;return a!==null&&a!==""||M!==null&&M!==""||w!==null&&w!==""||O!==null&&O!==""||N!==null&&N!==""||T!==null&&T!=="unsold"},B=()=>{const a={product:"",createdDateStart:"",createdDateEnd:"",status:"",orderNumber:"",sellStatus:"unsold"};v(a),p(d[0]),x(m[1]),u.current&&u.current.flatpickr&&u.current.flatpickr.clear(),e(1,Number(c),a)},A=()=>{h(!f)};return l.jsxs("div",{className:"filter-container mb-3",children:[l.jsxs("div",{className:"mb-3 d-flex align-items-center gap-2",children:[l.jsxs(H,{variant:"outline-primary",onClick:A,className:"d-flex align-items-center",children:[l.jsx("i",{className:`ri-filter-${f?"off":"2"}-line align-bottom me-2`}),t(f?"Hide Filters":"Show Filters")]}),k()&&l.jsxs(H,{variant:"outline-danger",onClick:B,className:"d-flex align-items-center",children:[l.jsx("i",{className:"ri-refresh-line align-bottom me-1"}),t("Reset")]})]}),f&&l.jsx("div",{className:"p-3 border rounded bg-light",children:l.jsxs(ce,{className:"g-3",children:[l.jsxs(F,{md:6,lg:2,children:[l.jsx(I.Label,{htmlFor:"filter-sell-status",children:t("Sell Status")}),l.jsx(Z,{id:"filter-sell-status",value:b,onChange:R,options:m,classNamePrefix:"select",isSearchable:!0,placeholder:t("Select sell status"),menuPortalTarget:document.body,styles:{menuPortal:a=>({...a,zIndex:9999})}})]}),l.jsxs(F,{md:4,lg:3,children:[l.jsx(I.Label,{htmlFor:"filter-product",children:t("Product")}),l.jsx(I.Control,{type:"text",id:"filter-product",placeholder:t("Enter product"),value:o.product,onChange:a=>L("product",a.target.value)})]}),l.jsxs(F,{md:4,lg:3,children:[l.jsx(I.Label,{htmlFor:"filter-date",children:t("Created Date Range")}),l.jsx(re,{ref:u,className:"form-control",id:"filter-date",placeholder:t("Select date range"),options:{mode:"range",dateFormat:"d/m/Y",locale:C()},value:o.createdDateStart&&o.createdDateEnd?[new Date(o.createdDateStart),new Date(o.createdDateEnd)]:o.createdDateStart?[new Date(o.createdDateStart)]:[],onChange:y})]}),l.jsxs(F,{md:4,lg:2,children:[l.jsx(I.Label,{htmlFor:"filter-status",children:t("Status")}),l.jsx(Ae,{id:"filter-status",value:g,loadOptions:async(a,M,{page:w})=>{var T,z;if(!n)return{options:[],hasMore:!1};const O=await ne.get(route("seller.account.status-options",{sub_product_id:n,search:a,page:w}));return{options:((z=(T=O==null?void 0:O.data)==null?void 0:T.results)==null?void 0:z.map(V=>({value:(V==null?void 0:V.value)??"",label:t(V.label)??""})))??[],hasMore:O.data.has_more,additional:{page:w+1}}},additional:{page:1},clearCacheOnMenuClose:!0,clearCacheOnSearchChange:!0,onChange:S,options:d,classNamePrefix:"select",placeholder:t("Select status"),menuPortalTarget:document.body,styles:{menuPortal:a=>({...a,zIndex:9999})}})]}),l.jsxs(F,{md:6,lg:2,children:[l.jsx(I.Label,{htmlFor:"filter-order",children:t("Order ID")}),l.jsx(I.Control,{type:"text",id:"filter-order",placeholder:t("Enter Order ID"),value:o.orderNumber,onChange:a=>L("orderNumber",a.target.value)})]}),l.jsx(F,{md:12,children:l.jsxs(H,{variant:"primary",onClick:Y,children:[l.jsx("i",{className:"ri-search-line align-bottom me-1"}),t("Filter")]})})]})})]})};export{et as default};
