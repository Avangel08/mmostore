import{d as i,j as e,R as I,D as Ne}from"./ContextMenuProvider-Bgjy8Wg_.js";import{u as ie,g as re,a as ve,c as oe,b as ce,f as G}from"./index-CN6wmjNw.js";import{r as ue}from"./index-H0Krwn6i.js";import{u as me}from"./useTranslation-i33--018.js";import{R as S}from"./Row-C_tKnLHn.js";import{C as de}from"./Card-CBOUm2ms.js";import{C as Z}from"./Col-Dir6tpbB.js";import{T as ge}from"./Table-RDBMq32C.js";import{B as k}from"./Button-RncLFi2F.js";import{S as he}from"./react-select.esm-D-kJikdD.js";import{u as pe}from"./useQueryParam-CHocvwWE.js";const Ce=({column:l})=>{const n=l.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(je,{type:"text",value:n??"",onChange:r=>l.setFilterValue(r),placeholder:"Search...",className:"w-36 border shadow rounded",list:l.id+"list"}),e.jsx("div",{className:"h-1"})]})},je=({value:l,onChange:n,debounce:r=500,...c})=>{const[m,d]=i.useState(l);return i.useEffect(()=>{d(l)},[l]),i.useEffect(()=>{const g=setTimeout(()=>{n(m)},r);return()=>clearTimeout(g)},[r,m]),e.jsx("input",{...c,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:g=>d(g.target.value)})},Se=({columns:l,data:n,isGlobalFilter:r,customPageSize:c,borderClass:m,tableClass:d,theadClass:g,trClass:H,thClass:O,divClass:B,SearchPlaceholder:L,onSubmit:U=F=>{F.preventDefault()},onRowContextMenu:x})=>{const{t:F}=me(),[w,Y]=i.useState([]),[E,R]=i.useState(""),D=(o,a,V,_)=>{const y=ue(o.getValue(a),V);return _({itemRank:y}),y.passed},$=ie({columns:l,data:n,filterFns:{fuzzy:D},state:{columnFilters:w,globalFilter:E},onColumnFiltersChange:Y,onGlobalFilterChange:R,globalFilterFn:D,getCoreRowModel:ce(),getFilteredRowModel:oe(),getPaginationRowModel:ve(),getSortedRowModel:re()}),{getHeaderGroups:p,getRowModel:v,getCanPreviousPage:Q,getCanNextPage:T,getPageOptions:M,setPageIndex:f,nextPage:b,previousPage:h,setPageSize:j,getState:z}=$;i.useEffect(()=>{Number(c)&&j(Number(c))},[c,j]);const C=(o,a)=>{x&&x(o,a)};return e.jsxs(i.Fragment,{children:[r&&e.jsx(S,{className:"mb-3",children:e.jsx(de.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:U,children:e.jsx(S,{children:e.jsx(Z,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(je,{value:E??"",onChange:o=>R(String(o)),placeholder:L}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:B,children:e.jsxs(ge,{hover:!0,className:d,bordered:m,children:[e.jsx("thead",{className:g,children:p().map(o=>e.jsx("tr",{className:H,children:o.headers.map(a=>e.jsx("th",{className:O,onClick:a.column.getToggleSortingHandler(),children:a.isPlaceholder?null:e.jsxs(I.Fragment,{children:[G(a.column.columnDef.header,a.getContext()),{asc:" ",desc:" "}[a.column.getIsSorted()]??null,a.column.getCanFilter()?e.jsx("div",{children:e.jsx(Ce,{column:a.column,table:$})}):null]})},a.id))},o.id))}),e.jsx("tbody",{children:v().rows.map(o=>e.jsx("tr",{onContextMenu:a=>C(a,o.original),style:{cursor:x?"context-menu":"default"},children:o.getVisibleCells().map(a=>e.jsx("td",{children:G(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]})}),e.jsxs(S,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[F("Showing"),e.jsx("span",{className:"fw-semibold ms-1",children:v().rows.length})," ",F("on")," ",e.jsx("span",{className:"fw-semibold",children:n.length})," ",F("results")]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:Q()?"page-item":"page-item disabled",children:e.jsx(k,{className:"page-link",onClick:h,variant:"link",children:"<"})}),M().map((o,a)=>e.jsx(I.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx(k,{variant:"link",className:z().pagination.pageIndex===o?"page-link active":"page-link",onClick:()=>f(o),children:o+1})})},a)),e.jsx("li",{className:T()?"page-item":"page-item disabled",children:e.jsx(k,{variant:"link",className:"page-link",onClick:b,children:">"})})]})})]})]})},Fe=({column:l})=>{const n=l.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(be,{type:"text",value:n??"",onChange:r=>l.setFilterValue(r),placeholder:"Search...",className:"w-36 border shadow rounded",list:l.id+"list"}),e.jsx("div",{className:"h-1"})]})},be=({value:l,onChange:n,debounce:r=500,...c})=>{const[m,d]=i.useState(l);return i.useEffect(()=>{d(l)},[l]),i.useEffect(()=>{const g=setTimeout(()=>{n(m)},r);return()=>clearTimeout(g)},[r,m]),e.jsx("input",{...c,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:g=>d(g.target.value)})},we=({columns:l,data:n,isGlobalFilter:r,customPageSize:c,borderClass:m,tableClass:d,theadClass:g,trClass:H,thClass:O,divClass:B,SearchPlaceholder:L,onSubmit:U=v=>{v.preventDefault()},onReloadTable:x,perPageEntries:F=[10,50,100,200],onRowContextMenu:w,divStyle:Y,tableStyle:E,keyPageParam:R="page",keyPerPageParam:D="perPage",showPaginationEllipsis:$=!1,maxVisiblePages:p=5})=>{const{t:v}=me(),[Q,T]=i.useState([]),[M,f]=i.useState(""),b=pe(),h=(b==null?void 0:b[R])??"1",j=(b==null?void 0:b[D])??"10",[z,C]=i.useState({value:j,label:j}),[o,a]=I.useState({pageIndex:Number(h)-1,pageSize:Number(j)}),V=(s,t,u,N)=>{const P=ue(s.getValue(t),u);return N({itemRank:P}),P.passed},_=(s,t)=>{w&&w(s,t)},y=ie({columns:l,data:(n==null?void 0:n.data)??[],filterFns:{fuzzy:V},state:{columnFilters:Q,globalFilter:M,pagination:o},onColumnFiltersChange:T,onGlobalFilterChange:f,globalFilterFn:V,getCoreRowModel:ce(),getFilteredRowModel:oe(),manualPagination:!0,getSortedRowModel:re(),rowCount:(n==null?void 0:n.total)??0,onPaginationChange:s=>{if(x){const t=y.getState().pagination,u=typeof s=="function"?s(t):s;x(u.pageIndex+1,u.pageSize)}a(s)}}),{getHeaderGroups:A,getRowModel:W,getCanPreviousPage:xe,getCanNextPage:ee,getPageOptions:J,setPageIndex:se,nextPage:te,previousPage:ne,setPageSize:X,getState:q}=y;i.useEffect(()=>{Number(c)&&X(Number(c))},[c,X]);const K=()=>{const s=J().length,t=q().pagination.pageIndex;if(!$||s<=p)return J();const u=[],N=Math.floor((p-3)/2);u.push(0);let P=Math.max(1,t-N),le=Math.min(s-2,t+N);t<=N+1&&(le=Math.min(s-2,p-2)),t>=s-N-2&&(P=Math.max(1,s-p+1)),P>1&&u.push("ellipsis-start");for(let ae=P;ae<=le;ae++)u.push(ae);return le<s-2&&u.push("ellipsis-end"),s>1&&u.push(s-1),u};return i.useEffect(()=>{const s=()=>{a(t=>{const u=Number(h)-1,N=Number(j);return t.pageIndex!==u||t.pageSize!==N?{pageIndex:u,pageSize:N}:t}),C({value:j,label:j})};return window.addEventListener("popstate",s),s(),()=>{window.removeEventListener("popstate",s)}},[]),i.useEffect(()=>{a(s=>{const t=Number(h)-1,u=Number(j);return s.pageIndex!==t||s.pageSize!==u?{pageIndex:t,pageSize:u}:s}),C({value:j,label:j})},[n]),e.jsxs(i.Fragment,{children:[r&&e.jsx(S,{className:"mb-3",children:e.jsx(de.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:U,children:e.jsx(S,{children:e.jsx(Z,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(be,{value:M??"",onChange:s=>f(String(s)),placeholder:L}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:B,style:{...Y},children:e.jsxs(ge,{hover:!0,className:d,bordered:m,style:E,children:[e.jsx("thead",{className:`${g} sticky-top`,style:{zIndex:10,backgroundColor:"var(--bs-body-bg)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:A().map(s=>e.jsx("tr",{className:H,children:s.headers.map(t=>e.jsx("th",{className:`${O} ${t.column.getCanSort()?"sortable-header":""}`,style:{position:"sticky",top:0,zIndex:10,cursor:t.column.getCanSort()?"pointer":"default",userSelect:"none"},onClick:t.column.getToggleSortingHandler(),children:t.isPlaceholder?null:e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{children:G(t.column.columnDef.header,t.getContext())}),t.column.getCanSort()&&e.jsx("div",{className:"ms-1",children:t.column.getIsSorted()==="asc"?e.jsx("i",{className:"ri-arrow-up-s-line"}):t.column.getIsSorted()==="desc"?e.jsx("i",{className:"ri-arrow-down-s-line"}):e.jsx("i",{className:"ri-expand-up-down-line text-muted"})})]}),t.column.getCanFilter()?e.jsx("div",{children:e.jsx(Fe,{column:t.column,table:y})}):null]})},t.id))},s.id))}),e.jsx("tbody",{children:W().rows.map(s=>e.jsx("tr",{onContextMenu:t=>_(t,s.original),style:{cursor:w?"context-menu":"default"},children:s.getVisibleCells().map(t=>e.jsx("td",{children:G(t.column.columnDef.cell,t.getContext())},t.id))},s.id))})]})}),e.jsxs(S,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[v("Showing"),e.jsx("span",{className:"fw-semibold ms-1",children:W().rows.length})," ",v("on")," ",e.jsx("span",{className:"fw-semibold",children:(n==null?void 0:n.total)??0})," ",v("results")]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:xe()?"page-item":"page-item disabled",children:e.jsx(k,{className:"page-link",onClick:ne,variant:"link",children:"<"})}),K().map((s,t)=>e.jsx(I.Fragment,{children:typeof s=="string"?e.jsx("li",{className:"page-item disabled",children:e.jsx("span",{className:"page-link",children:"..."})}):e.jsx("li",{className:"page-item",children:e.jsx(k,{variant:"link",className:q().pagination.pageIndex===s?"page-link active":"page-link",onClick:()=>se(s),children:s+1})})},t)),e.jsx("li",{className:ee()?"page-item":"page-item disabled",children:e.jsx(k,{variant:"link",className:"page-link",onClick:te,children:">"})})]})}),e.jsx("div",{className:"col-lg-auto",children:e.jsx(he,{value:z,onChange:s=>{x&&x(1,s.value),a(t=>({...t,pageSize:s.value})),C(s)},options:F.map(s=>({value:s,label:s})),id:"choices-single-default",className:"js-example-basic-single mb-0",name:"state",menuPlacement:"auto"})})]})]})},Pe=({column:l})=>{const n=l.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(fe,{type:"text",value:n??"",onChange:r=>l.setFilterValue(r),placeholder:"Search...",className:"w-36 border shadow rounded",list:l.id+"list"}),e.jsx("div",{className:"h-1"})]})},fe=({value:l,onChange:n,debounce:r=500,...c})=>{const[m,d]=i.useState(l);return i.useEffect(()=>{d(l)},[l]),i.useEffect(()=>{const g=setTimeout(()=>{n(m)},r);return()=>clearTimeout(g)},[r,m]),e.jsx("input",{...c,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:g=>d(g.target.value)})},ke=({columns:l,data:n,isGlobalFilter:r,customPageSize:c,borderClass:m,tableClass:d,theadClass:g,trClass:H,thClass:O,divClass:B,SearchPlaceholder:L,onSubmit:U=p=>{p.preventDefault()},onReloadTable:x,perPageEntries:F=[10,50,100,200],onRowContextMenu:w,divStyle:Y,tableStyle:E,maxHeight:R="500px",keyPageParam:D="page",keyPerPageParam:$="perPage"})=>{const{t:p}=me(),[v,Q]=i.useState([]),[T,M]=i.useState(""),f=pe(),b=(f==null?void 0:f[D])??null,h=(f==null?void 0:f[$])??"10",[j,z]=i.useState({value:h,label:h}),[C,o]=I.useState({pageIndex:0,pageSize:Number(h)}),a=(s,t,u,N)=>{const P=ue(s.getValue(t),u);return N({itemRank:P}),P.passed},V=(s,t)=>{w&&w(s,t)},_=ie({columns:l,data:(n==null?void 0:n.data)??[],filterFns:{fuzzy:a},state:{columnFilters:v,globalFilter:T,pagination:C},onColumnFiltersChange:Q,onGlobalFilterChange:M,globalFilterFn:a,getCoreRowModel:ce(),getFilteredRowModel:oe(),manualPagination:!0,getSortedRowModel:re(),rowCount:-1,onPaginationChange:o}),{getHeaderGroups:y,getRowModel:A,setPageSize:W,getState:xe}=_;i.useEffect(()=>{Number(c)&&W(Number(c))},[c,W]);const ee=()=>{x&&(n!=null&&n.prev_cursor)&&x(n.prev_cursor,C.pageSize)},J=()=>{x&&(n!=null&&n.next_cursor)&&x(n.next_cursor,C.pageSize)},se=()=>{x&&x(null,C.pageSize)},te=s=>{x&&x(null,s.value),o(t=>({...t,pageSize:s.value})),z(s)};i.useEffect(()=>{const s=()=>{o(t=>{const u=Number(h);return t.pageSize!==u?{...t,pageSize:u}:t}),z({value:h,label:h})};return window.addEventListener("popstate",s),s(),()=>{window.removeEventListener("popstate",s)}},[h,b]),i.useEffect(()=>{o(s=>{const t=Number(h);return s.pageSize!==t?{...s,pageSize:t}:s}),z({value:h,label:h})},[n,h,b]);const ne=(n==null?void 0:n.data)&&n.data.length>0,X=(n==null?void 0:n.prev_cursor)!==null,q=(n==null?void 0:n.next_cursor)!==null,K=!b||b===null;return e.jsxs(i.Fragment,{children:[r&&e.jsx(S,{className:"mb-3",children:e.jsx(de.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:U,children:e.jsx(S,{children:e.jsx(Z,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(fe,{value:T??"",onChange:s=>M(String(s)),placeholder:L}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:B,style:{...Y,position:"relative",maxHeight:R,overflowY:"auto"},children:e.jsxs(ge,{hover:!0,className:d,bordered:m,style:E,children:[e.jsx("thead",{className:`${g} sticky-top`,style:{zIndex:10},children:y().map(s=>e.jsx("tr",{className:H,children:s.headers.map(t=>e.jsx("th",{className:`${O} ${t.column.getCanSort()?"sortable-header":""}`,style:{position:"sticky",top:0,zIndex:10,cursor:t.column.getCanSort()?"pointer":"default",userSelect:"none"},onClick:t.column.getToggleSortingHandler(),children:t.isPlaceholder?null:e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{children:G(t.column.columnDef.header,t.getContext())}),t.column.getCanSort()&&e.jsx("div",{className:"ms-1",children:t.column.getIsSorted()==="asc"?e.jsx("i",{className:"ri-arrow-up-s-line"}):t.column.getIsSorted()==="desc"?e.jsx("i",{className:"ri-arrow-down-s-line"}):e.jsx("i",{className:"ri-expand-up-down-line text-muted"})})]}),t.column.getCanFilter()?e.jsx("div",{children:e.jsx(Pe,{column:t.column,table:_})}):null]})},t.id))},s.id))}),e.jsx("tbody",{children:A().rows.map(s=>e.jsx("tr",{onContextMenu:t=>V(t,s.original),style:{cursor:w?"context-menu":"default"},children:s.getVisibleCells().map(t=>e.jsx("td",{children:G(t.column.columnDef.cell,t.getContext())},t.id))},s.id))})]})}),e.jsxs(S,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[p("Showing")," ",e.jsx("span",{className:"fw-semibold",children:A().rows.length})," ",p("results"),(n==null?void 0:n.per_page)&&e.jsxs("span",{children:[" (",n.per_page," ",p("per page"),")"]})]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:K?"page-item disabled":"page-item",children:e.jsx(k,{className:"page-link",onClick:se,variant:"link",disabled:K,title:p("Go to first page"),children:"<<"})}),e.jsx("li",{className:X?"page-item":"page-item disabled",children:e.jsx(k,{className:"page-link",onClick:ee,variant:"link",disabled:!X,title:p("Previous page"),children:"<"})}),e.jsx("li",{className:q?"page-item":"page-item disabled",children:e.jsx(k,{variant:"link",className:"page-link",onClick:J,disabled:!q,title:p("Next page"),children:">"})})]})}),e.jsx("div",{className:"col-lg-auto",children:e.jsx(he,{value:j,onChange:te,options:F.map(s=>({value:s,label:s})),id:"choices-single-default",className:"js-example-basic-single mb-0",name:"state",menuPlacement:"auto"})})]}),!ne&&e.jsx(S,{className:"mt-3",children:e.jsx(Z,{className:"text-center",children:e.jsx("div",{className:"text-muted",children:p("No data available")})})})]})},Ge=l=>{const n=Ne(),r=(c,m)=>{if(l.enableContextMenu&&l.contextMenuOptions&&n){c.preventDefault(),c.stopPropagation();const d=typeof l.contextMenuOptions=="function"?l.contextMenuOptions(m):l.contextMenuOptions;d&&d.length>0&&n.showContextMenu(d,m,{x:c.clientX,y:c.clientY},l.contextMenuConfig)}};return l!=null&&l.isPaginateTable?l!=null&&l.isCursorPaginateTable?e.jsx(ke,{...l,onRowContextMenu:r}):e.jsx(we,{...l,onRowContextMenu:r}):e.jsx(Se,{...l,onRowContextMenu:r})};export{Ge as T};
