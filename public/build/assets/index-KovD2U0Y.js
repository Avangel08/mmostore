import{X as G,f as W,d as o,j as e,R as X,S as J,e as T}from"./ContextMenuProvider-DCdb8j9t.js";import K from"./index-D2wZSptl.js";import Q from"./PageHeader-CFWDLgMr.js";import{u as U}from"./Navbar-CjAPrUK0.js";import Y from"./OrdersTable-BPNTi7q2.js";import{c as Z}from"./thunk-CnhdTyKr.js";import{u as ee}from"./useTranslation-BeBCG-tb.js";import{C as te}from"./Container-B-XzGzbE.js";import{R as I}from"./Row-DcrQzJSf.js";import{C as N}from"./Col-BKpEL2i4.js";import{I as se}from"./InputGroup-DeMyQ-IT.js";import{F as re}from"./Form-BwWb-AQG.js";import{B as p}from"./Button-DkR4lkD4.js";import{D as h}from"./Dropdown-D-szNC0L.js";import{M as y}from"./Modal-PiC5wIE_.js";import{T as ae}from"./Table-DAIgmh94.js";import{B as j}from"./Badge-TQK3wVRd.js";import"./react-toastify.esm-Bwsw1aoB.js";/* empty css                      */import"./LightDark-CrF8-1wK.js";import"./reselect-CiXCCDx7.js";import"./LayoutContext-ty_CWxqC.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./Footer-oIjyy4GS.js";import"./ThemeProvider-B2_W_dCu.js";import"./scrollspy-CUB9tACV.js";import"./useEventCallback-Blih2yEw.js";import"./NavbarContext-BDjdnqqL.js";import"./inherits-B2gPeQio.js";import"./index-BSRKPwsw.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-I41DMrFM.js";import"./index.esm-CC-SwQOh.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-Cl0fTsAK.js";import"./Collapse-DcrjWkI8.js";import"./TransitionWrapper-WlnnEX3_.js";import"./useMergedRefs-qO3RddUr.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./NavLink-C2m6UJ-U.js";import"./Anchor-BBr3tu3N.js";import"./useEventCallback-B3WkzC8o.js";import"./Button-DW89RreQ.js";import"./SelectableContext-BXVmDtUi.js";import"./DataKey-DjdvojM5.js";import"./TabContext-CQlkuOeg.js";import"./InputGroupContext-CSG2a_Xx.js";import"./querySelectorAll-BUF6GxAr.js";import"./SSRProvider-B7UJ9TZ1.js";import"./useIsomorphicEffect-DBZcWV3F.js";import"./useWindow-XMw1SZRE.js";import"./hook-D-Q4NZE6.js";import"./extends-CF3RwP-h.js";import"./useWillUnmount-ClVsaD3q.js";import"./AbstractModalHeader-BzQN1u3g.js";import"./hasClass-CFrhebZ5.js";import"./NoopTransition-DV-WmqrX.js";import"./CloseButton-DmCN2KAW.js";import"./Fade-_gEJg8B2.js";import"./divWithClassName-CMPxMdR0.js";const ie=()=>{const{t:s}=ee(),c=U(),{user:ne,orders:u}=G().props,v=W(),[L,b]=o.useState([]),[S,z]=o.useState(""),[D,ce]=o.useState("all"),[d,m]=o.useState(1),[g,x]=o.useState(10),[k,C]=o.useState(0),[B,w]=o.useState(!1),[M,R]=o.useState(""),[P,E]=o.useState([]),[f,F]=o.useState(""),_=async()=>{var t,r,a;try{const n=await T.get("/order",{params:{page:d,per_page:g,search:S,category:D},headers:{"X-Requested-With":"XMLHttpRequest"}});if(n.data&&n.data.orders){const i=n.data.orders.rows.map(l=>({order_number:l.order_number,purchased_at:l.purchased_at?new Date(l.purchased_at).toLocaleString("vi-VN"):"",product_title:l.product_title,quantity:l.quantity,unit_price:l.unit_price,total_price:l.total_price,status:l.status,notes:l.notes}));b(i),C(((t=n.data.orders.pagination)==null?void 0:t.total)||0),m(((r=n.data.orders.pagination)==null?void 0:r.current_page)||1),x(((a=n.data.orders.pagination)==null?void 0:a.per_page)||10)}}catch{}};o.useEffect(()=>{var t,r,a;if(u&&u.rows){const n=u.rows.map(i=>({order_number:i.order_number,purchased_at:i.purchased_at?new Date(i.purchased_at).toLocaleString("vi-VN"):"",product_title:i.product_title,quantity:i.quantity,unit_price:i.unit_price,total_price:i.total_price,status:i.status,notes:i.notes}));b(n),C(((t=u.pagination)==null?void 0:t.total)||0),m(((r=u.pagination)==null?void 0:r.current_page)||1),x(((a=u.pagination)==null?void 0:a.per_page)||10)}else b([]),C(0);c&&v(Z(c==null?void 0:c.theme))},[u,c,v]);const q=()=>{m(1),_()};o.useEffect(()=>{_()},[d,g,D]);const V=async t=>{w(!0),F(t);try{const r=await T.get(`/order/${t}`);if(r.data.success){const a=r.data.data||{};R(a.product_title||"");const n=Array.isArray(a.items)?a.items.map(i=>({product:i.key??"",value:i.data??""})):[];E(n)}}catch{E([])}},O=t=>{window.open(`/order/${t}/download`,"_blank")},$=t=>t.toLocaleString("vi-VN"),A=t=>{switch(t){case"COMPLETED":return e.jsx(j,{bg:"success",children:s("Completed")});case"PENDING":return e.jsx(j,{bg:"warning",children:s("Pending")});case"PROCESSING":return e.jsx(j,{bg:"info",children:s("Processing")});case"CANCELLED":return e.jsx(j,{bg:"danger",children:s("Cancelled")});case"FAILED":return e.jsx(j,{bg:"danger",children:s("Failed")});default:return e.jsx(j,{bg:"secondary",children:t})}},H=()=>{const t=[],r=Math.ceil(k/g);t.push(e.jsx(p,{variant:d===1?"primary":"outline-secondary",size:"sm",onClick:()=>m(1),className:"me-1",children:"1"},1));for(let a=2;a<=Math.min(5,r);a++)t.push(e.jsx(p,{variant:d===a?"primary":"outline-secondary",size:"sm",onClick:()=>m(a),className:"me-1",children:a},a));return r>5&&(t.push(e.jsx("span",{className:"me-1",children:"..."},"ellipsis")),t.push(e.jsx(p,{variant:"outline-secondary",size:"sm",onClick:()=>m(r),children:r},r))),t};return e.jsxs(X.Fragment,{children:[e.jsx(Q,{theme:c}),e.jsx(J,{title:`${s("Order history")} - ${(c==null?void 0:c.storeName)??""}`}),e.jsxs(te,{fluid:!0,className:"custom-container",children:[e.jsxs(I,{className:"mb-4 mt-4 align-items-center",children:[e.jsx(N,{md:6,children:e.jsx("h4",{className:"mb-0",style:{fontSize:"30px",fontWeight:"bold",color:"black"},children:s("Purchased order")})}),e.jsx(N,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("div",{className:"rounded-3 overflow-hidden border me-2",style:{width:"250px"},children:e.jsx(se,{children:e.jsx(re.Control,{type:"text",placeholder:s("Enter order number"),value:S,onChange:t=>z(t.target.value)})})}),e.jsx(p,{variant:"primary",onClick:q,className:"rounded-3",children:s("Filter")})]})})]}),e.jsx(Y,{ordersData:L,handleViewOrder:V,handleDownloadOrder:O,formatCurrency:$,getStatusBadge:A,fetchOrdersData:_,t:s}),e.jsxs(I,{className:"mt-3",children:[e.jsx(N,{md:6,children:e.jsx("p",{className:"text-muted mb-0"})}),e.jsx(N,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-end align-items-center",children:[e.jsx(p,{variant:"outline-secondary",size:"sm",className:"me-1",disabled:d===1,onClick:()=>m(d-1),children:e.jsx("i",{className:"ri-arrow-left-line"})}),H(),e.jsx(p,{variant:"outline-secondary",size:"sm",className:"ms-1",disabled:d===Math.ceil(k/g),onClick:()=>m(d+1),children:e.jsx("i",{className:"ri-arrow-right-line"})}),e.jsxs(h,{className:"ms-3",children:[e.jsxs(h.Toggle,{variant:"outline-secondary",size:"sm",children:["Show ",g]}),e.jsxs(h.Menu,{children:[e.jsx(h.Item,{onClick:()=>x(10),children:"10"}),e.jsx(h.Item,{onClick:()=>x(25),children:"25"}),e.jsx(h.Item,{onClick:()=>x(50),children:"50"}),e.jsx(h.Item,{onClick:()=>x(100),children:"100"})]})]})]})})]})]}),e.jsxs(y,{show:B,onHide:()=>w(!1),size:"xl",centered:!0,children:[e.jsx(y.Header,{closeButton:!0,children:e.jsxs(y.Title,{children:[s("Order")," ",f&&`#${f}`]})}),e.jsxs(y.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{className:"fw-semibold",children:[f,".txt"]}),e.jsx("div",{children:e.jsxs(p,{variant:"primary",size:"sm",onClick:()=>O(f),disabled:!f,children:[e.jsx("i",{className:"ri-download-line"})," ",s("Download")]})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs(ae,{className:"table align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:280},children:s("Product")}),e.jsx("th",{children:s("Value")})]})}),e.jsx("tbody",{children:P.length>0?P.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-truncate",style:{maxWidth:280},title:t.product,children:M}),e.jsx("td",{className:"text-break",style:{wordBreak:"break-all"},children:t.value})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"text-center text-muted py-4",children:s("No data")})})})]})})]}),e.jsx(y.Footer,{children:e.jsx(p,{variant:"secondary",onClick:()=>w(!1),children:s("Close")})})]})]})},oe=ie;oe.layout=s=>e.jsx(K,{children:s});export{oe as default};
