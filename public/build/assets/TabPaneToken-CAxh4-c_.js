import{X as E,d as j,j as e,A as y}from"./ContextMenuProvider-DoI9LuTu.js";import{s as r}from"./showToast-BFjkHmvN.js";import{c as P}from"./copyToClipboard-B5-eBniM.js";import{c as A}from"./sweetAlert-NpllgYUb.js";import{h as D}from"./moment-C5S46NFB.js";import{u as I}from"./useTranslation-Bh5zzBC_.js";import{T as Y}from"./Tab-dE3hgtSR.js";import{R as m}from"./Row-DaX0pFtU.js";import{C as d}from"./Col-BERnSmBs.js";import{F as a}from"./Form-C6Oq7frR.js";import{B as x}from"./Button-CdshqBqI.js";import"./react-toastify.esm-8BWsAHON.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./index-B7rcZTdA.js";import"./SSRProvider-CLk7drUW.js";import"./TabContext-CGmNngma.js";import"./SelectableContext-Cn0HZByE.js";import"./NoopTransition-Badst7zB.js";import"./useEventCallback-Bsoi2xyD.js";import"./TransitionWrapper-CRtjL7Sb.js";import"./useMergedRefs-Cm3LQ1VB.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Fade-iG7JUvQW.js";import"./ThemeProvider-CQKb4rSK.js";import"./Button-lElTeqs9.js";function ne(){const{t:s}=I(),i=E().props.token,f=(i==null?void 0:i.id)||null,p=(i==null?void 0:i.token_plain_text)||null,k=(i==null?void 0:i.created_at)||null,[u,N]=j.useState(!1),[h,b]=j.useState(!1),v=()=>{y.reload({replace:!0,only:["token"]})};j.useEffect(()=>{const t=setTimeout(()=>{v()},0);return()=>clearTimeout(t)},[]);const w=()=>{N(!u)},g=async()=>{if(!p){r(s("No token available to copy"),"error");return}if(!h){b(!0);try{await P(p)?r(s("Token copied"),"success"):r(s("Failed to copy token. Please try copy manually"),"error")}finally{setTimeout(()=>{b(!1)},1e3)}}},C=()=>{if(f){r(s("You already have a token. Please reload page to see your token"),"error");return}y.post(route("buyer.profile.create-token"),{},{onSuccess:t=>{var o,n,l,c;if((n=(o=t.props)==null?void 0:o.message)!=null&&n.error){r(s(t.props.message.error),"error");return}(c=(l=t.props)==null?void 0:l.message)!=null&&c.success&&(r(s(t.props.message.success),"success"),v())},onError:t=>{Object.keys(t).forEach(o=>{r(t[o],"error")})}})},S=async()=>{if(!f){r(s("No token available to delete"),"error");return}await A({title:s("Delete this token?"),text:s("Once deleted, you will not be able to recover it."),confirmButtonText:s("Delete now"),cancelButtonText:s("Cancel")})&&y.delete(route("buyer.profile.delete-token",f),{onSuccess:o=>{var n,l,c,T;if((l=(n=o.props)==null?void 0:n.message)!=null&&l.error){r(s(o.props.message.error),"error");return}(T=(c=o.props)==null?void 0:c.message)!=null&&T.success&&r(s(o.props.message.success),"success")},onError:o=>{Object.keys(o).forEach(n=>{r(o[n],"error")})}})};return e.jsx(Y.Pane,{eventKey:"token",children:e.jsx(m,{children:e.jsx(d,{lg:12,children:e.jsx("div",{className:"mb-3",children:p?e.jsxs("div",{children:[e.jsx("div",{className:"mb-3",children:e.jsx(a.Group,{as:m,children:e.jsx(d,{lg:12,children:e.jsx("div",{className:"mb-2 text-muted",children:e.jsx("small",{children:s("Use this token to authenticate API requests. Keep it secure and don't share it with others.")})})})})}),e.jsx("div",{className:"mb-3",children:e.jsxs(a.Group,{as:m,children:[e.jsxs(a.Label,{column:!0,lg:3,className:"fw-semibold",children:[s("Created date"),":"]}),e.jsx(d,{lg:9,children:e.jsx("div",{className:"form-control-plaintext",children:k?D(k).format("DD/MM/YYYY HH:mm"):s("Unknown")})})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs(a.Group,{as:m,children:[e.jsxs(a.Label,{column:!0,lg:3,className:"fw-semibold",children:[s("Token Value"),":"]}),e.jsx(d,{lg:9,children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("div",{className:"position-relative flex-grow-1",children:[e.jsx(a.Control,{type:u?"text":"password",className:"form-control pe-5",value:p,readOnly:!0,style:{fontFamily:"monospace"}}),e.jsx(x,{variant:"link",className:"position-absolute top-50 end-0 translate-middle-y border-0 bg-transparent text-muted pe-3",onClick:w,style:{zIndex:10,padding:"0.375rem 0.5rem"},title:s(u?"Hide token":"Show token"),children:e.jsx("i",{className:u?"ri-eye-off-line":"ri-eye-line"})})]}),e.jsx(x,{type:"button",variant:h?"outline-success":"outline-primary",onClick:g,disabled:h,style:{whiteSpace:"nowrap"},children:e.jsx("i",{className:`${h?"ri-check-line":"ri-file-copy-line"} me-1`})}),e.jsx(x,{type:"button",variant:"outline-danger",onClick:S,style:{whiteSpace:"nowrap"},children:e.jsx("i",{className:"ri-delete-bin-line me-1"})})]})})]})})]}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-3",children:e.jsx(a.Group,{as:m,children:e.jsx(d,{lg:9,children:e.jsx("div",{className:"form-control-plaintext text-muted",children:s("You don't have an API Token yet.")})})})}),e.jsx("div",{className:"hstack gap-2 justify-content-end",children:e.jsxs(x,{type:"button",variant:"primary",onClick:C,children:[e.jsx("i",{className:"ri-add-line me-1"}),s("Create API Token")]})})]})})})})})}export{ne as default};
