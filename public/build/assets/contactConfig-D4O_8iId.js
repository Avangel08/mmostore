import{X as A,A as D,j as t}from"./ContextMenuProvider-DK3oxQYr.js";import{u as O,c as E,d as P,a as I}from"./index.esm-BSLmOO6X.js";import{s as h}from"./showToast-CF18EvDS.js";import{u as R}from"./useTranslation-DPKXtvuf.js";import{F as x}from"./Form-BL_QAQYe.js";import{R as B}from"./Row-yXb5PzTN.js";import{C as b}from"./Col-CTtgbep0.js";import{D as v}from"./Dropdown-_eQxxY7W.js";import{B as C}from"./Button-CFXbok-i.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-CLORWFEJ.js";import"./react-toastify.esm-9xgEgjS9.js";import"./ThemeProvider-Ct_rgNLL.js";import"./index-DBORkYtJ.js";import"./querySelectorAll-DyAC2eix.js";import"./useMergedRefs-DpVwXFtQ.js";import"./SSRProvider-Bm_IBhbN.js";import"./useEventCallback-CkenMm09.js";import"./useIsomorphicEffect-DCEK52HO.js";import"./useWindow-C0YEyK7V.js";import"./SelectableContext-D5B5znED.js";import"./NavbarContext-6IejjhSq.js";import"./Button-V6sZ7J-q.js";import"./DataKey-DjdvojM5.js";import"./hook-CKvhJRCT.js";import"./extends-BFqQA52f.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./useEventCallback-vOopJezb.js";import"./Anchor-CwUEsFps.js";import"./InputGroupContext-baOa1g_u.js";const yt=()=>{const{t:l}=R(),{contact_types:m}=A().props,{settings:u}=A().props,e=O({enableReinitialize:!0,initialValues:{contacts:(u==null?void 0:u.contacts)||[{type:"",value:""}]},validationSchema:E({contacts:P().of(E({type:I().required("Please select contact type"),value:I().required("Please enter contact value")}))}),onSubmit:o=>{if(e.setFieldTouched("contacts",!0),o.contacts.forEach((a,n)=>{e.setFieldTouched(`contacts.${n}.type`,!0),e.setFieldTouched(`contacts.${n}.value`,!0)}),!e.isValid){setTimeout(()=>{const a=o.contacts.findIndex(c=>!c.type);if(a!==-1){const c=document.querySelector(`[data-contact-index="${a}"] .contact-dropdown-toggle`);if(c){c.focus();return}}const n=o.contacts.findIndex(c=>c.type&&!c.value);if(n!==-1){const c=document.querySelector(`[data-contact-index="${n}"] input[type="text"]`);if(c){c.focus();return}}const i=document.querySelector(".is-invalid");i&&i.focus()},100);return}const r=new FormData;r.append("contacts",JSON.stringify(o.contacts));const d=route("seller.theme-settings.update",{id:u.id});D.post(d,r,{preserveScroll:!0,onSuccess:a=>{var n,i,c,p;if((i=(n=a.props)==null?void 0:n.message)!=null&&i.error){h(l(a.props.message.error),"error");return}(p=(c=a.props)==null?void 0:c.message)!=null&&p.success?(h(l(a.props.message.success),"success"),e.resetForm()):h(l("Settings updated successfully"),"success")},onError:a=>{Object.keys(a).forEach(n=>{h(l(a[n]),"error")})}})}}),g=Array.isArray(m)?m:Object.values(m),V=o=>!m||typeof m!="object"?null:m[o]||null,_=()=>{const o=[...e.values.contacts,{type:"",value:""}];e.setFieldValue("contacts",o,!1)},q=o=>{const r=e.values.contacts.filter((d,a)=>a!==o);e.setFieldValue("contacts",r)},y=(o,r,d)=>{const a=[...e.values.contacts];a[o]={...a[o],[r]:d},e.setFieldValue("contacts",a),e.setFieldTouched(`contacts.${o}.${r}`,!1)};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
                    .contact-dropdown-toggle:focus,
                    .contact-dropdown-toggle:active,
                    .contact-dropdown-toggle.show {
                        background-color: white !important;
                        border-color: #ced4da !important;
                        color: #495057 !important;
                        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
                    }
                    .contact-dropdown-toggle:hover {
                        background-color: #f8f9fa !important;
                        border-color: #ced4da !important;
                        color: #495057 !important;
                    }
                    .contact-dropdown-toggle.is-invalid {
                        border-color: #dc3545 !important;
                    }
                    .contact-dropdown-toggle.is-invalid:focus {
                        border-color: #dc3545 !important;
                        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
                    }
                `}),t.jsxs(x,{noValidate:!0,onSubmit:e.handleSubmit,children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("h5",{className:"mb-2",children:[l("Contact"),t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx("p",{className:"text-muted fs-14 mb-3",children:l("Add your contact information for customers to reach you")}),t.jsxs("div",{className:"mb-3",children:[e.values.contacts.map((o,r)=>{var d,a,n,i,c,p,w,N;return t.jsxs(B,{className:"mb-2","data-contact-index":r,children:[t.jsxs(b,{md:3,children:[t.jsxs(v,{children:[t.jsx(v.Toggle,{variant:"outline-secondary",className:`w-100 d-flex align-items-center justify-content-between contact-dropdown-toggle ${!o.type&&e.touched.contacts||(d=e.errors.contacts)!=null&&d[r]&&typeof e.errors.contacts[r]=="object"&&((a=e.errors.contacts[r])!=null&&a.type)?"is-invalid":""}`,style:{height:"38px"},children:o.type?t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("i",{className:`${(n=g.find(s=>s.value===o.type))==null?void 0:n.icon} me-2`}),(i=g.find(s=>s.value===o.type))==null?void 0:i.label]}):t.jsx("span",{className:"text-muted",children:l("Select contact type")})}),t.jsx(v.Menu,{className:"w-100",children:g.map(s=>t.jsxs(v.Item,{onClick:()=>y(r,"type",s.value),className:"d-flex align-items-center",disabled:!!e.values.contacts.find(f=>f.type===s.value),children:[t.jsx("i",{className:`${s.icon} me-2`}),s.label]},s.value))})]}),!o.type&&e.touched.contacts&&t.jsx("div",{className:"invalid-feedback d-block",children:l("Please select contact type")})]}),t.jsxs(b,{md:8,children:[(()=>{var f,F,S,T,k,$;const s=V(o.type);return o.type&&s&&s.url_format?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"input-group",children:[t.jsx("span",{className:"input-group-text",style:{backgroundColor:"#f8f9fa",borderColor:"#ced4da",color:"#6c757d",fontSize:"14px",minWidth:"120px"},children:s.url_format}),t.jsx(x.Control,{type:"text",placeholder:s.placeholder||l("Enter contact information"),value:o.value,onChange:j=>y(r,"value",j.target.value),isInvalid:!!(o.type&&((F=(f=e.touched.contacts)==null?void 0:f[r])!=null&&F.value)&&((S=e.errors.contacts)!=null&&S[r]))})]})}):t.jsx(x.Control,{type:"text",placeholder:(s==null?void 0:s.placeholder)||l("Enter contact information"),value:o.value,onChange:j=>y(r,"value",j.target.value),isInvalid:!!(o.type&&((k=(T=e.touched.contacts)==null?void 0:T[r])!=null&&k.value)&&(($=e.errors.contacts)!=null&&$[r]))})})(),o.type&&((p=(c=e.touched.contacts)==null?void 0:c[r])==null?void 0:p.value)&&((w=e.errors.contacts)==null?void 0:w[r])&&t.jsx("div",{className:"invalid-feedback d-block",children:(N=e.errors.contacts[r])==null?void 0:N.value})]}),t.jsx(b,{xs:"auto",children:t.jsx(C,{variant:"danger",onClick:()=>q(r),disabled:e.values.contacts.length===1,children:t.jsx("i",{className:"ri-indeterminate-circle-line"})})})]},r)}),t.jsxs(C,{variant:"secondary",onClick:_,type:"button",children:[t.jsx("i",{className:"ri-add-circle-line"})," ",l("Add Contact")]})]})]}),t.jsx("div",{className:"text-start",children:t.jsx(C,{type:"submit",variant:"success",children:l("Update")})})]})]})};export{yt as default};
