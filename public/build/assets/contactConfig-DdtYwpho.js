import{X as A,A as O,j as t}from"./ContextMenuProvider-BhVN3MI2.js";import{u as P,c as E,d as R,a as I}from"./index.esm-C_ZlIYoE.js";import{s as h}from"./showToast-BKDwzp8a.js";import{u as B}from"./useTranslation-ZbZFIHja.js";import{F as x}from"./Form-B_1_SP-R.js";import{R as z}from"./Row-DTCryV-T.js";import{C as b}from"./Col-CDTbDU3W.js";import{D as v}from"./Dropdown-DAdvUZKT.js";import{B as C}from"./Button-CT1W-dlW.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-3lIPCjJv.js";import"./react-toastify.esm-Bzp-JuTX.js";import"./ThemeProvider-CUiVOj3n.js";import"./index-CMi1q9xw.js";import"./querySelectorAll-BZjzdW4C.js";import"./useMergedRefs-BdX62CzH.js";import"./SSRProvider-CdYR2PPq.js";import"./useEventCallback-kYw4fXYA.js";import"./useIsomorphicEffect-0xLopGc7.js";import"./useWindow-D06ww4p5.js";import"./SelectableContext-C5rX9-0C.js";import"./NavbarContext-DFScsAQa.js";import"./Button-ItoOpMhW.js";import"./DataKey-DjdvojM5.js";import"./hook-Dwnxsckw.js";import"./extends-CF3RwP-h.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./useEventCallback-DN7Xb1FR.js";import"./Anchor-Dcci9ZUU.js";import"./InputGroupContext-BOLuIn5_.js";const jt=({activeTab:V})=>{const{t:l}=B(),{contact_types:p}=A().props,{settings:u}=A().props,e=P({enableReinitialize:!0,initialValues:{contacts:(u==null?void 0:u.contacts)||[{type:"",value:""}]},validationSchema:E({contacts:R().of(E({type:I().required("Please select contact type"),value:I().required("Please enter contact value")}))}),onSubmit:o=>{if(e.setFieldTouched("contacts",!0),o.contacts.forEach((r,n)=>{e.setFieldTouched(`contacts.${n}.type`,!0),e.setFieldTouched(`contacts.${n}.value`,!0)}),!e.isValid){setTimeout(()=>{const r=o.contacts.findIndex(c=>!c.type);if(r!==-1){const c=document.querySelector(`[data-contact-index="${r}"] .contact-dropdown-toggle`);if(c){c.focus();return}}const n=o.contacts.findIndex(c=>c.type&&!c.value);if(n!==-1){const c=document.querySelector(`[data-contact-index="${n}"] input[type="text"]`);if(c){c.focus();return}}const i=document.querySelector(".is-invalid");i&&i.focus()},100);return}const a=new FormData;a.append("contacts",JSON.stringify(o.contacts)),a.append("tab",V);const d=route("seller.theme-settings.update",{id:u.id});O.post(d,a,{preserveScroll:!0,onSuccess:r=>{var n,i,c,m;if((i=(n=r.props)==null?void 0:n.message)!=null&&i.error){h(l(r.props.message.error),"error");return}(m=(c=r.props)==null?void 0:c.message)!=null&&m.success?(h(l(r.props.message.success),"success"),e.resetForm()):h(l("Settings updated successfully"),"success")},onError:r=>{Object.keys(r).forEach(n=>{h(l(r[n]),"error")})}})}}),g=Array.isArray(p)?p:Object.values(p),_=o=>!p||typeof p!="object"?null:p[o]||null,q=()=>{const o=[...e.values.contacts,{type:"",value:""}];e.setFieldValue("contacts",o,!1)},D=o=>{const a=e.values.contacts.filter((d,r)=>r!==o);e.setFieldValue("contacts",a)},y=(o,a,d)=>{const r=[...e.values.contacts];r[o]={...r[o],[a]:d},e.setFieldValue("contacts",r),e.setFieldTouched(`contacts.${o}.${a}`,!1)};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
                    .contact-dropdown-toggle:focus,
                    .contact-dropdown-toggle:active,
                    .contact-dropdown-toggle.show {
                        background-color: white !important;
                        border-color: #ced4da !important;
                        color: #495057 !important;
                        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
                    }
                    .contact-dropdown-toggle:hover {
                        background-color: #f8f9fa !important;
                        border-color: #ced4da !important;
                        color: #495057 !important;
                    }
                    .contact-dropdown-toggle.is-invalid {
                        border-color: #dc3545 !important;
                    }
                    .contact-dropdown-toggle.is-invalid:focus {
                        border-color: #dc3545 !important;
                        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
                    }
                `}),t.jsxs(x,{noValidate:!0,onSubmit:e.handleSubmit,children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("h5",{className:"mb-2",children:[l("Contact"),t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx("p",{className:"text-muted fs-14 mb-3",children:l("Add your contact information for customers to reach you")}),t.jsxs("div",{className:"mb-3",children:[e.values.contacts.map((o,a)=>{var d,r,n,i,c,m,w,N;return t.jsxs(z,{className:"mb-2","data-contact-index":a,children:[t.jsxs(b,{md:3,children:[t.jsxs(v,{children:[t.jsx(v.Toggle,{variant:"outline-secondary",className:`w-100 d-flex align-items-center justify-content-between contact-dropdown-toggle ${!o.type&&e.touched.contacts||(d=e.errors.contacts)!=null&&d[a]&&typeof e.errors.contacts[a]=="object"&&((r=e.errors.contacts[a])!=null&&r.type)?"is-invalid":""}`,style:{height:"38px"},children:o.type?t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("i",{className:`${(n=g.find(s=>s.value===o.type))==null?void 0:n.icon} me-2`}),(i=g.find(s=>s.value===o.type))==null?void 0:i.label]}):t.jsx("span",{className:"text-muted",children:l("Select contact type")})}),t.jsx(v.Menu,{className:"w-100",children:g.map(s=>t.jsxs(v.Item,{onClick:()=>y(a,"type",s.value),className:"d-flex align-items-center",disabled:!!e.values.contacts.find(f=>f.type===s.value),children:[t.jsx("i",{className:`${s.icon} me-2`}),s.label]},s.value))})]}),!o.type&&e.touched.contacts&&t.jsx("div",{className:"invalid-feedback d-block",children:l("Please select contact type")})]}),t.jsxs(b,{md:8,children:[(()=>{var f,F,S,T,k,$;const s=_(o.type);return o.type&&s&&s.url_format?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"input-group",children:[t.jsx("span",{className:"input-group-text",style:{backgroundColor:"#f8f9fa",borderColor:"#ced4da",color:"#6c757d",fontSize:"14px",minWidth:"120px"},children:s.url_format}),t.jsx(x.Control,{type:"text",placeholder:s.placeholder||l("Enter contact information"),value:o.value,onChange:j=>y(a,"value",j.target.value),isInvalid:!!(o.type&&((F=(f=e.touched.contacts)==null?void 0:f[a])!=null&&F.value)&&((S=e.errors.contacts)!=null&&S[a]))})]})}):t.jsx(x.Control,{type:"text",placeholder:(s==null?void 0:s.placeholder)||l("Enter contact information"),value:o.value,onChange:j=>y(a,"value",j.target.value),isInvalid:!!(o.type&&((k=(T=e.touched.contacts)==null?void 0:T[a])!=null&&k.value)&&(($=e.errors.contacts)!=null&&$[a]))})})(),o.type&&((m=(c=e.touched.contacts)==null?void 0:c[a])==null?void 0:m.value)&&((w=e.errors.contacts)==null?void 0:w[a])&&t.jsx("div",{className:"invalid-feedback d-block",children:(N=e.errors.contacts[a])==null?void 0:N.value})]}),t.jsx(b,{xs:"auto",children:t.jsx(C,{variant:"danger",onClick:()=>D(a),disabled:e.values.contacts.length===1,children:t.jsx("i",{className:"ri-indeterminate-circle-line"})})})]},a)}),t.jsxs(C,{variant:"secondary",onClick:q,type:"button",children:[t.jsx("i",{className:"ri-add-circle-line"})," ",l("Add Contact")]})]})]}),t.jsx("div",{className:"text-start",children:t.jsx(C,{type:"submit",variant:"success",children:l("Update")})})]})]})};export{jt as default};
