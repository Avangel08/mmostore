import{X as A,A as D,j as t}from"./ContextMenuProvider-1cB75p-p.js";import{u as O,c as E,d as P,a as I}from"./index.esm-AjD9Q23E.js";import{s as f}from"./showToast-BmC33B7c.js";import{u as R}from"./useTranslation-C7Yq1257.js";import{F as j}from"./Form-vqhQI7d8.js";import{R as B}from"./Row-Cp0Qg_e-.js";import{C as x}from"./Col-D0392pNZ.js";import{D as h}from"./Dropdown-DbfyrjbA.js";import{B as b}from"./Button-DzpAM0nN.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-DfFFbtXD.js";import"./react-toastify.esm-CMP2010h.js";import"./ThemeProvider-CK0LS3qr.js";import"./index-hS6bo2zO.js";import"./querySelectorAll-CqHIJ078.js";import"./useMergedRefs-CMrknats.js";import"./SSRProvider-CvsQASJI.js";import"./useEventCallback-BCgLfiDM.js";import"./useIsomorphicEffect-B4y2oaWF.js";import"./useWindow-CZaNFBD5.js";import"./SelectableContext-BEvhv38Q.js";import"./NavbarContext-2E9S59ud.js";import"./Button-BmeryA7r.js";import"./DataKey-DjdvojM5.js";import"./hook-BU9VZj-J.js";import"./extends-CF3RwP-h.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./useEventCallback-DraKR6BF.js";import"./Anchor-B2knYez4.js";import"./InputGroupContext-DjmFhsg1.js";const yt=()=>{const{t:l}=R(),{contact_types:m}=A().props,{settings:u}=A().props,e=O({enableReinitialize:!0,initialValues:{contacts:(u==null?void 0:u.contacts)||[{type:"",value:""}]},validationSchema:E({contacts:P().of(E({type:I().required("Please select contact type"),value:I().required("Please enter contact value")}))}),onSubmit:o=>{if(e.setFieldTouched("contacts",!0),o.contacts.forEach((a,n)=>{e.setFieldTouched(`contacts.${n}.type`,!0),e.setFieldTouched(`contacts.${n}.value`,!0)}),!e.isValid){setTimeout(()=>{const a=o.contacts.findIndex(s=>!s.type);if(a!==-1){const s=document.querySelector(`[data-contact-index="${a}"] .contact-dropdown-toggle`);if(s){s.focus();return}}const n=o.contacts.findIndex(s=>s.type&&!s.value);if(n!==-1){const s=document.querySelector(`[data-contact-index="${n}"] input[type="text"]`);if(s){s.focus();return}}const i=document.querySelector(".is-invalid");i&&i.focus()},100);return}const r=new FormData;r.append("contacts",JSON.stringify(o.contacts));const d=route("seller.theme-settings.update",{id:u.id});D.post(d,r,{preserveScroll:!0,onSuccess:a=>{var n,i,s,p;if((i=(n=a.props)==null?void 0:n.message)!=null&&i.error){f(l(a.props.message.error),"error");return}(p=(s=a.props)==null?void 0:s.message)!=null&&p.success?(f(l(a.props.message.success),"success"),e.resetForm()):f(l("Settings updated successfully"),"success")},onError:a=>{Object.keys(a).forEach(n=>{f(l(a[n]),"error")})}})}}),v=Array.isArray(m)?m:Object.values(m),V=o=>!m||typeof m!="object"?null:m[o]||null,_=()=>{const o=[...e.values.contacts,{type:"",value:""}];e.setFieldValue("contacts",o)},q=o=>{const r=e.values.contacts.filter((d,a)=>a!==o);e.setFieldValue("contacts",r)},g=(o,r,d)=>{const a=[...e.values.contacts];a[o]={...a[o],[r]:d},e.setFieldValue("contacts",a),e.setFieldTouched(`contacts.${o}.${r}`,!0)};return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:`
                    .contact-dropdown-toggle:focus,
                    .contact-dropdown-toggle:active,
                    .contact-dropdown-toggle.show {
                        background-color: white !important;
                        border-color: #ced4da !important;
                        color: #495057 !important;
                        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
                    }
                    .contact-dropdown-toggle:hover {
                        background-color: #f8f9fa !important;
                        border-color: #ced4da !important;
                        color: #495057 !important;
                    }
                    .contact-dropdown-toggle.is-invalid {
                        border-color: #dc3545 !important;
                    }
                    .contact-dropdown-toggle.is-invalid:focus {
                        border-color: #dc3545 !important;
                        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
                    }
                `}),t.jsxs(j,{noValidate:!0,onSubmit:e.handleSubmit,children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("h5",{className:"mb-2",children:[l("Contact"),t.jsx("span",{className:"text-danger",children:"*"})]}),t.jsx("p",{className:"text-muted fs-14 mb-3",children:l("Add your contact information for customers to reach you")}),t.jsxs("div",{className:"mb-3",children:[e.values.contacts.map((o,r)=>{var d,a,n,i,s,p,C,w;return t.jsxs(B,{className:"mb-2","data-contact-index":r,children:[t.jsxs(x,{md:3,children:[t.jsxs(h,{children:[t.jsx(h.Toggle,{variant:"outline-secondary",className:`w-100 d-flex align-items-center justify-content-between contact-dropdown-toggle ${!o.type&&e.touched.contacts||(d=e.errors.contacts)!=null&&d[r]&&typeof e.errors.contacts[r]=="object"&&((a=e.errors.contacts[r])!=null&&a.type)?"is-invalid":""}`,style:{height:"38px"},children:o.type?t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("i",{className:`${(n=v.find(c=>c.value===o.type))==null?void 0:n.icon} me-2`}),(i=v.find(c=>c.value===o.type))==null?void 0:i.label]}):t.jsx("span",{className:"text-muted",children:l("Select contact type")})}),t.jsx(h.Menu,{className:"w-100",children:v.map(c=>t.jsxs(h.Item,{onClick:()=>g(r,"type",c.value),className:"d-flex align-items-center",children:[t.jsx("i",{className:`${c.icon} me-2`}),c.label]},c.value))})]}),!o.type&&e.touched.contacts&&t.jsx("div",{className:"invalid-feedback d-block",children:l("Please select contact type")})]}),t.jsxs(x,{md:8,children:[(()=>{var N,F,S,T,k,$;const c=V(o.type);return o.type&&c&&c.url_format?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"input-group",children:[t.jsx("span",{className:"input-group-text",style:{backgroundColor:"#f8f9fa",borderColor:"#ced4da",color:"#6c757d",fontSize:"14px",minWidth:"120px"},children:c.url_format}),t.jsx(j.Control,{type:"text",placeholder:c.placeholder||l("Enter contact information"),value:o.value,onChange:y=>g(r,"value",y.target.value),isInvalid:!!(o.type&&((F=(N=e.touched.contacts)==null?void 0:N[r])!=null&&F.value)&&((S=e.errors.contacts)!=null&&S[r]))})]})}):t.jsx(j.Control,{type:"text",placeholder:(c==null?void 0:c.placeholder)||l("Enter contact information"),value:o.value,onChange:y=>g(r,"value",y.target.value),isInvalid:!!(o.type&&((k=(T=e.touched.contacts)==null?void 0:T[r])!=null&&k.value)&&(($=e.errors.contacts)!=null&&$[r]))})})(),o.type&&((p=(s=e.touched.contacts)==null?void 0:s[r])==null?void 0:p.value)&&((C=e.errors.contacts)==null?void 0:C[r])&&t.jsx("div",{className:"invalid-feedback d-block",children:(w=e.errors.contacts[r])==null?void 0:w.value})]}),t.jsx(x,{xs:"auto",children:t.jsx(b,{variant:"danger",onClick:()=>q(r),disabled:e.values.contacts.length===1,children:t.jsx("i",{className:"ri-indeterminate-circle-line"})})})]},r)}),t.jsxs(b,{variant:"secondary",onClick:_,type:"button",children:[t.jsx("i",{className:"ri-add-circle-line"})," ",l("Add Contact")]})]})]}),t.jsx("div",{className:"text-start",children:t.jsx(b,{type:"submit",variant:"success",children:l("Update")})})]})]})};export{yt as default};
