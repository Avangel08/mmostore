import{b3 as _,b4 as $,b5 as J,b6 as W,a as Z,u as X,r as o,j as e,R as ee}from"./app-fd4t7no8.js";import{T as te}from"./TableContainer-BM2WXmQp.js";import{TicketsId as se,Title as le,Client as ae,AssignedTo as re,CreateDate as ie,DueDate as oe,Status as ce,Priority as ne}from"./TicketCol-D76NFzUm.js";import{F as B}from"./index-BiBx5cRw.js";import{h as E}from"./moment-C5S46NFB.js";import{l as de}from"./lodash-aAEFdakn.js";import{u as me,c as ue,a as m}from"./index.esm-Cmb7X2Dd.js";import{D as I}from"./DeleteModal-C73qEGJK.js";import{B as u,Q as he}from"./ReactToastify-B_Anscjr.js";import{L as pe}from"./Loader-Ct0YabFq.js";import{c as xe}from"./reselect-CiXCCDx7.js";import"./calender-BnoOcmFC.js";import{t as fe}from"./supportTickets-CeVxNO1Y.js";import{F as r}from"./Form-CsjSNuHb.js";import{D as p}from"./Dropdown-efEmyPci.js";import{R as w}from"./Row-BuCXUTX8.js";import{C as n}from"./Col-7scarjyv.js";import{C as F}from"./Card-BXRTpShH.js";import{M as S}from"./Modal-BqkW0FaX.js";import"./index-DO-pdKaq.js";import"./react-select.esm-CPB9gOgH.js";import"./extends-MDuutsTJ.js";import"./setPrototypeOf-DgZC2w_0.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./extends-CF3RwP-h.js";import"./hoist-non-react-statics.cjs-dtX2lZ_p.js";import"./Button-B4tXbzRF.js";import"./ThemeProvider-B_9wk00B.js";import"./Button-86-2XGvn.js";import"./useTranslation-KyoNfcy9.js";import"./Table-B7gytYBk.js";import"./index-Dl_sAyqM.js";import"./isSymbol-qHNDJudD.js";import"./Spinner-678t2i5n.js";import"./ltc-BjMPbQSH.js";import"./dash-TnNMg90k.js";import"./img-1-Jhxup-Mz.js";import"./img-2-BKxLD3CN.js";import"./img-3-B4j7qXDU.js";import"./img-6-B4dmEj4y.js";import"./ElementChildren-9Eof15LD.js";import"./querySelectorAll-Cwpyv69p.js";import"./useMergedRefs-F_CleFMV.js";import"./SSRProvider-DC8WdQng.js";import"./usePrevious-WCz2UM3y.js";import"./useForceUpdate-DmW_SqQZ.js";import"./useEventCallback-CTqJZIWn.js";import"./mergeOptionsWithPopperConfig-CvoStc6P.js";import"./useWindow-D0Z8p2ql.js";import"./NavContext-DKLQoxMT.js";import"./DataKey-DjdvojM5.js";import"./hook-DtINLY6x.js";import"./useEventCallback-CiqWgYQB.js";import"./Anchor-DcFaUJxa.js";import"./useIsomorphicEffect-DNxiiWKR.js";import"./InputGroupContext-BDCQuM-G.js";import"./NavbarContext-D7bvf9E_.js";import"./CardHeaderContext-XyWR7fBw.js";import"./divWithClassName-BmE2s6GC.js";import"./useWillUnmount-DQzmu3H0.js";import"./TransitionWrapper-CD7mok4d.js";import"./AbstractModalHeader-DclvhUmC.js";import"./hasClass-0hhgA0sG.js";import"./useMergedRefs-CTh8buMQ.js";import"./NoopTransition-ClXI9N_X.js";import"./utils-D2GgX5jC.js";import"./CloseButton-CJMAsNxO.js";import"./Fade-DeWujXmH.js";const ke=()=>async i=>{try{i(_(fe))}catch(c){return c}},je=i=>async c=>{try{c(W(i)),u.success("Ticket Added Successfully",{autoClose:3e3})}catch(d){return u.error("Ticket Added Failed",{autoClose:3e3}),d}},L=i=>async c=>{try{c($(i)),u.success("Ticket Delete Successfully",{autoClose:3e3})}catch(d){return u.error("Ticket Delete Failed",{autoClose:3e3}),d}},be=i=>async c=>{try{c(J(i)),u.success("Ticket Updated Successfully",{autoClose:3e3})}catch(d){return u.error("Ticket Updated Failed",{autoClose:3e3}),d}},At=()=>{const i=Z(),d=xe(t=>t.Tickets,t=>({ticketsList:t.ticketsList,isTicketSuccess:t.isTicketSuccess,error:t.error})),{ticketsList:x,isTicketSuccess:ge,error:A}=X(d),[j,k]=o.useState(!1),[l,h]=o.useState([]),[b,P]=o.useState([]),[Y,g]=o.useState(!1),[q,C]=o.useState(!1),[D,y]=o.useState(!1),f=o.useCallback(()=>{D?(y(!1),h("")):(y(!0),h(""))},[D]),s=me({enableReinitialize:!0,initialValues:{id:l&&l.id||"",ticketId:l&&l.ticketId||"",title:l&&l.title||"",client:l&&l.client||"",assigned:l&&l.assigned||"",createDate:l&&l.createDate||"",dueDate:l&&l.dueDate||"",status:l&&l.status||"",priority:l&&l.priority||""},validationSchema:ue({title:m().required("Please Enter Title"),client:m().required("Please Enter Client Name"),assigned:m().required("Please Enter Assigned Name"),createDate:m().required("Please Enter Date"),dueDate:m().required("Please Enter Date"),status:m().required("Please Enter Your Joining status"),priority:m().required("Please Enter Your Priority")}),onSubmit:t=>{if(j){const a={id:l?l.id:0,ticketId:t.ticketId,title:t.title,client:t.client,assigned:t.assigned,createDate:t.createDate,dueDate:t.dueDate,status:t.status,priority:t.priority};i(be(a)),s.resetForm()}else{const a={id:(Math.floor(Math.random()*10)+20).toString(),ticketId:"#VLZ4"+(Math.floor(Math.random()*10)+20).toString(),title:t.title,client:t.client,assigned:t.assigned,createDate:t.createDate,dueDate:t.dueDate,status:t.status,priority:t.priority};i(je(a)),s.resetForm()}f()}}),K=t=>{h(t),g(!0)},R=()=>{l&&(i(L(l.id)),g(!1))},V=t=>{const a=t;h({id:a.id,ticketId:a.ticketId,title:a.title,client:a.client,assigned:a.assigned,createDate:a.createDate,dueDate:a.dueDate,status:a.status,priority:a.priority}),k(!0),y(!0)};o.useEffect(()=>{i(ke())},[i]),o.useEffect(()=>{P(x)},[x]),o.useEffect(()=>{de.isEmpty(x)||(h(x),k(!1))},[x]);const H=()=>{h(""),k(!1),f()},M=o.useCallback(()=>{const t=document.getElementById("checkBoxAll"),a=document.querySelectorAll(".ticketCheckBox");t.checked?a.forEach(T=>{T.checked=!0}):a.forEach(T=>{T.checked=!1}),v()},[]),[z,O]=o.useState([]),[U,N]=o.useState(!1),G=()=>{const t=document.getElementById("checkBoxAll");z.forEach(a=>{i(L(a.value)),setTimeout(()=>{u.clearWaitingQueue()},3e3)}),N(!1),t.checked=!1},v=()=>{const t=document.querySelectorAll(".ticketCheckBox:checked");t.length>0?N(!0):N(!1),O(t)},Q=o.useMemo(()=>[{header:e.jsx(r.Check.Input,{type:"checkbox",id:"checkBoxAll",className:"form-check-input",onClick:()=>M()}),cell:t=>e.jsx(r.Check.Input,{type:"checkbox",className:"ticketCheckBox form-check-input",value:t.getValue(),onChange:()=>v()}),id:"#"},{header:"ID",accessorKey:"ticketId",enableColumnFilter:!1,cell:t=>e.jsx(se,{...t})},{header:"Title",accessorKey:"title",enableColumnFilter:!1,cell:t=>e.jsx(le,{...t})},{header:"Client",accessorKey:"client",enableColumnFilter:!1,cell:t=>e.jsx(ae,{...t})},{header:"Assigned To",accessorKey:"assigned",enableColumnFilter:!1,cell:t=>e.jsx(re,{...t})},{header:"Create Date",accessorKey:"createDate",enableColumnFilter:!1,cell:t=>e.jsx(ie,{...t})},{header:"Due Date",accessorKey:"dueDate",enableColumnFilter:!1,cell:t=>e.jsx(oe,{...t})},{header:"Status",accessorKey:"status",enableColumnFilter:!1,cell:t=>e.jsx(ce,{...t})},{header:"Priority",accessorKey:"priority",enableColumnFilter:!1,cell:t=>e.jsx(ne,{...t})},{header:"Actions",cell:t=>e.jsxs(p,{children:[e.jsx(p.Toggle,{as:"a",className:"btn btn-soft-secondary btn-sm arrow-none",children:e.jsx("i",{className:"ri-more-fill align-middle"})}),e.jsxs(p.Menu,{className:"dropdown-menu-end",children:[e.jsx("li",{children:e.jsxs(p.Item,{href:"/apps-tickets-details",children:[e.jsx("i",{className:"ri-eye-fill align-bottom me-2 text-muted"})," View"]})}),e.jsx("li",{children:e.jsxs(p.Item,{className:"edit-item-btn",href:"#showModal","data-bs-toggle":"modal",onClick:()=>{const a=t.row.original;V(a)},children:[e.jsx("i",{className:"ri-pencil-fill align-bottom me-2 text-muted"})," Edit"]})}),e.jsx("li",{children:e.jsxs(p.Item,{className:"remove-item-btn","data-bs-toggle":"modal",href:"#deleteOrder",onClick:()=>{const a=t.row.original;K(a)},children:[e.jsx("i",{className:"ri-delete-bin-fill align-bottom me-2 text-muted"})," Delete"]})})]})]})}],[M]);return e.jsxs(ee.Fragment,{children:[e.jsxs(w,{children:[e.jsx(I,{show:Y,onDeleteClick:R,onCloseClick:()=>g(!1)}),e.jsx(I,{show:q,onDeleteClick:()=>{G(),C(!1)},onCloseClick:()=>C(!1)}),e.jsx(n,{lg:12,children:e.jsxs(F,{children:[e.jsx(F.Header,{className:"border-0",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("h5",{className:"card-title mb-0 flex-grow-1",children:"Tickets"}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsxs("button",{className:"btn btn-primary add-btn",onClick:()=>{k(!1),f()},children:[e.jsx("i",{className:"ri-add-line align-bottom"})," Create Tickets"]})," ",U&&e.jsx("button",{className:"btn btn-soft-danger",onClick:()=>C(!0),children:e.jsx("i",{className:"ri-delete-bin-2-line"})})]})})]})}),e.jsxs(F.Body,{className:"pt-0",children:[b&&b.length>0?e.jsx(te,{columns:Q,data:b||[],isGlobalFilter:!0,customPageSize:8,divClass:"table-responsive table-card mb-3",tableClass:"align-middle table-nowrap mb-0",theadClass:"",thClass:"",handleTicketClick:H,isTicketsListFilter:!0,SearchPlaceholder:"Search for ticket details or something..."}):e.jsx(pe,{className:"flex-grow-1 ms-2",error:A}),e.jsx(he,{closeButton:!1,limit:1})]})]})})]}),e.jsxs(S,{show:D,onHide:f,centered:!0,size:"lg",className:"border-0",dialogClassName:"zoomIn",children:[e.jsx(S.Header,{className:"p-3 bg-info-subtle",closeButton:!0,children:e.jsx("h5",{className:"modal-title",children:j?"Edit Ticket":"Add Ticket"})}),e.jsxs(r,{className:"tablelist-form",onSubmit:t=>(t.preventDefault(),s.handleSubmit(),!1),children:[e.jsx(S.Body,{children:e.jsxs(w,{className:"g-3",children:[e.jsx(n,{lg:12,children:e.jsxs("div",{children:[e.jsx(r.Label,{htmlFor:"tasksTitle-field",className:"form-label",children:"Title"}),e.jsx(r.Control,{name:"title",id:"tasksTitle-field",className:"form-control",placeholder:"Enter Title",type:"text",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.title||""}),s.touched.title&&s.errors.title?e.jsx(r.Control.Feedback,{type:"invalid",children:s.errors.title}):null]})}),e.jsx(n,{lg:6,children:e.jsxs("div",{children:[e.jsx(r.Label,{htmlFor:"client_nameName-field",className:"form-label",children:"Client"}),e.jsx(r.Control,{name:"client",type:"text",id:"client_nameName-field",placeholder:"Enter Client Name",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.client||""}),s.touched.client&&s.errors.client?e.jsx(r.Control.Feedback,{type:"invalid",children:s.errors.client}):null]})}),e.jsx(n,{lg:6,children:e.jsxs("div",{children:[e.jsx(r.Label,{htmlFor:"assignedtoName-field",className:"form-label",children:"Assigned To"}),e.jsx(r.Control,{name:"assigned",type:"text",id:"assignedtoName-field",placeholder:"Enter Assigned Name",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.assigned||""}),s.touched.assigned&&s.errors.assigned?e.jsx(r.Control.Feedback,{type:"invalid",children:s.errors.assigned}):null]})}),e.jsxs(n,{lg:6,children:[e.jsx(r.Label,{htmlFor:"date-field",className:"form-label",children:"Create Date"}),e.jsx(B,{name:"createDate",id:"date-field",className:"form-control",placeholder:"Select a date",options:{altInput:!0,altFormat:"d M, Y",dateFormat:"d M, Y"},onChange:t=>s.setFieldValue("createDate",E(t[0]).format("DD MMMM ,YYYY")),value:s.values.createDate||""}),s.errors.createDate&&s.touched.createDate?e.jsx(r.Control.Feedback,{type:"invalid",className:"d-block",children:s.errors.createDate}):null]}),e.jsxs(n,{lg:6,children:[e.jsx(r.Label,{htmlFor:"duedate-field",className:"form-label",children:"Due Date"}),e.jsx(B,{name:"dueDate",id:"date-field",className:"form-control",placeholder:"Select a date",options:{altInput:!0,altFormat:"d M, Y",dateFormat:"d M, Y"},onChange:t=>s.setFieldValue("dueDate",E(t[0]).format("DD MMMM ,YYYY")),value:s.values.dueDate||""}),s.errors.dueDate&&s.touched.dueDate?e.jsx(r.Control.Feedback,{type:"invalid",className:"d-block",children:s.errors.dueDate}):null]}),e.jsxs(n,{lg:6,children:[e.jsx(r.Label,{htmlFor:"ticket-status",className:"form-label",children:"Status"}),e.jsxs("select",{name:"status",className:"form-select",id:"status-field",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.status||"",children:[e.jsx("option",{value:"",children:"Status"}),e.jsx("option",{value:"New",children:"New"}),e.jsx("option",{value:"Inprogress",children:"Inprogress"}),e.jsx("option",{value:"Closed",children:"Closed"}),e.jsx("option",{value:"Open",children:"Open"})]}),s.touched.status&&s.errors.status?e.jsx(r.Control.Feedback,{type:"invalid",children:s.errors.status}):null]}),e.jsxs(n,{lg:6,children:[e.jsx(r.Label,{htmlFor:"priority-field",className:"form-label",children:"Priority"}),e.jsxs("select",{name:"priority",className:"form-select",id:"priority-field",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.priority||"",children:[e.jsx("option",{value:"",children:"Priority"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),s.touched.priority&&s.errors.priority?e.jsx(r.Control.Feedback,{type:"invalid",children:s.errors.priority}):null]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsxs("div",{className:"hstack gap-2 justify-content-end",children:[e.jsx("button",{onClick:f,type:"button",className:"btn btn-light",children:"Close"}),e.jsx("button",{type:"submit",className:"btn btn-success",id:"add-btn",children:j?"Update":"Add Ticket"})]})})]})]})]})};export{At as default};
