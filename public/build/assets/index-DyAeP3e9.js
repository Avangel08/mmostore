import{X as G,f as W,d as n,j as e,R as X,S as J,e as T}from"./ContextMenuProvider-Bgjy8Wg_.js";import K from"./index-DPmTzM5y.js";import Q from"./PageHeader-EDQ60B6o.js";import{u as U}from"./Navbar-DM0KOeMO.js";import Y from"./OrdersTable-CV-AtKEp.js";import{c as Z}from"./thunk-PSphNOu5.js";import{u as ee}from"./useTranslation-i33--018.js";import{C as te}from"./Container-DJRm4Fov.js";import{R as I}from"./Row-C_tKnLHn.js";import{C as N}from"./Col-Dir6tpbB.js";import{I as se}from"./InputGroup-iQ_BXKHR.js";import{F as re}from"./Form-BeSunazq.js";import{B as p}from"./Button-RncLFi2F.js";import{D as h}from"./Dropdown-BthDtKBM.js";import{M as y}from"./Modal-BxKnUp3s.js";import{T as ae}from"./Table-RDBMq32C.js";import{B as j}from"./Badge-VQyFZ_fS.js";import"./react-toastify.esm-Cf9Hh3Hc.js";/* empty css                      */import"./LightDark-ClpPdXmN.js";import"./reselect-CiXCCDx7.js";import"./LayoutContext-DUekwPLw.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./Footer-m5VwlHie.js";import"./ThemeProvider-CYM_k5Zw.js";import"./scrollspy-CiQG5hSI.js";import"./useEventCallback-C77JoxQK.js";import"./NavbarContext-CpEWjYRX.js";import"./inherits-B2gPeQio.js";import"./index-BIk4TdC1.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-Myi-h1X5.js";import"./index.esm-DoMfYbyN.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-jrBPyUKT.js";import"./Collapse-EQe6EL6v.js";import"./TransitionWrapper-Bjg9a9AV.js";import"./useMergedRefs-C7mYgcnr.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./NavLink-DQf1MMSd.js";import"./Anchor-4gdP7f3t.js";import"./useEventCallback-ChoFq1nf.js";import"./Button-m8XipgEK.js";import"./SelectableContext-otIzx00d.js";import"./DataKey-DjdvojM5.js";import"./TabContext-BrmNkun7.js";import"./InputGroupContext-CBCWvJml.js";import"./querySelectorAll-CzRPGPCl.js";import"./SSRProvider-iqc5QCKe.js";import"./useIsomorphicEffect-CPTK-jvb.js";import"./useWindow-BPNIkHCm.js";import"./hook-CdCpUZCW.js";import"./extends-CF3RwP-h.js";import"./useWillUnmount-CV1jA_-9.js";import"./AbstractModalHeader-DOXfy78k.js";import"./hasClass-5e7f26Ba.js";import"./NoopTransition-Df2OePA0.js";import"./CloseButton-PA9gi4Rc.js";import"./Fade-DpConxg0.js";import"./divWithClassName-N3RGU5tF.js";const ie=()=>{const{t:s}=ee(),c=U(),{user:ne,orders:u}=G().props,v=W(),[L,b]=n.useState([]),[S,z]=n.useState(""),[D,ce]=n.useState("all"),[d,m]=n.useState(1),[g,x]=n.useState(10),[k,C]=n.useState(0),[B,w]=n.useState(!1),[M,R]=n.useState(""),[E,P]=n.useState([]),[f,F]=n.useState(""),_=async()=>{var t,r,a;try{const o=await T.get("/order",{params:{page:d,per_page:g,search:S,category:D},headers:{"X-Requested-With":"XMLHttpRequest"}});if(o.data&&o.data.orders){const i=o.data.orders.rows.map(l=>({order_number:l.order_number,purchased_at:l.purchased_at?new Date(l.purchased_at).toLocaleString("vi-VN"):"",product_title:l.product_title,quantity:l.quantity,unit_price:l.unit_price,total_price:l.total_price,status:l.status,notes:l.notes}));b(i),C(((t=o.data.orders.pagination)==null?void 0:t.total)||0),m(((r=o.data.orders.pagination)==null?void 0:r.current_page)||1),x(((a=o.data.orders.pagination)==null?void 0:a.per_page)||10)}}catch(o){console.error("Error fetching orders:",o)}};n.useEffect(()=>{var t,r,a;if(u&&u.rows){const o=u.rows.map(i=>({order_number:i.order_number,purchased_at:i.purchased_at?new Date(i.purchased_at).toLocaleString("vi-VN"):"",product_title:i.product_title,quantity:i.quantity,unit_price:i.unit_price,total_price:i.total_price,status:i.status,notes:i.notes}));b(o),C(((t=u.pagination)==null?void 0:t.total)||0),m(((r=u.pagination)==null?void 0:r.current_page)||1),x(((a=u.pagination)==null?void 0:a.per_page)||10)}else b([]),C(0);c&&v(Z(c==null?void 0:c.theme))},[u,c,v]);const q=()=>{m(1),_()};n.useEffect(()=>{_()},[d,g,D]);const V=async t=>{w(!0),F(t);try{const r=await T.get(`/order/${t}`);if(r.data.success){const a=r.data.data||{};R(a.product_title||"");const o=Array.isArray(a.items)?a.items.map(i=>({product:i.key??"",value:i.data??""})):[];P(o)}}catch(r){console.error("Error fetching order details:",r),P([])}},O=t=>{window.open(`/order/${t}/download`,"_blank")},$=t=>t.toLocaleString("vi-VN"),A=t=>{switch(t){case"COMPLETED":return e.jsx(j,{bg:"success",children:s("Completed")});case"PENDING":return e.jsx(j,{bg:"warning",children:s("Pending")});case"PROCESSING":return e.jsx(j,{bg:"info",children:s("Processing")});case"CANCELLED":return e.jsx(j,{bg:"danger",children:s("Cancelled")});case"FAILED":return e.jsx(j,{bg:"danger",children:s("Failed")});default:return e.jsx(j,{bg:"secondary",children:t})}},H=()=>{const t=[],r=Math.ceil(k/g);t.push(e.jsx(p,{variant:d===1?"primary":"outline-secondary",size:"sm",onClick:()=>m(1),className:"me-1",children:"1"},1));for(let a=2;a<=Math.min(5,r);a++)t.push(e.jsx(p,{variant:d===a?"primary":"outline-secondary",size:"sm",onClick:()=>m(a),className:"me-1",children:a},a));return r>5&&(t.push(e.jsx("span",{className:"me-1",children:"..."},"ellipsis")),t.push(e.jsx(p,{variant:"outline-secondary",size:"sm",onClick:()=>m(r),children:r},r))),t};return e.jsxs(X.Fragment,{children:[e.jsx(Q,{theme:c}),e.jsx(J,{title:`${s("Order history")} - ${(c==null?void 0:c.storeName)??""}`}),e.jsxs(te,{fluid:!0,className:"custom-container",children:[e.jsxs(I,{className:"mb-4 mt-4 align-items-center",children:[e.jsx(N,{md:6,children:e.jsx("h4",{className:"mb-0",style:{fontSize:"30px",fontWeight:"bold",color:"black"},children:s("Purchased order")})}),e.jsx(N,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("div",{className:"rounded-3 overflow-hidden border me-2",style:{width:"250px"},children:e.jsx(se,{children:e.jsx(re.Control,{type:"text",placeholder:s("Enter order number"),value:S,onChange:t=>z(t.target.value)})})}),e.jsx(p,{variant:"primary",onClick:q,className:"rounded-3",children:s("Filter")})]})})]}),e.jsx(Y,{ordersData:L,handleViewOrder:V,handleDownloadOrder:O,formatCurrency:$,getStatusBadge:A,fetchOrdersData:_,t:s}),e.jsxs(I,{className:"mt-3",children:[e.jsx(N,{md:6,children:e.jsx("p",{className:"text-muted mb-0"})}),e.jsx(N,{md:6,children:e.jsxs("div",{className:"d-flex justify-content-end align-items-center",children:[e.jsx(p,{variant:"outline-secondary",size:"sm",className:"me-1",disabled:d===1,onClick:()=>m(d-1),children:e.jsx("i",{className:"ri-arrow-left-line"})}),H(),e.jsx(p,{variant:"outline-secondary",size:"sm",className:"ms-1",disabled:d===Math.ceil(k/g),onClick:()=>m(d+1),children:e.jsx("i",{className:"ri-arrow-right-line"})}),e.jsxs(h,{className:"ms-3",children:[e.jsxs(h.Toggle,{variant:"outline-secondary",size:"sm",children:["Show ",g]}),e.jsxs(h.Menu,{children:[e.jsx(h.Item,{onClick:()=>x(10),children:"10"}),e.jsx(h.Item,{onClick:()=>x(25),children:"25"}),e.jsx(h.Item,{onClick:()=>x(50),children:"50"}),e.jsx(h.Item,{onClick:()=>x(100),children:"100"})]})]})]})})]})]}),e.jsxs(y,{show:B,onHide:()=>w(!1),size:"xl",centered:!0,children:[e.jsx(y.Header,{closeButton:!0,children:e.jsxs(y.Title,{children:[s("Order")," ",f&&`#${f}`]})}),e.jsxs(y.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{className:"fw-semibold",children:[f,".txt"]}),e.jsx("div",{children:e.jsxs(p,{variant:"primary",size:"sm",onClick:()=>O(f),disabled:!f,children:[e.jsx("i",{className:"ri-download-line"})," ",s("Download")]})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs(ae,{className:"table align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:280},children:s("Product")}),e.jsx("th",{children:s("Value")})]})}),e.jsx("tbody",{children:E.length>0?E.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-truncate",style:{maxWidth:280},title:t.product,children:M}),e.jsx("td",{className:"text-break",style:{wordBreak:"break-all"},children:t.value})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"text-center text-muted py-4",children:s("No data")})})})]})})]}),e.jsx(y.Footer,{children:e.jsx(p,{variant:"secondary",onClick:()=>w(!1),children:s("Close")})})]})]})},oe=ie;oe.layout=s=>e.jsx(K,{children:s});export{oe as default};
