import{d as n,f as L,X as P,e as E,j as t,R as I,S as H}from"./ContextMenuProvider-BnbZ3Xw_.js";import R from"./PageHeader-Cx2ZehTq.js";import T from"./index-e2ufP39C.js";import{u as $,c as q,d as y,a as O}from"./index.esm-bbsQyNAz.js";import{s as N}from"./showToast-CDGTjd8l.js";import{Q}from"./react-toastify.esm-Dj3bmGVf.js";import{ModalDeposit as X}from"./ModalDeposit-C8A_BFFU.js";import{LayoutContext as z}from"./LayoutContext-CLuoSh_R.js";import{u as G}from"./Navbar-Ct_Ir6cl.js";import{c as J}from"./thunk-BdeJSdvk.js";/* empty css                      */import"./LightDark-DNWszmZt.js";import{u as K}from"./useTranslation-CtwHyjpC.js";import{C as b}from"./Container-xmF8fBYZ.js";import{C as l}from"./Card-bUFuojd-.js";import{F as c}from"./Form-kohAgaPo.js";import{B as S}from"./Button-BRcUTJGP.js";/* empty css                  */import"./Row-D4DhAVVB.js";import"./ThemeProvider-C0xt9VP8.js";import"./Col-DMyGedr-.js";import"./reselect-CiXCCDx7.js";import"./Footer-VfJmqo4N.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-D_S65KpP.js";import"./Modal-mwm3tf-U.js";import"./useMergedRefs-0e-0eNkH.js";import"./useEventCallback-CWLYZk1t.js";import"./useWillUnmount-JMQ9EYbt.js";import"./TransitionWrapper-DdJIchS_.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./AbstractModalHeader-DeFu7Xk5.js";import"./useWindow-ByxVeiaK.js";import"./querySelectorAll-6mKGZXEM.js";import"./useEventCallback-BuAGpOO_.js";import"./hasClass-D5mdPDLg.js";import"./NoopTransition-Ck7A0kGI.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-Be0iGRvt.js";import"./index-DJrr_1Uz.js";import"./Fade-DiSce4YX.js";import"./divWithClassName-Egl5q-Z9.js";import"./Button-C_zChQbi.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./scrollspy-L89SZfXR.js";import"./NavbarContext-DjQnybmt.js";import"./inherits-C5_PO-Hh.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-D66ESeoA.js";import"./InputGroup-BiZSFxii.js";import"./InputGroupContext-CJ4MYKQG.js";import"./LanguageDropdown-BKUk_KR5.js";import"./Dropdown-5Gi4Yv0j.js";import"./SSRProvider-deIbZZYa.js";import"./useIsomorphicEffect-CgDepx_Y.js";import"./SelectableContext-DwW_dd8V.js";import"./hook-UG-9p7bs.js";import"./extends-CF3RwP-h.js";import"./Anchor-Dx9niwmc.js";import"./Collapse-DMC4Mlvv.js";import"./NavLink-BV4-k6Vz.js";import"./TabContext-Bora0t70.js";const U=()=>{const[u,d]=n.useState(null),[f,p]=n.useState(null),[C,j]=n.useState(!1),[k,w]=n.useState(null),h=n.useContext(z),_=h==null?void 0:h.pingDeposit,x=n.useRef([]),o=G(),v=L(),{listPaymentMethod:r}=P().props;n.useEffect(()=>{o&&v(J(o==null?void 0:o.theme))},[o,v]),n.useEffect(()=>{if(r&&r.length>0&&!i.values.payment_method_id){const s=r[0];g(s)}},[r]);const{t:e}=K(),F=async()=>{V();const s=setInterval(async()=>{await _()&&clearInterval(s)},3e3);x.current.push(s)},V=()=>{x.current.forEach(s=>clearInterval(s)),x.current=[]},g=s=>{const a=(s==null?void 0:s.id)!==void 0&&(s==null?void 0:s.id)!==null?String(s.id):"";i.setFieldValue("payment_method_id",a),(s==null?void 0:s.amount)!==void 0&&(s==null?void 0:s.amount)!==null&&(d(s.amount),p(s.amount),i.setFieldValue("amount",s.amount))},A=s=>{d(s),p(s),i.setFieldValue("amount",s)},B=s=>{p(s),d(null),i.setFieldValue("amount",s)},D=n.useMemo(()=>q({payment_method_id:O().required(e("Please select payment method")),amount:y().min(1e4,e("Amount must be at least 10000")).required(e("Please enter amount"))}),[e]),i=$({initialValues:{payment_method_id:"",amount:0},validationSchema:D,onSubmit:async s=>{const a=route("buyer.deposit.checkout");await E.post(a,s).then(m=>{m.data.status==="success"?(j(!0),w(m.data.data),F()):N(e(m.data.message),"error")}).catch(m=>{N(e(m.response.data.message),"error")})}});return t.jsxs(I.Fragment,{children:[t.jsx(H,{title:(o==null?void 0:o.storeName)??""}),t.jsx(R,{title:(o==null?void 0:o.pageHeaderText)??""}),t.jsx(X,{show:C,onHide:()=>j(!1),data:k}),t.jsx(Q,{}),(r==null?void 0:r.length)>0?t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx(c,{onSubmit:i.handleSubmit,noValidate:!0,children:t.jsx("div",{className:"deposit-section",children:t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["1. ",e("Select your subscription method")]}),t.jsx("div",{className:"payment-methods",children:r==null?void 0:r.map((s,a)=>t.jsx(l,{children:t.jsx(l.Body,{children:t.jsx("div",{children:t.jsxs("div",{className:"form-check mb-2",children:[t.jsx(c.Check.Input,{className:"form-check-input",type:"radio",id:s.id,name:"payment_method_id",value:s.id,checked:i.values.payment_method_id===s.id,onChange:()=>g(s)}),t.jsx(c.Check.Label,{className:"form-check-label",htmlFor:s.id,children:t.jsx("div",{className:"d-flex align-items-center",children:t.jsxs("span",{className:"d-block justify-content-center",children:[s.title," ( ",s.name," )"]})})})]})})})},a))})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["2. ",e("Deposit amount")]}),t.jsx("div",{className:"amount-options mb-3",children:t.jsx("div",{className:"btn-group w-100",children:[1e4,2e4,5e4,1e5,5e5].map(s=>t.jsx(S,{variant:u===s?"primary":"outline-secondary",onClick:()=>A(s),children:s.toLocaleString("vi-VN")},s))})}),t.jsxs("div",{className:"mb-3",children:[t.jsxs(c.Label,{children:[e("Or enter custom amount"),":"]}),t.jsx(c.Control,{name:"amount",type:"text",placeholder:e("Enter amount"),value:f?f.toLocaleString("vi-VN"):"",onChange:s=>{const a=s.target.value.replace(/\./g,""),m=a?Number(a):null;B(m),i.setFieldValue("amount",m)},onBlur:i.handleBlur,className:`form-control ${i.touched.amount&&i.errors.amount?"is-invalid":""}`}),t.jsx(c.Control.Feedback,{type:"invalid",children:e(i.errors.amount||"")})]}),t.jsx(S,{variant:"primary",className:"w-100",type:"submit",disabled:i.isSubmitting,children:i.isSubmitting?e("Processing..."):e("Pay now")})]})]})})})})})}):t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx("h6",{children:e("No payment methods available. Please contact support")})})})})]})};U.layout=u=>t.jsx(T,{children:u});export{U as default};
