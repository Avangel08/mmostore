import{R as x,X as F,A as G,j as e}from"./index-1ump_Xe0.js";import{u as D,c as S,d as w,a as c}from"./index.esm-BciJ4fv2.js";import{B as A,F as K}from"./react-toastify.esm-jnx5epZC.js";import{u as I}from"./useTranslation-oNUPzLBU.js";import{M as u}from"./Modal-nUZtqd9X.js";import{F as o}from"./Form-C-jXRq10.js";import{C as $}from"./Container-Dc9fXQ_k.js";import{R as b}from"./Row-BWTyJl4l.js";import{C as f}from"./Col-CdW2U8Wr.js";import{B as P}from"./Button-6ljC9uRN.js";import"./isSymbol-Bhs3vyb9.js";import"./hoist-non-react-statics.cjs-DQogQWOa.js";import"./ThemeProvider-Dd1N824R.js";import"./TransitionWrapper-DUK7XRjN.js";import"./setPrototypeOf-B4fUID9J.js";import"./index-MtV1wmxR.js";import"./useEventCallback-EbZ0nWol.js";import"./AbstractModalHeader-DLOhpJEl.js";import"./useEventCallback-D_K8eYRm.js";import"./NoopTransition-nDLBy0Rk.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-DeTB4-AT.js";import"./Fade-CHUSZAS8.js";import"./divWithClassName-Cb7BXaEK.js";import"./Button-CMdU8Yb3.js";const ue=({show:N,onHide:d})=>{var v;const{t:i}=I(),p=x.useRef(null),{guards:h}=F().props,[j,k]=x.useState(["view","create","edit","delete"]),t=x.useRef(null),g=(s,a)=>{A[a](s,{position:"top-center",autoClose:2500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",transition:K})},r=D({initialValues:{groupPermissionName:"",groupPermissionDescription:"",groupPermissionKey:"",groupPermissionGuard:"",groupPermissionValue:[]},validationSchema:S({groupPermissionName:c().max(50,"Must be 50 characters or less").required(i("Please enter this field")),groupPermissionDescription:c().max(1e3,"Must be 1000 characters or less"),groupPermissionKey:c().max(50,"Must be 50 characters or less").required(i("Please enter this field")),groupPermissionGuard:c().required(i("Please select guard")),groupPermissionValue:w().min(1,"Please select at least one permission").of(c().max(50,"Must be 50 characters or less"))}),onSubmit:s=>{G.post(route("admin.permissions.add"),s,{onSuccess:a=>{var n,l,m,C;if((l=(n=a.props)==null?void 0:n.message)!=null&&l.error){g(i(a.props.message.error),"error");return}r.resetForm(),d(),(C=(m=a.props)==null?void 0:m.message)!=null&&C.success&&g(i(a.props.message.success),"success")},onError:a=>{const n=Object.values(a).join(", ");g(n,"error")}})}}),y=s=>{var n,l;const a=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");a.trim()===""?(n=p.current)==null||n.classList.add("d-none"):(l=p.current)==null||l.classList.remove("d-none"),r.setFieldValue("groupPermissionKey",a)},L=()=>{document.getElementById("checkAll").checked?r.setFieldValue("groupPermissionValue",j.concat("all")):r.setFieldValue("groupPermissionValue",[])},V=s=>{const a=s.target.value,n=s.target.checked;let l=[...r.values.groupPermissionValue];n?l.push(a):l=l.filter(m=>m!==a),r.setFieldValue("groupPermissionValue",l)},B=()=>{var s;if((s=t==null?void 0:t.current)!=null&&s.value){const a=t.current.value;k(n=>n.includes(a)?n:[...n,a]),t.current.value=""}};return e.jsx(u,{id:"myModal",backdrop:"static",show:N,onHide:()=>{r.resetForm(),d()},centered:!0,children:e.jsxs(o,{onSubmit:r.handleSubmit,noValidate:!0,children:[e.jsx(u.Header,{closeButton:!0,children:e.jsx("h5",{children:i("Add new group permission")})}),e.jsxs(u.Body,{children:[e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionName",children:[e.jsxs(o.Label,{children:[i("Group permission name")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:i("Enter group permission name"),maxLength:50,onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionName,isInvalid:!!(r.touched.groupPermissionName&&r.errors.groupPermissionName)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionName})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionGuard",children:[e.jsxs(o.Label,{children:[i("Guard")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(o.Select,{onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionGuard,isInvalid:!!(r.touched.groupPermissionGuard&&r.errors.groupPermissionGuard),children:[e.jsx("option",{value:"",children:i("Select guard")}),h==null?void 0:h.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionGuard})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionDescription",children:[e.jsx(o.Label,{children:i("Description")}),e.jsx(o.Control,{as:"textarea",rows:6,maxLength:1e3,placeholder:i("Enter description"),onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionDescription,isInvalid:!!(r.touched.groupPermissionDescription&&r.errors.groupPermissionDescription)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionDescription})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionKey",children:[e.jsxs(o.Label,{children:["Key ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:i("Enter key"),onChange:s=>{y(s)},maxLength:50,onBlur:r.handleBlur,value:r.values.groupPermissionKey,isInvalid:!!(r.touched.groupPermissionKey&&r.errors.groupPermissionKey)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionKey})]}),e.jsxs(o.Group,{ref:p,id:"permissionCheckbox",className:"mb-3 d-none",controlId:"groupPermissionValue",children:[e.jsxs(o.Label,{htmlFor:"",children:[i("Permissions")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs($,{children:[e.jsxs(b,{children:[e.jsx(f,{xs:12,className:"mb-2",children:e.jsx(o.Check,{id:"checkAll",type:"checkbox",value:"all",label:i("Select all"),onChange:s=>{L()},onBlur:r.handleBlur,checked:(v=r.values.groupPermissionValue)==null?void 0:v.includes("all")})}),j.map(s=>{var a;return e.jsx(f,{xs:12,lg:6,className:"mb-2",children:e.jsx(o.Check,{type:"checkbox",id:`form-check-${s}`,value:s,label:`${r.values.groupPermissionKey}_${s}`,onChange:n=>{V(n)},onBlur:r.handleBlur,checked:(a=r.values.groupPermissionValue)==null?void 0:a.includes(s)},s)})})]}),e.jsx(b,{children:r.touched.groupPermissionValue&&r.errors.groupPermissionValue&&e.jsx("div",{className:"text-danger",style:{fontSize:"0.875em"},children:r.errors.groupPermissionValue})}),e.jsxs(o.Group,{className:"d-flex flex-row gap-2 mt-3",children:[e.jsx(o.Control,{placeholder:i("Input permission name"),maxLength:50,ref:t,onChange:s=>{const a=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");s.target.value=a}}),e.jsx(P,{size:"sm",variant:"primary",onClick:B,children:i("Add")})]})]})]})]}),e.jsxs(u.Footer,{children:[e.jsx(P,{variant:"light",onClick:()=>{r.resetForm(),d()},children:i("Close")}),e.jsx(P,{variant:"primary",type:"submit",children:i("Add new")})]})]})})};export{ue as ModalAddNewGroupPermission};
