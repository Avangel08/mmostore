import{R as k,X as F,A as N,d as y,j as s}from"./ContextMenuProvider-DoI9LuTu.js";import{u as M,c as $,e as w,a as j,F as A,h as R}from"./index.esm-yjK6ua4W.js";import{S as q}from"./react-select.esm-Ci0lS3LH.js";import{s as v}from"./showToast-BFjkHmvN.js";import{u as L}from"./useTranslation-Bh5zzBC_.js";import{F as h}from"./Form-C6Oq7frR.js";import{R as E}from"./Row-DaX0pFtU.js";import{C as f}from"./Col-BERnSmBs.js";import{B as g}from"./Button-CdshqBqI.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-BsRiVy2U.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./extends-CF3RwP-h.js";import"./setPrototypeOf-DgZC2w_0.js";import"./inherits-B2gPeQio.js";import"./react-toastify.esm-8BWsAHON.js";import"./ThemeProvider-CQKb4rSK.js";import"./index-B7rcZTdA.js";import"./Button-lElTeqs9.js";const D=[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],O=k.memo(({index:c,item:r,onChange:p,onBlur:o,setFieldValue:b,setFieldTouched:x,remove:n,t:l,menusLength:i,errors:t,touched:e})=>{const a=y.useMemo(()=>D.map(u=>({value:u.value,label:l(u.label)})),[l]),d=a.find(u=>u.value===r.status)||null,m=u=>{var C,S;return(C=e==null?void 0:e[c])!=null&&C[u]&&((S=t==null?void 0:t[c])!=null&&S[u])?t[c][u]:""};return s.jsxs(E,{className:"mb-2",children:[s.jsxs(f,{xs:3,children:[s.jsx(h.Control,{type:"text",value:r.label,onChange:p,onBlur:o,name:`menus.${c}.label`,placeholder:l("Enter your menu label"),isInvalid:!!m("label")}),s.jsxs(h.Control.Feedback,{type:"invalid",className:"invalid-feedback d-block",children:[" ",m("label")]})]}),s.jsx(f,{children:s.jsxs(h.Group,{className:"input-group",children:[s.jsx("span",{className:"input-group-text",style:{backgroundColor:"#f8f9fa",borderColor:"#ced4da",color:"#6c757d",fontSize:"14px",minWidth:"120px"},children:"https://"}),s.jsx(h.Control,{type:"text",value:r.value,onChange:p,onBlur:o,name:`menus.${c}.value`,placeholder:l("Enter your menu url"),isInvalid:!!m("value")}),s.jsxs(h.Control.Feedback,{type:"invalid",className:"invalid-feedback d-block",children:[" ",m("value")]})]})}),s.jsxs(f,{xs:2,children:[s.jsx(q,{options:a,placeholder:l("Select status"),name:`menus.${c}.status`,value:d,onChange:u=>b(`menus.${c}.status`,(u==null?void 0:u.value)||""),onBlur:()=>x(`menus.${c}.status`,!0),isSearchable:!1,menuPortalTarget:document.body}),m("status")&&s.jsx("div",{className:"text-danger mt-1 small",children:m("status")})]}),s.jsx(f,{xs:"auto",children:s.jsx(g,{variant:"danger",onClick:()=>n(c),disabled:i===1,children:s.jsx("i",{className:"ri-indeterminate-circle-line"})})})]})}),I=({activeTab:c})=>{const{t:r}=L(),{settings:p}=F().props,o=M({initialValues:{menus:(p==null?void 0:p.menus)||[{label:"",value:"",status:"active"}]},validationSchema:$({menus:w().of($().shape({label:j().trim().required(r("Label is required")),value:j().trim().required(r("URL is required")).matches(/^(?!https?:\/\/)([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/.*)?$/,r("Enter a valid URL without")+" http(s)://"),status:j().oneOf(["active","inactive"],r("Invalid status")).required(r("Status is required"))})).test("unique-labels",r("Duplicate labels found"),function(n){var i,t;if(!n)return!0;const l=new Map;for(let e=0;e<n.length;e++){const a=(t=(i=n[e])==null?void 0:i.label)==null?void 0:t.trim().toLowerCase();if(a){if(l.has(a))return this.createError({path:`${this.path}[${e}].label`,message:r("Duplicate label at position {{pos}}",{pos:e+1})});l.set(a,e)}}return!0}).test("unique-values",r("Duplicate URLs found"),function(n){var i,t;if(!n)return!0;const l=new Map;for(let e=0;e<n.length;e++){const a=(t=(i=n[e])==null?void 0:i.value)==null?void 0:t.trim().toLowerCase();if(a){if(l.has(a))return this.createError({path:`${this.path}[${e}].value`,message:r("Duplicate URL at position {{pos}}",{pos:e+1})});l.set(a,e)}}return!0})}),onSubmit:n=>{const l=new FormData;l.append("menus",JSON.stringify(n.menus)),l.append("tab",c);const i=route("seller.theme-settings.update",{id:p.id});N.post(i,l,{preserveScroll:!0,onSuccess:t=>{var e,a,d,m;if((a=(e=t.props)==null?void 0:e.message)!=null&&a.error){v(r(t.props.message.error),"error");return}(m=(d=t.props)==null?void 0:d.message)!=null&&m.success?(v(r(t.props.message.success),"success"),o.resetForm()):v(r("Settings updated successfully"),"success")},onError:t=>{if(t&&Object.keys(t).length>0){const e={};Object.keys(t).forEach(a=>{x(e,a,t[a])}),console.log({formErrors:e,errors:t}),o.setErrors(e),Object.values(t).forEach(a=>v(r(a),"error"))}else v(r("An unexpected server error occurred"),"error")}})}}),b=y.useCallback(n=>{n.push({label:"",value:"",status:"active"})},[]);console.log(o.errors);function x(n,l,i){const t=l.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".");let e=n;t.forEach((a,d)=>{if(d<t.length-1){if(!(a in e)){const m=t[d+1];e[a]=/^\d+$/.test(m)?[]:{}}e=e[a]}else e[a]=i})}return s.jsx(A,{value:o,children:s.jsxs(h,{noValidate:!0,onSubmit:o.handleSubmit,children:[s.jsx("div",{className:"mb-3",children:s.jsxs("h5",{className:"mb-2",children:[r("Menu"),s.jsx("span",{className:"text-danger",children:"*"})]})}),s.jsx(E,{children:s.jsx(f,{children:s.jsx(R,{name:"menus",render:n=>s.jsxs("div",{className:"mb-3",children:[o.values.menus.map((l,i)=>s.jsx(O,{index:i,item:l,onChange:o.handleChange,onBlur:o.handleBlur,setFieldValue:o.setFieldValue,setFieldTouched:o.setFieldTouched,remove:n.remove,t:r,menusLength:o.values.menus.length,errors:o.errors.menus,touched:o.touched.menus},i)),s.jsxs(g,{variant:"secondary",onClick:()=>b(n),children:[s.jsx("i",{className:"ri-add-circle-line"})," ",r("Add Menu")]})]})})})}),s.jsx("div",{className:"text-start",children:s.jsx(g,{type:"submit",variant:"success",children:r("Update")})})]})})},ae=k.memo(I);export{ae as default};
