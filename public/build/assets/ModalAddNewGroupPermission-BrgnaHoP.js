import{R as x,X as F,j as e,A as G}from"./index-EM1BjBMV.js";import{u as D,c as S,a as w,b as c}from"./index.esm-BbJdVMiP.js";import{B as A,F as K}from"./isSymbol-Czc8PlkC.js";import{u as I}from"./useTranslation-B97z7fiK.js";import{M as m}from"./Modal-BW56jli-.js";import{F as o}from"./Form-Crrp_3nh.js";import{C as $}from"./Container-AbJyAqVa.js";import{R as C,C as N,B as P}from"./Row-B5TknY2O.js";import"./hoist-non-react-statics.cjs-DQogQWOa.js";import"./CloseButton-DsugLeO_.js";import"./setPrototypeOf-B4fUID9J.js";import"./AbstractModalHeader-CQjkIP_d.js";const W=({show:f,onHide:d})=>{var v;const{t:n}=I(),p=x.useRef(null),{guards:h}=F().props,[j,k]=x.useState(["view","create","edit","delete"]),t=x.useRef(null),g=(s,a)=>{A[a](s,{position:"top-center",autoClose:2500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",transition:K})},r=D({initialValues:{groupPermissionName:"",groupPermissionDescription:"",groupPermissionKey:"",groupPermissionGuard:"",groupPermissionValue:[]},validationSchema:S({groupPermissionName:c().max(50,"Must be 50 characters or less").required(n("Please enter this field")),groupPermissionDescription:c().max(1e3,"Must be 1000 characters or less"),groupPermissionKey:c().max(50,"Must be 50 characters or less").required(n("Please enter this field")),groupPermissionGuard:c().required(n("Please select guard")),groupPermissionValue:w().min(1,"Please select at least one permission").of(c().max(50,"Must be 50 characters or less"))}),onSubmit:s=>{G.post(route("admin.permissions.add"),s,{onSuccess:a=>{var i,l,u,b;if((l=(i=a.props)==null?void 0:i.message)!=null&&l.error){g(n(a.props.message.error),"error");return}r.resetForm(),d(),(b=(u=a.props)==null?void 0:u.message)!=null&&b.success&&g(n(a.props.message.success),"success")},onError:a=>{const i=Object.values(a).join(", ");g(i,"error")}})}}),y=s=>{var i,l;const a=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");a.trim()===""?(i=p.current)==null||i.classList.add("d-none"):(l=p.current)==null||l.classList.remove("d-none"),r.setFieldValue("groupPermissionKey",a)},L=()=>{document.getElementById("checkAll").checked?r.setFieldValue("groupPermissionValue",j.concat("all")):r.setFieldValue("groupPermissionValue",[])},V=s=>{const a=s.target.value,i=s.target.checked;let l=[...r.values.groupPermissionValue];i?l.push(a):l=l.filter(u=>u!==a),r.setFieldValue("groupPermissionValue",l)},B=()=>{var s;if((s=t==null?void 0:t.current)!=null&&s.value){const a=t.current.value;k(i=>i.includes(a)?i:[...i,a]),t.current.value=""}};return e.jsx(m,{id:"myModal",backdrop:"static",show:f,onHide:()=>{r.resetForm(),d()},centered:!0,children:e.jsxs(o,{onSubmit:r.handleSubmit,noValidate:!0,children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx("h5",{children:n("Add new group permission")})}),e.jsxs(m.Body,{children:[e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionName",children:[e.jsxs(o.Label,{children:[n("Group permission name")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:n("Enter group permission name"),maxLength:50,onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionName,isInvalid:!!(r.touched.groupPermissionName&&r.errors.groupPermissionName)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionName})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionGuard",children:[e.jsxs(o.Label,{children:[n("Guard")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(o.Select,{onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionGuard,isInvalid:!!(r.touched.groupPermissionGuard&&r.errors.groupPermissionGuard),children:[e.jsx("option",{value:"",children:n("Select guard")}),h==null?void 0:h.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionGuard})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionDescription",children:[e.jsx(o.Label,{children:n("Description")}),e.jsx(o.Control,{as:"textarea",rows:6,maxLength:1e3,placeholder:n("Enter description"),onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.groupPermissionDescription,isInvalid:!!(r.touched.groupPermissionDescription&&r.errors.groupPermissionDescription)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionDescription})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"groupPermissionKey",children:[e.jsxs(o.Label,{children:["Key ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o.Control,{type:"text",placeholder:n("Enter key"),onChange:s=>{y(s)},maxLength:50,onBlur:r.handleBlur,value:r.values.groupPermissionKey,isInvalid:!!(r.touched.groupPermissionKey&&r.errors.groupPermissionKey)}),e.jsx(o.Control.Feedback,{type:"invalid",children:r.errors.groupPermissionKey})]}),e.jsxs(o.Group,{ref:p,id:"permissionCheckbox",className:"mb-3 d-none",controlId:"groupPermissionValue",children:[e.jsxs(o.Label,{htmlFor:"",children:[n("Permissions")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs($,{children:[e.jsxs(C,{children:[e.jsx(N,{xs:12,className:"mb-2",children:e.jsx(o.Check,{id:"checkAll",type:"checkbox",value:"all",label:n("Select all"),onChange:s=>{L()},onBlur:r.handleBlur,checked:(v=r.values.groupPermissionValue)==null?void 0:v.includes("all")})}),j.map(s=>{var a;return e.jsx(N,{xs:12,lg:6,className:"mb-2",children:e.jsx(o.Check,{type:"checkbox",id:`form-check-${s}`,value:s,label:`${r.values.groupPermissionKey}_${s}`,onChange:i=>{V(i)},onBlur:r.handleBlur,checked:(a=r.values.groupPermissionValue)==null?void 0:a.includes(s)},s)})})]}),e.jsx(C,{children:r.touched.groupPermissionValue&&r.errors.groupPermissionValue&&e.jsx("div",{className:"text-danger",style:{fontSize:"0.875em"},children:r.errors.groupPermissionValue})}),e.jsxs(o.Group,{className:"d-flex flex-row gap-2 mt-3",children:[e.jsx(o.Control,{placeholder:n("Input permission name"),maxLength:50,ref:t,onChange:s=>{const a=s.target.value.replace(/[^A-Za-z-.0-9]/g,"");s.target.value=a}}),e.jsx(P,{size:"sm",variant:"primary",onClick:B,children:n("Add")})]})]})]})]}),e.jsxs(m.Footer,{children:[e.jsx(P,{variant:"light",onClick:()=>{r.resetForm(),d()},children:n("Close")}),e.jsx(P,{variant:"primary",type:"submit",children:n("Add new")})]})]})})};export{W as ModalAddNewGroupPermission};
