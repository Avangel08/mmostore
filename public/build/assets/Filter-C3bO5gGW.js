import{d as o,j as e,e as k}from"./ContextMenuProvider-BhVN3MI2.js";import{F as M,_ as V,v as G}from"./default-IqKp8mNI.js";import{h as O}from"./moment-C5S46NFB.js";import{u as H}from"./useQueryParam-CLHEKvAC.js";import{u as $}from"./useTranslation-ZbZFIHja.js";import{F as l}from"./Form-B_1_SP-R.js";import{B as R}from"./Button-CT1W-dlW.js";import{R as I}from"./Row-DTCryV-T.js";import{C as g}from"./Col-CDTbDU3W.js";import"./index-CMi1q9xw.js";import"./ThemeProvider-CUiVOj3n.js";import"./Button-ItoOpMhW.js";const z=({value:j,onChange:_,placeholder:v="Search...",label:L,id:a,searchEndpoint:S,searchParam:y="search",displayField:u,valueField:d,secondaryField:s,className:F=""})=>{const{t:w,i18n:r}=$(),[m,C]=o.useState(!1),[c,D]=o.useState(""),[h,N]=o.useState([]),[E,b]=o.useState(!1),[t,x]=o.useState(null),p=o.useRef(null),f=o.useRef(null),P=async()=>{b(!0);try{const n=await k.get(S,{params:{limit:20}});n.data.success&&N(n.data.data)}catch(n){console.error("Error loading options:",n),N([])}finally{b(!1)}},A=async n=>{p.current&&clearTimeout(p.current),p.current=setTimeout(async()=>{b(!0);try{const i=await k.get(S,{params:{[y]:n,limit:20}});i.data.success&&N(i.data.data)}catch(i){console.error("Error searching options:",i),N([])}finally{b(!1)}},300)},Y=n=>{const i=n.target.value;D(i),i.trim()===""?P():A(i)},T=n=>{x(n),_(n[d]),D(""),C(!1)},B=()=>{m||(P(),D("")),C(!m)};return o.useEffect(()=>{if(j&&h.length>0){const n=h.find(i=>i[d]===j);n&&x(n)}else j||x(null)},[j,h]),o.useEffect(()=>{P()},[S]),o.useEffect(()=>{const n=i=>{f.current&&!f.current.contains(i.target)&&C(!1)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[]),e.jsxs("div",{className:`searchable-select ${F}`,ref:f,children:[L&&e.jsx(l.Label,{htmlFor:a,children:L}),e.jsxs("div",{className:"position-relative",children:[e.jsx(l.Control,{type:"text",id:a,className:"form-control",placeholder:t?`${t[u]}${s?` (${t[s]})`:""}`:v,value:t?`${t[u]}${s?` (${t[s]})`:""}`:"",readOnly:!0,onClick:B,style:{cursor:"pointer"}}),e.jsx("div",{className:"position-absolute top-50 end-0 translate-middle-y pe-3",style:{pointerEvents:"none"},children:e.jsx("i",{className:`ri-arrow-down-s-line ${m?"rotate-180":""}`})}),m&&e.jsxs("div",{className:"position-absolute w-100 bg-white border rounded shadow-lg",style:{top:"100%",left:0,zIndex:1050,maxHeight:"300px",overflowY:"auto"},children:[e.jsx("div",{className:"p-2 border-bottom",children:e.jsx(l.Control,{type:"text",placeholder:`${v}...`,value:c,onChange:Y,autoFocus:!0,className:"mb-0",onClick:n=>n.stopPropagation()})}),e.jsxs("div",{className:"py-1",children:[E&&e.jsx("div",{className:"px-3 py-2 text-muted",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:e.jsx("span",{className:"visually-hidden",children:w("Loading")})}),w("Search...")]})}),!E&&h.length===0&&c&&e.jsx("div",{className:"px-3 py-2 text-muted",children:"No results found"}),!E&&h.length===0&&c===""&&e.jsx("div",{className:"px-3 py-2 text-muted",children:"No options available"}),h.map((n,i)=>e.jsxs("div",{className:`px-3 py-2 cursor-pointer ${t&&t[d]===n[d]?"bg-primary text-white":"hover-bg-light"}`,onClick:()=>T(n),style:{cursor:"pointer"},children:[e.jsx("div",{className:"fw-medium",children:n[u]}),s&&e.jsx("small",{className:`${t&&t[d]===n[d]?"text-white-50":"text-muted"}`,children:n[s]})]},n[d]||i))]})]})]})]})},re=({onFilter:j,categories:_=[],products:v=[],customers:L=[]})=>{const{t:a,i18n:S}=$(),y=o.useRef(null),[u,d]=o.useState(!1),s=H(),F=(s==null?void 0:s.perPage)??"10",w=()=>({search:(s==null?void 0:s.search)??"",createdDateStart:(s==null?void 0:s.createdDateStart)??"",createdDateEnd:(s==null?void 0:s.createdDateEnd)??"",status:(s==null?void 0:s.status)??"",payment_status:(s==null?void 0:s.payment_status)??"",category_id:(s==null?void 0:s.category_id)??"",product_id:(s==null?void 0:s.product_id)??"",customer_id:(s==null?void 0:s.customer_id)??""}),[r,m]=o.useState(w()),C=()=>{switch(S.language){case"vi":return G.Vietnamese;default:return V.english}},c=(t,x)=>{m(p=>{const f={...p,[t]:x};return t==="category_id"&&(f.product_id=""),f})},D=t=>{const[x,p]=t;m(f=>({...f,createdDateStart:x?O(x).format("YYYY-MM-DD"):"",createdDateEnd:p?O(p).format("YYYY-MM-DD"):""}))},h=()=>{j(1,Number(F),r)},N=()=>!!(r.search&&r.search.trim()!==""||r.createdDateStart&&r.createdDateStart!==""||r.createdDateEnd&&r.createdDateEnd!==""||r.status&&r.status!==""||r.payment_status&&r.payment_status!==""||r.category_id&&r.category_id!==""||r.product_id&&r.product_id!==""||r.customer_id&&r.customer_id!==""),E=()=>{const t={search:"",createdDateStart:"",createdDateEnd:"",status:"",payment_status:"",category_id:"",product_id:"",customer_id:""};m(t),y.current&&y.current.flatpickr&&y.current.flatpickr.clear(),j(1,Number(F),t)},b=()=>{d(!u)};return e.jsxs("div",{className:"filter-container mb-5",children:[e.jsxs("div",{className:"mb-3 d-flex align-items-center gap-2",children:[e.jsxs(R,{variant:"outline-primary",onClick:b,className:"d-flex align-items-center",children:[e.jsx("i",{className:`ri-filter-${u?"off":"2"}-line align-bottom me-2`}),a(u?"Hide Filters":"Show Filters")]}),N()&&e.jsxs(R,{variant:"outline-secondary",onClick:E,className:"d-flex align-items-center",children:[e.jsx("i",{className:"ri-refresh-line align-bottom me-1"}),a("Reset")]})]}),u&&e.jsxs("div",{className:"p-3 border rounded bg-light",children:[e.jsxs(I,{className:"g-2 align-items-end",style:{marginBottom:"10px"},children:[e.jsxs(g,{md:2,children:[e.jsx(l.Label,{htmlFor:"filter-search",children:a("Order number")}),e.jsx(l.Control,{type:"text",id:"filter-search",placeholder:a("Enter order number"),value:r.search,onChange:t=>c("search",t.target.value)})]}),e.jsx(g,{md:2,children:e.jsx(z,{id:"filter-customer",label:a("Customer"),value:r.customer_id,onChange:t=>c("customer_id",t),placeholder:a("All Customers"),searchEndpoint:"/admin/filter/customers",searchParam:"search",displayField:"name",valueField:"id",secondaryField:"email"})}),e.jsxs(g,{md:2,children:[e.jsx(l.Label,{htmlFor:"filter-date",children:a("Created Date Range")}),e.jsx(M,{ref:y,className:"form-control",id:"filter-date",placeholder:a("Select date range"),options:{mode:"range",dateFormat:"d/m/Y",locale:C()},value:r.createdDateStart&&r.createdDateEnd?[new Date(r.createdDateStart),new Date(r.createdDateEnd)]:r.createdDateStart?[new Date(r.createdDateStart)]:[],onChange:D})]})]}),e.jsxs(I,{className:"g-2 align-items-end",style:{marginBottom:"10px"},children:[e.jsxs(g,{md:2,children:[e.jsx(l.Label,{htmlFor:"filter-status",children:a("Status")}),e.jsxs(l.Select,{id:"filter-status",value:r.status,onChange:t=>c("status",t.target.value),children:[e.jsx("option",{value:"",children:a("All Status")}),e.jsx("option",{value:"PENDING",children:a("Pending")}),e.jsx("option",{value:"PROCESSING",children:a("Processing")}),e.jsx("option",{value:"COMPLETED",children:a("Completed")}),e.jsx("option",{value:"CANCELLED",children:a("Cancelled")}),e.jsx("option",{value:"FAILED",children:a("Failed")})]})]}),e.jsxs(g,{md:2,children:[e.jsx(l.Label,{htmlFor:"filter-payment-status",children:a("Payment Status")}),e.jsxs(l.Select,{id:"filter-payment-status",value:r.payment_status,onChange:t=>c("payment_status",t.target.value),children:[e.jsx("option",{value:"",children:a("All Status")}),e.jsx("option",{value:"PENDING",children:a("Pending")}),e.jsx("option",{value:"PAID",children:a("Paid")}),e.jsx("option",{value:"FAILED",children:a("Failed")}),e.jsx("option",{value:"REFUNDED",children:a("Refunded")})]})]}),e.jsxs(g,{md:2,children:[e.jsx(l.Label,{htmlFor:"filter-category",children:a("Category")}),e.jsxs(l.Select,{id:"filter-category",value:r.category_id,onChange:t=>c("category_id",t.target.value),children:[e.jsx("option",{value:"",children:a("All Categories")}),_&&_.length>0?_.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id)):e.jsx("option",{value:"",disabled:!0,children:a("No categories available")})]})]}),e.jsxs(g,{md:2,children:[e.jsx(l.Label,{htmlFor:"filter-product",children:a("Product")}),e.jsxs(l.Select,{id:"filter-product",value:r.product_id,onChange:t=>c("product_id",t.target.value),children:[e.jsx("option",{value:"",children:a("All Products")}),v&&v.length>0?v.filter(t=>!r.category_id||t.category_id===r.category_id).map(t=>e.jsx("option",{value:t._id,children:t.name},t._id)):e.jsx("option",{value:"",disabled:!0,children:a("No products available")})]})]})]}),e.jsx(g,{md:1,className:"d-flex gap-1",children:e.jsxs(R,{variant:"primary",onClick:h,children:[e.jsx("i",{className:"ri-search-line align-bottom me-1"}),a("Filter")]})})]})]})};export{re as default};
