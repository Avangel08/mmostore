import{d as l,j as s,X as N,A as b}from"./ContextMenuProvider-8rBguBkL.js";import{h as k}from"./moment-C5S46NFB.js";import{T as w}from"./TableWithContextMenu--PxptZAg.js";import{u as T}from"./useTranslation-BPBxc4-B.js";import{u as R,c as j}from"./ThemeProvider-C1jYdK3n.js";import{C as x}from"./Col-CtjW1edu.js";import{B as F}from"./Button-Br3adEhm.js";const g=l.forwardRef(({bsPrefix:e,bg:i="primary",pill:c=!1,text:n,className:d,as:f="span",...u},m)=>{const p=R(e,"badge");return s.jsx(f,{ref:m,...u,className:j(d,p,c&&"rounded-pill",n&&`text-${n}`,i&&`bg-${i}`)})});g.displayName="Badge";const S=l.forwardRef(({bsPrefix:e,variant:i,animation:c="border",size:n,as:d="div",className:f,...u},m)=>{e=R(e,"spinner");const p=`${e}-${c}`;return s.jsx(d,{ref:m,...u,className:j(f,p,n&&`${p}-${n}`,i&&`text-${i}`)})});S.displayName="Spinner";const P=()=>{const{t:e}=T(),{importHistory:i}=N().props,[c,n]=l.useState(!1),[d,f]=l.useState(0),[u,m]=l.useState(!0),p=l.useCallback((t=1,a=10,r)=>{b.reload({only:["importHistory","accounts"],replace:!0,data:{importPage:t,importPerPage:a,...r},onFinish:()=>{n(!1)}})},[]),y=l.useCallback(()=>{const t=Date.now();if(t-d<2e3)return;n(!0),m(!1),f(t);const a=Date.now();b.reload({only:["importHistory","accounts"],replace:!0,onFinish:()=>{const r=Date.now()-a,o=1e3;r<o?setTimeout(()=>{n(!1)},o-r):n(!1),setTimeout(()=>{m(!0)},2e3)}})},[d]),C=l.useMemo(()=>[{header:e("File name"),accessorKey:"file_path",enableColumnFilter:!1,enableSorting:!0,cell:t=>s.jsx("span",{children:t.getValue().split("/").pop()})},{header:e("Upload date"),accessorKey:"created_at",enableColumnFilter:!1,enableSorting:!0,cell:t=>s.jsx("span",{children:k(t.getValue()).format("DD/MM/YYYY HH:mm")})},{header:e("Status"),accessorKey:"status",enableColumnFilter:!1,enableSorting:!0,cell:t=>{const a=t.getValue()||"Unknown",r={FINISH:e("Finish"),RUNNING:e("Processing"),ERROR:e("Error"),Unknown:e("Unknown")},o={FINISH:"bg-success",RUNNING:"bg-info",ERROR:"bg-danger",Unknown:"bg-dark"};return s.jsx("span",{className:`badge ${(o==null?void 0:o[a])||"bg-dark"} fs-6 fw-medium`,children:e((r==null?void 0:r[a])||"Unknown")})}},{header:e("Result"),accessorKey:"result",enableColumnFilter:!1,enableSorting:!0,cell:t=>{var o,h;const a=t.getValue()||{};return((h=(o=t==null?void 0:t.row)==null?void 0:o.original)==null?void 0:h.status)==="FINISH"?s.jsxs("div",{children:[s.jsxs(g,{bg:"secondary",children:[e("Total"),": ",(a==null?void 0:a.total_count)||0]})," ",s.jsxs(g,{bg:"success",children:[e("Success"),": ",(a==null?void 0:a.success_count)||0]})," ",s.jsxs(g,{bg:"danger",children:[e("Error"),": ",(a==null?void 0:a.error_count)||0]})]}):null}}],[e]);return s.jsxs(s.Fragment,{children:[s.jsxs(x,{lg:12,className:"mb-4 d-flex align-items-center gap-2",children:[s.jsx("h5",{children:e("Recent uploaded files")}),s.jsxs(F,{variant:"outline-info",onClick:y,disabled:c||!u,style:{transition:"all 0.3s ease-in-out",opacity:c||!u?.6:1},children:[c&&s.jsx(S,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),e("Refresh")]})]}),s.jsx(x,{lg:12,children:s.jsx("div",{children:s.jsx(w,{columns:C,data:i||[],divClass:"table-responsive table-card mb-3",tableClass:"table align-middle table-nowrap mb-0",theadClass:"table-light",enableContextMenu:!1,isPaginateTable:!0,onReloadTable:p,keyPageParam:"importPage",keyPerPageParam:"importPerPage"})})})]})},E=Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}));export{P as R,S,E as a};
