import{d as r,j as e,R as M,B as fe}from"./ContextMenuProvider-CoCa8nFp.js";import{u as ee,g as te,a as be,b as se,c as ne,T as ae,f as O,r as le}from"./index-D2zkEp7u.js";import{u as ie}from"./useTranslation-79FPa95p.js";import{R as F}from"./Row-C7AjwfoU.js";import{C as oe}from"./Card-DoaoAIRG.js";import{C as re}from"./Col-gyXmhzbn.js";import{B as w}from"./Button-BFUtYQ2I.js";import{S as Ne}from"./react-select.esm-1uWOj73-.js";import{u as Ce}from"./useQueryParam-oAN_AXAS.js";const ve=({column:n})=>{const a=n.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(ce,{type:"text",value:a??"",onChange:c=>n.setFilterValue(c),placeholder:"Search...",className:"w-36 border shadow rounded",list:n.id+"list"}),e.jsx("div",{className:"h-1"})]})},ce=({value:n,onChange:a,debounce:c=500,...d})=>{const[m,u]=r.useState(n);return r.useEffect(()=>{u(n)},[n]),r.useEffect(()=>{const g=setTimeout(()=>{a(m)},c);return()=>clearTimeout(g)},[c,m]),e.jsx("input",{...d,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:g=>u(g.target.value)})},Se=({columns:n,data:a,isGlobalFilter:c,customPageSize:d,borderClass:m,tableClass:u,theadClass:g,trClass:$,thClass:B,divClass:V,SearchPlaceholder:G,onSubmit:H=f=>{f.preventDefault()},onRowContextMenu:p})=>{const{t:f}=ie(),[P,L]=r.useState([]),[k,y]=r.useState(""),I=(i,l,v,T)=>{const D=le(i.getValue(l),v);return T({itemRank:D}),D.passed},R=ee({columns:n,data:a,filterFns:{fuzzy:I},state:{columnFilters:P,globalFilter:k},onColumnFiltersChange:L,onGlobalFilterChange:y,globalFilterFn:I,getCoreRowModel:ne(),getFilteredRowModel:se(),getPaginationRowModel:be(),getSortedRowModel:te()}),{getHeaderGroups:Y,getRowModel:b,getCanPreviousPage:N,getCanNextPage:Q,getPageOptions:U,setPageIndex:z,nextPage:E,previousPage:j,setPageSize:C,getState:x}=R;r.useEffect(()=>{Number(d)&&C(Number(d))},[d,C]);const W=(i,l)=>{p&&p(i,l)};return e.jsxs(r.Fragment,{children:[c&&e.jsx(F,{className:"mb-3",children:e.jsx(oe.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:H,children:e.jsx(F,{children:e.jsx(re,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(ce,{value:k??"",onChange:i=>y(String(i)),placeholder:G}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:V,children:e.jsxs(ae,{hover:!0,className:u,bordered:m,children:[e.jsx("thead",{className:g,children:Y().map(i=>e.jsx("tr",{className:$,children:i.headers.map(l=>e.jsx("th",{className:B,onClick:l.column.getToggleSortingHandler(),children:l.isPlaceholder?null:e.jsxs(M.Fragment,{children:[O(l.column.columnDef.header,l.getContext()),{asc:" ",desc:" "}[l.column.getIsSorted()]??null,l.column.getCanFilter()?e.jsx("div",{children:e.jsx(ve,{column:l.column,table:R})}):null]})},l.id))},i.id))}),e.jsx("tbody",{children:b().rows.map(i=>e.jsx("tr",{onContextMenu:l=>W(l,i.original),style:{cursor:p?"context-menu":"default"},children:i.getVisibleCells().map(l=>e.jsx("td",{children:O(l.column.columnDef.cell,l.getContext())},l.id))},i.id))})]})}),e.jsxs(F,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[f("Showing"),e.jsx("span",{className:"fw-semibold ms-1",children:b().rows.length})," ",f("on")," ",e.jsx("span",{className:"fw-semibold",children:a.length})," ",f("results")]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:N()?"page-item":"page-item disabled",children:e.jsx(w,{className:"page-link",onClick:j,variant:"link",children:"<"})}),U().map((i,l)=>e.jsx(M.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx(w,{variant:"link",className:x().pagination.pageIndex===i?"page-link active":"page-link",onClick:()=>z(i),children:i+1})})},l)),e.jsx("li",{className:Q()?"page-item":"page-item disabled",children:e.jsx(w,{variant:"link",className:"page-link",onClick:E,children:">"})})]})})]})]})},Fe=({column:n})=>{const a=n.getFilterValue();return e.jsxs(e.Fragment,{children:[e.jsx(de,{type:"text",value:a??"",onChange:c=>n.setFilterValue(c),placeholder:"Search...",className:"w-36 border shadow rounded",list:n.id+"list"}),e.jsx("div",{className:"h-1"})]})},de=({value:n,onChange:a,debounce:c=500,...d})=>{const[m,u]=r.useState(n);return r.useEffect(()=>{u(n)},[n]),r.useEffect(()=>{const g=setTimeout(()=>{a(m)},c);return()=>clearTimeout(g)},[c,m]),e.jsx("input",{...d,value:m,id:"search-bar-0",className:"form-control border-0 search",onChange:g=>u(g.target.value)})},we=({columns:n,data:a,isGlobalFilter:c,customPageSize:d,borderClass:m,tableClass:u,theadClass:g,trClass:$,thClass:B,divClass:V,SearchPlaceholder:G,onSubmit:H=N=>{N.preventDefault()},onReloadTable:p,perPageEntries:f=[10,50,100,200],onRowContextMenu:P,divStyle:L,tableStyle:k,maxHeight:y="500px",keyPageParam:I="page",keyPerPageParam:R="perPage",showPaginationEllipsis:Y=!1,maxVisiblePages:b=5})=>{const{t:N}=ie(),[Q,U]=r.useState([]),[z,E]=r.useState(""),j=Ce(),C=(j==null?void 0:j[I])??"1",x=(j==null?void 0:j[R])??"10",[W,i]=r.useState({value:x,label:x}),[l,v]=M.useState({pageIndex:Number(C)-1,pageSize:Number(x)}),T=(t,s,o,h)=>{const S=le(t.getValue(s),o);return h({itemRank:S}),S.passed},D=(t,s)=>{P&&P(t,s)},X=ee({columns:n,data:(a==null?void 0:a.data)??[],filterFns:{fuzzy:T},state:{columnFilters:Q,globalFilter:z,pagination:l},onColumnFiltersChange:U,onGlobalFilterChange:E,globalFilterFn:T,getCoreRowModel:ne(),getFilteredRowModel:se(),manualPagination:!0,getSortedRowModel:te(),rowCount:(a==null?void 0:a.total)??0,onPaginationChange:t=>{if(p){const s=X.getState().pagination,o=typeof t=="function"?t(s):t;p(o.pageIndex+1,o.pageSize)}v(t)}}),{getHeaderGroups:me,getRowModel:J,getCanPreviousPage:ue,getCanNextPage:ge,getPageOptions:K,setPageIndex:xe,nextPage:he,previousPage:pe,setPageSize:Z,getState:_}=X;r.useEffect(()=>{Number(d)&&Z(Number(d))},[d,Z]);const je=()=>{const t=K().length,s=_().pagination.pageIndex;if(!Y||t<=b)return K();const o=[],h=Math.floor((b-3)/2);o.push(0);let S=Math.max(1,s-h),q=Math.min(t-2,s+h);s<=h+1&&(q=Math.min(t-2,b-2)),s>=t-h-2&&(S=Math.max(1,t-b+1)),S>1&&o.push("ellipsis-start");for(let A=S;A<=q;A++)o.push(A);return q<t-2&&o.push("ellipsis-end"),t>1&&o.push(t-1),o};return r.useEffect(()=>{const t=()=>{v(s=>{const o=Number(C)-1,h=Number(x);return s.pageIndex!==o||s.pageSize!==h?{pageIndex:o,pageSize:h}:s}),i({value:x,label:x})};return window.addEventListener("popstate",t),t(),()=>{window.removeEventListener("popstate",t)}},[]),r.useEffect(()=>{v(t=>{const s=Number(C)-1,o=Number(x);return t.pageIndex!==s||t.pageSize!==o?{pageIndex:s,pageSize:o}:t}),i({value:x,label:x})},[a]),e.jsxs(r.Fragment,{children:[c&&e.jsx(F,{className:"mb-3",children:e.jsx(oe.Body,{className:"border border-dashed border-end-0 border-start-0",children:e.jsx("form",{onSubmit:H,children:e.jsx(F,{children:e.jsx(re,{sm:5,children:e.jsxs("div",{className:"search-box me-2 mb-2 d-inline-block col-12",children:[e.jsx(de,{value:z??"",onChange:t=>E(String(t)),placeholder:G}),e.jsx("i",{className:"bx bx-search-alt search-icon"})]})})})})})}),e.jsx("div",{className:V,style:{...L,position:"relative",maxHeight:y,overflowY:"auto"},children:e.jsxs(ae,{hover:!0,className:u,bordered:m,style:k,children:[e.jsx("thead",{className:`${g} sticky-top`,style:{zIndex:10},children:me().map(t=>e.jsx("tr",{className:$,children:t.headers.map(s=>e.jsx("th",{className:`${B} ${s.column.getCanSort()?"sortable-header":""}`,style:{position:"sticky",top:0,zIndex:10,cursor:s.column.getCanSort()?"pointer":"default",userSelect:"none"},onClick:s.column.getToggleSortingHandler(),children:s.isPlaceholder?null:e.jsxs(M.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{children:O(s.column.columnDef.header,s.getContext())}),s.column.getCanSort()&&e.jsx("div",{className:"ms-1",children:s.column.getIsSorted()==="asc"?e.jsx("i",{className:"ri-arrow-up-s-line"}):s.column.getIsSorted()==="desc"?e.jsx("i",{className:"ri-arrow-down-s-line"}):e.jsx("i",{className:"ri-expand-up-down-line text-muted"})})]}),s.column.getCanFilter()?e.jsx("div",{children:e.jsx(Fe,{column:s.column,table:X})}):null]})},s.id))},t.id))}),e.jsx("tbody",{children:J().rows.map(t=>e.jsx("tr",{onContextMenu:s=>D(s,t.original),style:{cursor:P?"context-menu":"default"},children:t.getVisibleCells().map(s=>e.jsx("td",{children:O(s.column.columnDef.cell,s.getContext())},s.id))},t.id))})]})}),e.jsxs(F,{className:"align-items-center mt-2 g-3 text-center text-sm-start",children:[e.jsx("div",{className:"col-sm",children:e.jsxs("div",{className:"text-muted",children:[N("Showing"),e.jsx("span",{className:"fw-semibold ms-1",children:J().rows.length})," ",N("on")," ",e.jsx("span",{className:"fw-semibold",children:(a==null?void 0:a.total)??0})," ",N("results")]})}),e.jsx("div",{className:"col-sm-auto",children:e.jsxs("ul",{className:"pagination pagination-separated pagination-md justify-content-center justify-content-sm-start mb-0",children:[e.jsx("li",{className:ue()?"page-item":"page-item disabled",children:e.jsx(w,{className:"page-link",onClick:pe,variant:"link",children:"<"})}),je().map((t,s)=>e.jsx(M.Fragment,{children:typeof t=="string"?e.jsx("li",{className:"page-item disabled",children:e.jsx("span",{className:"page-link",children:"..."})}):e.jsx("li",{className:"page-item",children:e.jsx(w,{variant:"link",className:_().pagination.pageIndex===t?"page-link active":"page-link",onClick:()=>xe(t),children:t+1})})},s)),e.jsx("li",{className:ge()?"page-item":"page-item disabled",children:e.jsx(w,{variant:"link",className:"page-link",onClick:he,children:">"})})]})}),e.jsx("div",{className:"col-lg-auto",children:e.jsx(Ne,{value:W,onChange:t=>{p&&p(1,t.value),v(s=>({...s,pageSize:t.value})),i(t)},options:f.map(t=>({value:t,label:t})),id:"choices-single-default",className:"js-example-basic-single mb-0",name:"state",menuPlacement:"auto"})})]})]})},De=n=>{const a=fe(),c=(d,m)=>{if(n.enableContextMenu&&n.contextMenuOptions&&a){d.preventDefault(),d.stopPropagation();const u=typeof n.contextMenuOptions=="function"?n.contextMenuOptions(m):n.contextMenuOptions;u&&u.length>0&&a.showContextMenu(u,m,{x:d.clientX,y:d.clientY},n.contextMenuConfig)}};return n!=null&&n.isPaginateTable?e.jsx(we,{...n,onRowContextMenu:c}):e.jsx(Se,{...n,onRowContextMenu:c})};export{De as T};
