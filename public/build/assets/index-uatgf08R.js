import{d as n,f as L,X as P,e as E,j as t,R as I,S as H}from"./ContextMenuProvider-DoI9LuTu.js";import R from"./PageHeader-DUU2tVy4.js";import T from"./index-DwHc2WXC.js";import{u as $,c as q,d as y,a as O}from"./index.esm-yjK6ua4W.js";import{s as N}from"./showToast-BFjkHmvN.js";import{Q}from"./react-toastify.esm-8BWsAHON.js";import{ModalDeposit as X}from"./ModalDeposit-CZrbLAKZ.js";import{LayoutContext as z}from"./LayoutContext-BoHYABHW.js";import{u as G}from"./Navbar-d898nJbX.js";import{c as J}from"./thunk-Dyk6Tozc.js";/* empty css                      */import"./LightDark-VYlQJ348.js";import{u as K}from"./useTranslation-Bh5zzBC_.js";import{C as b}from"./Container-AKEw1NBh.js";import{C as l}from"./Card-BP66js0B.js";import{F as c}from"./Form-C6Oq7frR.js";import{B as S}from"./Button-CdshqBqI.js";/* empty css                  */import"./Row-DaX0pFtU.js";import"./ThemeProvider-CQKb4rSK.js";import"./Col-BERnSmBs.js";import"./reselect-CiXCCDx7.js";import"./Footer-BsH6yqSV.js";import"./isSymbol-CYvIzdD2.js";import"./hoist-non-react-statics.cjs-BsRiVy2U.js";import"./Modal-Ct9dsq7D.js";import"./useMergedRefs-Cm3LQ1VB.js";import"./useEventCallback-BA23UYAQ.js";import"./useWillUnmount-CWisbIWq.js";import"./TransitionWrapper-CRtjL7Sb.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./AbstractModalHeader-Baf6fi1-.js";import"./useWindow-B3mPSubg.js";import"./querySelectorAll-rMMgkU1T.js";import"./useEventCallback-Bsoi2xyD.js";import"./hasClass-B9uJik72.js";import"./NoopTransition-Badst7zB.js";import"./DataKey-DjdvojM5.js";import"./CloseButton-feMrj_cP.js";import"./index-B7rcZTdA.js";import"./Fade-iG7JUvQW.js";import"./divWithClassName-Ct-4CK0x.js";import"./Button-lElTeqs9.js";import"./sweetalert2.esm.all-5zhdP7Ax.js";import"./scrollspy-C0ZWAZvY.js";import"./NavbarContext-BuJEydxA.js";import"./inherits-B2gPeQio.js";import"./logo-light-D3OEWz0M.js";import"./ModalLogin-Dzzr3hgr.js";import"./InputGroup-CDI3KljJ.js";import"./InputGroupContext-CIB_KQgH.js";import"./LanguageDropdown-DoeXY-nO.js";import"./Dropdown-CxMKodrb.js";import"./SSRProvider-CLk7drUW.js";import"./useIsomorphicEffect-DSAwC7_u.js";import"./SelectableContext-Cn0HZByE.js";import"./hook-Crll79d-.js";import"./extends-CF3RwP-h.js";import"./Anchor-B8rOyTnZ.js";import"./Collapse-CckE0-uK.js";import"./NavLink-DAi6H7Zt.js";import"./TabContext-CGmNngma.js";const U=()=>{const[u,d]=n.useState(null),[f,p]=n.useState(null),[C,j]=n.useState(!1),[k,w]=n.useState(null),h=n.useContext(z),_=h==null?void 0:h.pingDeposit,x=n.useRef([]),o=G(),v=L(),{listPaymentMethod:r}=P().props;n.useEffect(()=>{o&&v(J(o==null?void 0:o.theme))},[o,v]),n.useEffect(()=>{if(r&&r.length>0&&!i.values.payment_method_id){const s=r[0];g(s)}},[r]);const{t:e}=K(),F=async()=>{V();const s=setInterval(async()=>{await _()&&clearInterval(s)},3e3);x.current.push(s)},V=()=>{x.current.forEach(s=>clearInterval(s)),x.current=[]},g=s=>{const a=(s==null?void 0:s.id)!==void 0&&(s==null?void 0:s.id)!==null?String(s.id):"";i.setFieldValue("payment_method_id",a),(s==null?void 0:s.amount)!==void 0&&(s==null?void 0:s.amount)!==null&&(d(s.amount),p(s.amount),i.setFieldValue("amount",s.amount))},A=s=>{d(s),p(s),i.setFieldValue("amount",s)},B=s=>{p(s),d(null),i.setFieldValue("amount",s)},D=n.useMemo(()=>q({payment_method_id:O().required(e("Please select payment method")),amount:y().min(1e4,e("Amount must be at least 10000")).required(e("Please enter amount"))}),[e]),i=$({initialValues:{payment_method_id:"",amount:0},validationSchema:D,onSubmit:async s=>{const a=route("buyer.deposit.checkout");await E.post(a,s).then(m=>{m.data.status==="success"?(j(!0),w(m.data.data),F()):N(e(m.data.message),"error")}).catch(m=>{N(e(m.response.data.message),"error")})}});return t.jsxs(I.Fragment,{children:[t.jsx(H,{title:(o==null?void 0:o.storeName)??""}),t.jsx(R,{title:(o==null?void 0:o.pageHeaderText)??""}),t.jsx(X,{show:C,onHide:()=>j(!1),data:k}),t.jsx(Q,{}),(r==null?void 0:r.length)>0?t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx(c,{onSubmit:i.handleSubmit,noValidate:!0,children:t.jsx("div",{className:"deposit-section",children:t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["1. ",e("Select your subscription method")]}),t.jsx("div",{className:"payment-methods",children:r==null?void 0:r.map((s,a)=>t.jsx(l,{children:t.jsx(l.Body,{children:t.jsx("div",{children:t.jsxs("div",{className:"form-check mb-2",children:[t.jsx(c.Check.Input,{className:"form-check-input",type:"radio",id:s.id,name:"payment_method_id",value:s.id,checked:i.values.payment_method_id===s.id,onChange:()=>g(s)}),t.jsx(c.Check.Label,{className:"form-check-label",htmlFor:s.id,children:t.jsx("div",{className:"d-flex align-items-center",children:t.jsxs("span",{className:"d-block justify-content-center",children:[s.title," ( ",s.name," )"]})})})]})})})},a))})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsxs("h6",{children:["2. ",e("Deposit amount")]}),t.jsx("div",{className:"amount-options mb-3",children:t.jsx("div",{className:"btn-group w-100",children:[1e4,2e4,5e4,1e5,5e5].map(s=>t.jsx(S,{variant:u===s?"primary":"outline-secondary",onClick:()=>A(s),children:s.toLocaleString("vi-VN")},s))})}),t.jsxs("div",{className:"mb-3",children:[t.jsxs(c.Label,{children:[e("Or enter custom amount"),":"]}),t.jsx(c.Control,{name:"amount",type:"text",placeholder:e("Enter amount"),value:f?f.toLocaleString("vi-VN"):"",onChange:s=>{const a=s.target.value.replace(/\./g,""),m=a?Number(a):null;B(m),i.setFieldValue("amount",m)},onBlur:i.handleBlur,className:`form-control ${i.touched.amount&&i.errors.amount?"is-invalid":""}`}),t.jsx(c.Control.Feedback,{type:"invalid",children:e(i.errors.amount||"")})]}),t.jsx(S,{variant:"primary",className:"w-100",type:"submit",disabled:i.isSubmitting,children:i.isSubmitting?e("Processing..."):e("Pay now")})]})]})})})})})}):t.jsx(b,{className:"mt-4 custom-container",fluid:!0,children:t.jsx(l,{className:"shadow-sm p-2",style:{minHeight:"50vh"},children:t.jsx(l.Body,{children:t.jsx("h6",{children:e("No payment methods available. Please contact support")})})})})]})};U.layout=u=>t.jsx(T,{children:u});export{U as default};
